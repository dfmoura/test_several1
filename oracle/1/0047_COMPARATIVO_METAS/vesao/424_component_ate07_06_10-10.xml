<gadget>
  <prompt-parameters>
    <parameter id="P_PERIODO" description="Periodo Safra 1" metadata="datePeriod" required="true" keep-last="true" keep-date="false" order="0"/>
    <parameter id="P_PERIODO1" description="Período Safra 2" metadata="datePeriod" required="false" keep-last="true" keep-date="false" order="1"/>
    <parameter id="P_CODMETA" description="Cód. Meta" metadata="entity:ConfiguracaoMeta@CODMETA" required="true" keep-last="true" keep-date="false" order="2"/>
    <parameter id="P_NTEMMETA" description="Ignorar Ref. Sem Meta Prev./Real" metadata="boolean" required="false" keep-last="true" keep-date="false" default="false" order="3"/>
    <parameter id="P_AGRUP_COORDENADOR" description="Agrupar Coordenador" metadata="boolean" required="false" keep-last="true" keep-date="false" default="false" order="4"/>
    <parameter id="P_CODGER" description="Coordenador / Supervisor" metadata="multiList:Text" listType="sql" required="false" keep-last="true" keep-date="false" order="5">
      <expression type="SQL"><![CDATA[SELECT VALUE,LABELFROM (SELECT VEN.CODGER AS VALUE,CASE WHEN VEN.CODGER = 0 THEN 'SEM VENDEDOR' ELSE VEN1.APELIDO END AS LABEL,SUM(CASE WHEN VEN.CODVEND = VEN.CODGER THEN 0 ELSE 1 END) AS ORDEMFROM TGFVEN VENINNER JOIN TGFVEN VEN1 ON VEN.CODGER = VEN1.CODVENDWHERE (VEN1.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) OR VEN1.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) OR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' )GROUP BY VEN.CODGER, VEN1.APELIDO) XORDER BY 2]]></expression>
    </parameter>
    <parameter id="P_CODVEND" description="Cód.Vend." metadata="multiList:Text" listType="sql" required="false" keep-last="true" keep-date="false" order="6">
      <expression type="SQL"><![CDATA[        SELECTMET.CODVEND AS VALUE, MET.CODVEND  ||' - '|| VEN.APELIDO AS LABELFROM TGMMET METLEFT JOIN TGFVEN VEN ON MET.CODVEND = VEN.CODVENDWHERE(MET.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) OR MET.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) OR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' )GROUP BYMET.CODVEND, VEN.APELIDOORDER BY VEN.APELIDO            ]]></expression>
    </parameter>
    <parameter id="P_MARCA" description="Marca" metadata="multiList:Text" listType="sql" required="false" keep-last="true" keep-date="false" order="7">
      <expression type="SQL"><![CDATA[selectSEQ AS VALUE,SEQ ||' - ' ||MARCA AS LABELfrom AD_VGFMARCAWHERE MARCA IS NOT NULLorder by MARCA]]></expression>
    </parameter>
    <parameter id="P_CODPARC" description="Cliente" metadata="entity:Parceiro@CODPARC" required="false" keep-last="true" keep-date="false" order="8"/>
    <parameter id="P_GRUPOPROD" description="Grupo de Produtos" metadata="entity:GrupoProduto@CODGRUPOPROD" required="false" keep-last="true" keep-date="false" order="9"/>
    <parameter id="P_CR" description="CR" metadata="entity:CentroResultado@CODCENCUS" required="false" keep-last="true" keep-date="false" order="10"/>
  </prompt-parameters>
  <level id="lvl_g2sil3" description="Nivel1">
    <args>
      <arg id="A_CODVEND" type="integer"/>
      <arg id="A_VENDEDOR" type="text"/>
    </args>
    <container orientacao="V" tamanhoRelativo="100">
      <container orientacao="V" tamanhoRelativo="1413">
        <container orientacao="V" tamanhoRelativo="50">
          <grid id="grd_htp5r4" useNewGrid="S">
            <title><![CDATA[<b>Consolidado por Vendedor - De: :P_PERIODO.INI  A: :P_PERIODO.FIN</b>]]></title>
            <expression type="sql" data-source="MGEDS"><![CDATA[SELECT*FROM(SELECTCODVEND, VENDEDOR AS APELIDO,SUM(JUL_QTDPREV) AS JUL_QTDPREV, SUM(JUL_QTDREAL) AS JUL_QTDREAL,  SUM(JUL_VLR_PREV) AS JUL_VLR_PREV, SUM(JUL_VLR_REAL) AS JUL_VLR_REAL, SUM(AGO_QTDPREV) AS AGO_QTDPREV, SUM(AGO_QTDREAL) AS AGO_QTDREAL, SUM(AGO_VLR_PREV) AS AGO_VLR_PREV, SUM(AGO_VLR_REAL) AS AGO_VLR_REAL, SUM(SET_QTDPREV) AS SET_QTDPREV, SUM(SET_QTDREAL) AS SET_QTDREAL, SUM(SET_VLR_PREV) AS SET_VLR_PREV, SUM(SET_VLR_REAL) AS SET_VLR_REAL, SUM(OUT_QTDPREV) AS OUT_QTDPREV, SUM(OUT_QTDREAL) AS OUT_QTDREAL, SUM(OUT_VLR_PREV) AS OUT_VLR_PREV, SUM(OUT_VLR_REAL) AS OUT_VLR_REAL, SUM(NOV_QTDPREV) AS NOV_QTDPREV, SUM(NOV_QTDREAL) AS NOV_QTDREAL, SUM(NOV_VLR_PREV) AS NOV_VLR_PREV, SUM(NOV_VLR_REAL) AS NOV_VLR_REAL, SUM(DEZ_QTDPREV) AS DEZ_QTDPREV, SUM(DEZ_QTDREAL) AS DEZ_QTDREAL, SUM(DEZ_VLR_PREV) AS DEZ_VLR_PREV, SUM(DEZ_VLR_REAL) AS DEZ_VLR_REAL, SUM(JAN_QTDPREV) AS JAN_QTDPREV, SUM(JAN_QTDREAL) AS JAN_QTDREAL, SUM(JAN_VLR_PREV) AS JAN_VLR_PREV, SUM(JAN_VLR_REAL) AS JAN_VLR_REAL, SUM(FEV_QTDPREV) AS FEV_QTDPREV, SUM(FEV_QTDREAL) AS FEV_QTDREAL, SUM(FEV_VLR_PREV) AS FEV_VLR_PREV, SUM(FEV_VLR_REAL) AS FEV_VLR_REAL, SUM(MAR_QTDPREV) AS MAR_QTDPREV, SUM(MAR_QTDREAL) AS MAR_QTDREAL, SUM(MAR_VLR_PREV) AS MAR_VLR_PREV, SUM(MAR_VLR_REAL) AS MAR_VLR_REAL, SUM(ABR_QTDPREV) AS ABR_QTDPREV, SUM(ABR_QTDREAL) AS ABR_QTDREAL, SUM(ABR_VLR_PREV) AS ABR_VLR_PREV, SUM(ABR_VLR_REAL) AS ABR_VLR_REAL, SUM(MAI_QTDPREV) AS MAI_QTDPREV, SUM(MAI_QTDREAL) AS MAI_QTDREAL, SUM(MAI_VLR_PREV) AS MAI_VLR_PREV, SUM(MAI_VLR_REAL) AS MAI_VLR_REAL, SUM(JUN_QTDPREV) AS JUN_QTDPREV, SUM(JUN_QTDREAL) AS JUN_QTDREAL, SUM(JUN_VLR_PREV) AS JUN_VLR_PREV, SUM(JUN_VLR_REAL) AS JUN_VLR_REAL, SUM(TTL_QTDPREV) AS TTL_QTDPREV, SUM(TTL_QTDREAL) AS TTL_QTDREAL, SUM(TTL_VLR_PREV) AS TTL_VLR_PREV, SUM(TTL_VLR_REAL) AS TTL_VLR_REAL FROM(WITH VEND AS (SELECT VEN.CODVEND, VEN.APELIDO AS VENDEDOR, VEN.CODGER,VEN1.APELIDO AS COORD FROM TGFVEN VEN INNER JOIN TGFVEN VEN1 ON VEN.CODGER = VEN1.CODVEND)SELECT  (CASE     WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEND.CODGER    ELSE X.CODVEND END) AS CODVEND,  (CASE    WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEND.COORD    ELSE VEND.VENDEDOR END) AS VENDEDOR,JUL_QTDPREV, JUL_QTDREAL, JUL_VLR_PREV, JUL_VLR_REAL, AGO_QTDPREV, AGO_QTDREAL, AGO_VLR_PREV, AGO_VLR_REAL, SET_QTDPREV, SET_QTDREAL, SET_VLR_PREV, SET_VLR_REAL, OUT_QTDPREV, OUT_QTDREAL, OUT_VLR_PREV, OUT_VLR_REAL, NOV_QTDPREV, NOV_QTDREAL, NOV_VLR_PREV, NOV_VLR_REAL, DEZ_QTDPREV, DEZ_QTDREAL, DEZ_VLR_PREV, DEZ_VLR_REAL, JAN_QTDPREV, JAN_QTDREAL, JAN_VLR_PREV, JAN_VLR_REAL, FEV_QTDPREV, FEV_QTDREAL, FEV_VLR_PREV, FEV_VLR_REAL, MAR_QTDPREV, MAR_QTDREAL, MAR_VLR_PREV, MAR_VLR_REAL, ABR_QTDPREV, ABR_QTDREAL, ABR_VLR_PREV, ABR_VLR_REAL, MAI_QTDPREV, MAI_QTDREAL, MAI_VLR_PREV, MAI_VLR_REAL, JUN_QTDPREV, JUN_QTDREAL, JUN_VLR_PREV, JUN_VLR_REAL,TTL_QTDPREV,TTL_QTDREAL,TTL_VLR_PREV,TTL_VLR_REALFROM(SELECTT.*,(JUL_QTDPREV + AGO_QTDPREV + SET_QTDPREV + OUT_QTDPREV+NOV_QTDPREV+DEZ_QTDPREV+JAN_QTDPREV+FEV_QTDPREV+MAR_QTDPREV+ABR_QTDPREV+MAI_QTDPREV+JUN_QTDPREV) AS TTL_QTDPREV,(JUL_QTDREAL + AGO_QTDREAL + SET_QTDREAL + OUT_QTDREAL+NOV_QTDREAL+DEZ_QTDREAL+JAN_QTDREAL+FEV_QTDREAL+MAR_QTDREAL+ABR_QTDREAL+MAI_QTDREAL+JUN_QTDREAL) AS TTL_QTDREAL,(JUL_VLR_PREV + AGO_VLR_PREV + SET_VLR_PREV + OUT_VLR_PREV+NOV_VLR_PREV+DEZ_VLR_PREV+JAN_VLR_PREV+FEV_VLR_PREV+MAR_VLR_PREV+ABR_VLR_PREV+MAI_VLR_PREV+JUN_VLR_PREV) AS TTL_VLR_PREV,(JUL_VLR_REAL + AGO_VLR_REAL + SET_VLR_REAL + OUT_VLR_REAL+NOV_VLR_REAL+DEZ_VLR_REAL+JAN_VLR_REAL+FEV_VLR_REAL+MAR_VLR_REAL+ABR_VLR_REAL+MAI_VLR_REAL+JUN_VLR_REAL) AS TTL_VLR_REALFROM (SELECT A.CODVEND,APELIDO,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUL_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUL_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUL_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUL_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS AGO_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS AGO_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS AGO_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS AGO_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS SET_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS SET_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS SET_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS SET_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS OUT_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS OUT_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS OUT_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS OUT_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS NOV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS NOV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS NOV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS NOV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS DEZ_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS DEZ_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS DEZ_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS DEZ_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JAN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JAN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JAN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JAN_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS FEV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS FEV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS FEV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS FEV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS ABR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS ABR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS ABR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS ABR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAI_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAI_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAI_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAI_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUN_VLR_REALFROM(SELECT MET.DTREF, NVL(MET.CODVEND,0) AS CODVEND, NVL(MET.CODPARC,0) AS CODPARC, NVL(MET.MARCA,0) AS MARCA,NVL(VGF.CODCENCUS,0) AS CODCENCUS, NVL(MET.QTDPREV,0) AS QTDPREV, SUM(NVL(VGF.QTD,0)) AS QTDREAL,NVL(PRC.VLRVENDALT,0)AS PRECOLT, SUM(NVL(VGF.VLR,0)) AS VLRREALFROM TGFMET METLEFT JOIN VGF_VENDAS_SATIS VGF ON MET.DTREF = TRUNC(VGF.DTMOV,'MM') AND MET.CODVEND = VGF.CODVEND AND MET.CODPARC = VGF.CODPARC AND MET.MARCA = VGF.MARCA AND VGF.BONIFICACAO = 'N'LEFT JOIN AD_PRECOMARCA PRC ON (MET.MARCA = PRC.MARCA AND PRC.CODMETA = MET.CODMETA AND PRC.DTREF = (SELECT MAX(DTREF) FROM AD_PRECOMARCA WHERE CODMETA = MET.CODMETA AND DTREF <= MET.DTREF AND MARCA = MET.MARCA))WHERE MET.CODMETA = :P_CODMETAAND MET.DTREF BETWEEN :P_PERIODO.INI   AND  :P_PERIODO.FINAND (VGF.CODGRUPOPROD = :P_GRUPOPROD OR :P_GRUPOPROD IS NULL)GROUP BY MET.DTREF,NVL(MET.CODVEND,0),NVL(MET.CODPARC,0),NVL(MET.MARCA,0),NVL(VGF.CODCENCUS,0), NVL(MET.QTDPREV,0), NVL(PRC.VLRVENDALT,0))AINNER JOIN TGFPAR PAR ON A.CODPARC = PAR.CODPARCINNER JOIN TGFVEN VEN ON A.CODVEND = VEN.CODVENDWHERE(VEN.CODVEND IN :P_CODVEND)AND (VEN.CODGER IN :P_CODGER)AND (PAR.CODPARC = :P_CODPARC OR :P_CODPARC IS NULL)AND (A.MARCA IN (SELECT MARCA FROM TGFPRO WHERE CODPROD IN :P_MARCA))AND (A.CODCENCUS = :P_CR OR :P_CR IS NULL)AND(VEN.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA VENDEDOROR VEN.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA GERENTEOR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' ---CONSULTA MASTER)GROUP BY A.CODVEND, APELIDO)T)XINNER JOIN VEND ON X.CODVEND = VEND.CODVEND)GROUP BY CODVEND, VENDEDOR)WHERE ((:P_NTEMMETA = 'S' AND (TTL_QTDPREV <> 0 OR TTL_QTDREAL <> 0 OR TTL_VLR_PREV <> 0 OR TTL_VLR_REAL<> 0)) OR :P_NTEMMETA = 'N')ORDER BY 2]]></expression>
            <metadata>
              <field name="CODVEND" label="Cód. Vend." type="I" visible="true" useFooter="false"/>
              <field name="APELIDO" label="Vendedor" type="S" visible="true" useFooter="false"/>
              <field name="JUL_QTDPREV" label="Jul. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="JUL_QTDREAL" label="Jul. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="JUL_VLR_PREV" label="Jul. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="JUL_VLR_REAL" label="Jul. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="AGO_QTDPREV" label="Ago. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="AGO_QTDREAL" label="Ago. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="AGO_VLR_PREV" label="Ago. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="AGO_VLR_REAL" label="Ago. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="SET_QTDPREV" label="Set. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="SET_QTDREAL" label="Set. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="SET_VLR_PREV" label="Set. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="SET_VLR_REAL" label="Set. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="OUT_QTDPREV" label="Out. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="OUT_QTDREAL" label="Out. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="OUT_VLR_PREV" label="Out. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="OUT_VLR_REAL" label="Out. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="NOV_QTDPREV" label="Nov. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="NOV_QTDREAL" label="Nov. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="NOV_VLR_PREV" label="Nov. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="NOV_VLR_REAL" label="Nov. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="DEZ_QTDPREV" label="Dez. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="DEZ_QTDREAL" label="Dez. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="DEZ_VLR_PREV" label="Dez. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="DEZ_VLR_REAL" label="Dez. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="JAN_QTDPREV" label="Jan. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="JAN_QTDREAL" label="Jan. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="JAN_VLR_PREV" label="Jan. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="JAN_VLR_REAL" label="Jan. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="FEV_QTDPREV" label="Fev. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="FEV_QTDREAL" label="Fev. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="FEV_VLR_PREV" label="Fev. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="FEV_VLR_REAL" label="Fev. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="MAR_QTDPREV" label="Mar. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="MAR_QTDREAL" label="Mar. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="MAR_VLR_PREV" label="Mar. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="MAR_VLR_REAL" label="Mar. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="ABR_QTDPREV" label="Abr. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="ABR_QTDREAL" label="Abr. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="ABR_VLR_PREV" label="Abr. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="ABR_VLR_REAL" label="Abr. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="MAI_QTDPREV" label="Mai. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="MAI_QTDREAL" label="Mai. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="MAI_VLR_PREV" label="Mai. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="MAI_VLR_REAL" label="Mai. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="JUN_QTDPREV" label="Jun. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="JUN_QTDREAL" label="Jun. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="JUN_VLR_PREV" label="Jun. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="JUN_VLR_REAL" label="Jun. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="TTL_QTDPREV" label="Ttl. Qtd. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
              </field>
              <field name="TTL_QTDREAL" label="Ttl. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
              </field>
              <field name="TTL_VLR_PREV" label="Ttl. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
              </field>
              <field name="TTL_VLR_REAL" label="Ttl. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
              </field>
            </metadata>
            <on-click navigate-to="lvl_rq48q6">
              <param id="A_CODVEND">$CODVEND</param>
              <param id="A_VENDEDOR">$APELIDO</param>
            </on-click>
            <refresh-details ui-list="svl_rlk0da">
              <param id="A_CODVEND">$CODVEND</param>
              <param id="A_VENDEDOR">$APELIDO</param>
            </refresh-details>
          </grid>
        </container>
        <container orientacao="V" tamanhoRelativo="50">
          <grid id="grd_suypno" useNewGrid="S">
            <title><![CDATA[<b>Consolidado por Vendedor - De: :P_PERIODO1.INI  A: :P_PERIODO1.FIN</b>]]></title>
            <expression type="sql" data-source="MGEDS"><![CDATA[SELECT*FROM(SELECTCODVEND,VENDEDOR AS APELIDO,SUM(JUL_QTDPREV) AS JUL_QTDPREV, SUM(JUL_QTDREAL) AS JUL_QTDREAL,  SUM(JUL_VLR_PREV) AS JUL_VLR_PREV, SUM(JUL_VLR_REAL) AS JUL_VLR_REAL, SUM(AGO_QTDPREV) AS AGO_QTDPREV, SUM(AGO_QTDREAL) AS AGO_QTDREAL, SUM(AGO_VLR_PREV) AS AGO_VLR_PREV, SUM(AGO_VLR_REAL) AS AGO_VLR_REAL, SUM(SET_QTDPREV) AS SET_QTDPREV, SUM(SET_QTDREAL) AS SET_QTDREAL, SUM(SET_VLR_PREV) AS SET_VLR_PREV, SUM(SET_VLR_REAL) AS SET_VLR_REAL, SUM(OUT_QTDPREV) AS OUT_QTDPREV, SUM(OUT_QTDREAL) AS OUT_QTDREAL, SUM(OUT_VLR_PREV) AS OUT_VLR_PREV, SUM(OUT_VLR_REAL) AS OUT_VLR_REAL, SUM(NOV_QTDPREV) AS NOV_QTDPREV, SUM(NOV_QTDREAL) AS NOV_QTDREAL, SUM(NOV_VLR_PREV) AS NOV_VLR_PREV, SUM(NOV_VLR_REAL) AS NOV_VLR_REAL, SUM(DEZ_QTDPREV) AS DEZ_QTDPREV, SUM(DEZ_QTDREAL) AS DEZ_QTDREAL, SUM(DEZ_VLR_PREV) AS DEZ_VLR_PREV, SUM(DEZ_VLR_REAL) AS DEZ_VLR_REAL, SUM(JAN_QTDPREV) AS JAN_QTDPREV, SUM(JAN_QTDREAL) AS JAN_QTDREAL, SUM(JAN_VLR_PREV) AS JAN_VLR_PREV, SUM(JAN_VLR_REAL) AS JAN_VLR_REAL, SUM(FEV_QTDPREV) AS FEV_QTDPREV, SUM(FEV_QTDREAL) AS FEV_QTDREAL, SUM(FEV_VLR_PREV) AS FEV_VLR_PREV, SUM(FEV_VLR_REAL) AS FEV_VLR_REAL, SUM(MAR_QTDPREV) AS MAR_QTDPREV, SUM(MAR_QTDREAL) AS MAR_QTDREAL, SUM(MAR_VLR_PREV) AS MAR_VLR_PREV, SUM(MAR_VLR_REAL) AS MAR_VLR_REAL, SUM(ABR_QTDPREV) AS ABR_QTDPREV, SUM(ABR_QTDREAL) AS ABR_QTDREAL, SUM(ABR_VLR_PREV) AS ABR_VLR_PREV, SUM(ABR_VLR_REAL) AS ABR_VLR_REAL, SUM(MAI_QTDPREV) AS MAI_QTDPREV, SUM(MAI_QTDREAL) AS MAI_QTDREAL, SUM(MAI_VLR_PREV) AS MAI_VLR_PREV, SUM(MAI_VLR_REAL) AS MAI_VLR_REAL, SUM(JUN_QTDPREV) AS JUN_QTDPREV, SUM(JUN_QTDREAL) AS JUN_QTDREAL, SUM(JUN_VLR_PREV) AS JUN_VLR_PREV, SUM(JUN_VLR_REAL) AS JUN_VLR_REAL, SUM(TTL_QTDPREV) AS TTL_QTDPREV, SUM(TTL_QTDREAL) AS TTL_QTDREAL, SUM(TTL_VLR_PREV) AS TTL_VLR_PREV, SUM(TTL_VLR_REAL) AS TTL_VLR_REAL FROM(WITH VEND AS (SELECT VEN.CODVEND, VEN.APELIDO AS VENDEDOR, VEN.CODGER,VEN1.APELIDO AS COORD FROM TGFVEN VEN INNER JOIN TGFVEN VEN1 ON VEN.CODGER = VEN1.CODVEND)SELECT  (CASE     WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEND.CODGER    ELSE X.CODVEND END) AS CODVEND,  (CASE    WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEND.COORD    ELSE VEND.VENDEDOR END) AS VENDEDOR,JUL_QTDPREV, JUL_QTDREAL, JUL_VLR_PREV, JUL_VLR_REAL, AGO_QTDPREV, AGO_QTDREAL, AGO_VLR_PREV, AGO_VLR_REAL, SET_QTDPREV, SET_QTDREAL, SET_VLR_PREV, SET_VLR_REAL, OUT_QTDPREV, OUT_QTDREAL, OUT_VLR_PREV, OUT_VLR_REAL, NOV_QTDPREV, NOV_QTDREAL, NOV_VLR_PREV, NOV_VLR_REAL, DEZ_QTDPREV, DEZ_QTDREAL, DEZ_VLR_PREV, DEZ_VLR_REAL, JAN_QTDPREV, JAN_QTDREAL, JAN_VLR_PREV, JAN_VLR_REAL, FEV_QTDPREV, FEV_QTDREAL, FEV_VLR_PREV, FEV_VLR_REAL, MAR_QTDPREV, MAR_QTDREAL, MAR_VLR_PREV, MAR_VLR_REAL, ABR_QTDPREV, ABR_QTDREAL, ABR_VLR_PREV, ABR_VLR_REAL, MAI_QTDPREV, MAI_QTDREAL, MAI_VLR_PREV, MAI_VLR_REAL, JUN_QTDPREV, JUN_QTDREAL, JUN_VLR_PREV, JUN_VLR_REAL,TTL_QTDPREV,TTL_QTDREAL,TTL_VLR_PREV,TTL_VLR_REALFROM(SELECTT.*,(JUL_QTDPREV + AGO_QTDPREV + SET_QTDPREV + OUT_QTDPREV+NOV_QTDPREV+DEZ_QTDPREV+JAN_QTDPREV+FEV_QTDPREV+MAR_QTDPREV+ABR_QTDPREV+MAI_QTDPREV+JUN_QTDPREV) AS TTL_QTDPREV,(JUL_QTDREAL + AGO_QTDREAL + SET_QTDREAL + OUT_QTDREAL+NOV_QTDREAL+DEZ_QTDREAL+JAN_QTDREAL+FEV_QTDREAL+MAR_QTDREAL+ABR_QTDREAL+MAI_QTDREAL+JUN_QTDREAL) AS TTL_QTDREAL,(JUL_VLR_PREV + AGO_VLR_PREV + SET_VLR_PREV + OUT_VLR_PREV+NOV_VLR_PREV+DEZ_VLR_PREV+JAN_VLR_PREV+FEV_VLR_PREV+MAR_VLR_PREV+ABR_VLR_PREV+MAI_VLR_PREV+JUN_VLR_PREV) AS TTL_VLR_PREV,(JUL_VLR_REAL + AGO_VLR_REAL + SET_VLR_REAL + OUT_VLR_REAL+NOV_VLR_REAL+DEZ_VLR_REAL+JAN_VLR_REAL+FEV_VLR_REAL+MAR_VLR_REAL+ABR_VLR_REAL+MAI_VLR_REAL+JUN_VLR_REAL) AS TTL_VLR_REALFROM (SELECT A.CODVEND,APELIDO,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUL_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUL_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUL_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUL_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS AGO_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS AGO_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS AGO_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS AGO_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS SET_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS SET_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS SET_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS SET_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS OUT_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS OUT_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS OUT_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS OUT_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS NOV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS NOV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS NOV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS NOV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS DEZ_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS DEZ_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS DEZ_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS DEZ_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JAN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JAN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JAN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JAN_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS FEV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS FEV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS FEV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS FEV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS ABR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS ABR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS ABR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS ABR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAI_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAI_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAI_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAI_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUN_VLR_REALFROM(SELECT MET.DTREF, NVL(MET.CODVEND,0) AS CODVEND, NVL(MET.CODPARC,0) AS CODPARC, NVL(MET.MARCA,0) AS MARCA,NVL(VGF.CODCENCUS,0) AS CODCENCUS, NVL(MET.QTDPREV,0) AS QTDPREV, SUM(NVL(VGF.QTD,0)) AS QTDREAL,NVL(PRC.VLRVENDALT,0)AS PRECOLT, SUM(NVL(VGF.VLR,0)) AS VLRREALFROM TGFMET METLEFT JOIN VGF_VENDAS_SATIS VGF ON MET.DTREF = TRUNC(VGF.DTMOV,'MM') AND MET.CODVEND = VGF.CODVEND AND MET.CODPARC = VGF.CODPARC AND MET.MARCA = VGF.MARCA AND VGF.BONIFICACAO = 'N'LEFT JOIN AD_PRECOMARCA PRC ON (MET.MARCA = PRC.MARCA AND PRC.CODMETA = MET.CODMETA AND PRC.DTREF = (SELECT MAX(DTREF) FROM AD_PRECOMARCA WHERE CODMETA = MET.CODMETA AND DTREF <= MET.DTREF AND MARCA = MET.MARCA))WHERE MET.CODMETA = :P_CODMETAAND MET.DTREF BETWEEN :P_PERIODO1.INI   AND  :P_PERIODO1.FINAND (VGF.CODGRUPOPROD = :P_GRUPOPROD OR :P_GRUPOPROD IS NULL)GROUP BY MET.DTREF,NVL(MET.CODVEND,0),NVL(MET.CODPARC,0),NVL(MET.MARCA,0),NVL(VGF.CODCENCUS,0), NVL(MET.QTDPREV,0), NVL(PRC.VLRVENDALT,0))AINNER JOIN TGFPAR PAR ON A.CODPARC = PAR.CODPARCINNER JOIN TGFVEN VEN ON A.CODVEND = VEN.CODVENDWHERE(VEN.CODVEND IN :P_CODVEND)AND (VEN.CODGER IN :P_CODGER)AND (PAR.CODPARC = :P_CODPARC OR :P_CODPARC IS NULL)AND (A.MARCA IN (SELECT MARCA FROM TGFPRO WHERE CODPROD IN :P_MARCA))AND (A.CODCENCUS = :P_CR OR :P_CR IS NULL)AND(VEN.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA VENDEDOROR VEN.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA GERENTEOR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' ---CONSULTA MASTER)GROUP BY A.CODVEND, APELIDO)T)XINNER JOIN VEND ON X.CODVEND = VEND.CODVEND)GROUP BY CODVEND,VENDEDOR)WHERE ((:P_NTEMMETA = 'S' AND (TTL_QTDPREV <> 0 OR TTL_QTDREAL <> 0 OR TTL_VLR_PREV <> 0 OR TTL_VLR_REAL<> 0)) OR :P_NTEMMETA = 'N')ORDER BY 2]]></expression>
            <metadata>
              <field name="CODVEND" label="Cód. Vend." type="I" visible="true" useFooter="false"/>
              <field name="APELIDO" label="Vendedor" type="S" visible="true" useFooter="false"/>
              <field name="JUL_QTDPREV" label="Jul. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="JUL_QTDREAL" label="Jul. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="JUL_VLR_PREV" label="Jul. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="JUL_VLR_REAL" label="Jul. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="AGO_QTDPREV" label="Ago. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="AGO_QTDREAL" label="Ago. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="AGO_VLR_PREV" label="Ago. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="AGO_VLR_REAL" label="Ago. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="SET_QTDPREV" label="Set. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="SET_QTDREAL" label="Set. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="SET_VLR_PREV" label="Set. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="SET_VLR_REAL" label="Set. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="OUT_QTDPREV" label="Out. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="OUT_QTDREAL" label="Out. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="OUT_VLR_PREV" label="Out. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="OUT_VLR_REAL" label="Out. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="NOV_QTDPREV" label="Nov. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="NOV_QTDREAL" label="Nov. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="NOV_VLR_PREV" label="Nov. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="NOV_VLR_REAL" label="Nov. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="DEZ_QTDPREV" label="Dez. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="DEZ_QTDREAL" label="Dez. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="DEZ_VLR_PREV" label="Dez. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="DEZ_VLR_REAL" label="Dez. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="JAN_QTDPREV" label="Jan. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="JAN_QTDREAL" label="Jan. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="JAN_VLR_PREV" label="Jan. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="JAN_VLR_REAL" label="Jan. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="FEV_QTDPREV" label="Fev. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="FEV_QTDREAL" label="Fev. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="FEV_VLR_PREV" label="Fev. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="FEV_VLR_REAL" label="Fev. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="MAR_QTDPREV" label="Mar. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="MAR_QTDREAL" label="Mar. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="MAR_VLR_PREV" label="Mar. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="MAR_VLR_REAL" label="Mar. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="ABR_QTDPREV" label="Abr. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="ABR_QTDREAL" label="Abr. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="ABR_VLR_PREV" label="Abr. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="ABR_VLR_REAL" label="Abr. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="MAI_QTDPREV" label="Mai. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="MAI_QTDREAL" label="Mai. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="MAI_VLR_PREV" label="Mai. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="MAI_VLR_REAL" label="Mai. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
              </field>
              <field name="JUN_QTDPREV" label="Jun. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="JUN_QTDREAL" label="Jun. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="JUN_VLR_PREV" label="Jun. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="JUN_VLR_REAL" label="Jun. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
              <field name="TTL_QTDPREV" label="Ttl. Qtd. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
              </field>
              <field name="TTL_QTDREAL" label="Ttl. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
              </field>
              <field name="TTL_VLR_PREV" label="Ttl. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
              </field>
              <field name="TTL_VLR_REAL" label="Ttl. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
                <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
              </field>
            </metadata>
            <on-click navigate-to="lvl_a3vjklz"/>
            <refresh-details ui-list="svl_rlk0da">
              <param id="A_CODVEND">$CODVEND</param>
              <param id="A_VENDEDOR">$APELIDO</param>
            </refresh-details>
          </grid>
        </container>
      </container>
      <container orientacao="H" tamanhoRelativo="100">
        <container orientacao="V" tamanhoRelativo="20">
          <simple-value id="svl_p6nhi5">
            <value-expression><![CDATA[<div style='text-align: center;'><button style='font-weight: bold; padding: 5px 15px; font-size: 12px; background-color: green; color: white;'>Visão por Marca</button></div>
]]></value-expression>
            <on-click navigate-to="lvl_f1xj5j">
              <param id="A_CODVEND"/>
            </on-click>
          </simple-value>
        </container>
        <container orientacao="V" tamanhoRelativo="20">
          <simple-value id="svl_rlk0da">
            <args>
              <arg id="A_CODVEND" type="integer"/>
              <arg id="A_VENDEDOR" type="text"/>
            </args>
            <expression type="sql" data-source="MGEDS"><![CDATA[SELECT 
:A_CODVEND AS CODVEND,
:A_VENDEDOR AS VENDEDOR
FROM dual]]></expression>
            <metadata>
              <field name="CODVEND" label="CODVEND" type="I" visible="true" useFooter="false"/>
              <field name="VENDEDOR" label="VENDEDOR" type="S" visible="true" useFooter="false"/>
            </metadata>
            <value-expression><![CDATA[<div style='text-align: center;'><button style='font-weight: bold; padding: 5px 15px; font-size: 12px; background-color: green; color: white;'>Evolução por Vendedor</button></div>
]]></value-expression>
            <on-click navigate-to="lvl_p6ng9q">
              <param id="A_CODVEND">$CODVEND</param>
              <param id="A_VENDEDOR">$VENDEDOR</param>
            </on-click>
          </simple-value>
        </container>
        <container orientacao="V" tamanhoRelativo="20">
          <simple-value id="svl_vrj7uc">
            <value-expression><![CDATA[<div style='text-align: center;'><button style='font-weight: bold; padding: 5px 15px; font-size: 12px; background-color: green; color: white;'>Evolução Macro da Meta</button></div>]]></value-expression>
            <on-click navigate-to="lvl_vrj7sv"/>
          </simple-value>
        </container>
        <container orientacao="V" tamanhoRelativo="20">
          <simple-value id="svl_ayxu85n">
            <value-expression><![CDATA[<div style='text-align: center;'><button style='font-weight: bold; padding: 5px 15px; font-size: 12px; background-color: green; color: white;'>Agrupamento Vendedor</button></div>]]></value-expression>
            <on-click navigate-to="lvl_ayrmn01"/>
          </simple-value>
        </container>
        <container orientacao="H" tamanhoRelativo="20">
          <simple-value id="svl_ayxu90b">
            <value-expression><![CDATA[<div style='text-align: center;'><button style='font-weight: bold; padding: 5px 15px; font-size: 12px; background-color: green; color: white;'>Agrupamento Marca</button></div>]]></value-expression>
            <on-click navigate-to="lvl_ayxu9wi"/>
          </simple-value>
        </container>
      </container>
    </container>
  </level>
  <level id="lvl_f1xj5j" description="Nivel2">
    <args>
      <arg id="A_CODVEND" type="integer"/>
    </args>
    <container orientacao="V" tamanhoRelativo="100">
      <container orientacao="V" tamanhoRelativo="100">
        <grid id="grd_p6nhd8" useNewGrid="S">
          <title><![CDATA[<b>Consolidado por Marcas - De: :P_PERIODO.INI  A: :P_PERIODO.FIN</b>]]></title>
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECT*FROM(SELECTT.*,(JUL_QTDPREV + AGO_QTDPREV + SET_QTDPREV + OUT_QTDPREV+NOV_QTDPREV+DEZ_QTDPREV+JAN_QTDPREV+FEV_QTDPREV+MAR_QTDPREV+ABR_QTDPREV+MAI_QTDPREV+JUN_QTDPREV) AS TTL_QTDPREV,(JUL_QTDREAL + AGO_QTDREAL + SET_QTDREAL + OUT_QTDREAL+NOV_QTDREAL+DEZ_QTDREAL+JAN_QTDREAL+FEV_QTDREAL+MAR_QTDREAL+ABR_QTDREAL+MAI_QTDREAL+JUN_QTDREAL) AS TTL_QTDREAL,(JUL_VLR_PREV + AGO_VLR_PREV + SET_VLR_PREV + OUT_VLR_PREV+NOV_VLR_PREV+DEZ_VLR_PREV+JAN_VLR_PREV+FEV_VLR_PREV+MAR_VLR_PREV+ABR_VLR_PREV+MAI_VLR_PREV+JUN_VLR_PREV) AS TTL_VLR_PREV,(JUL_VLR_REAL + AGO_VLR_REAL + SET_VLR_REAL + OUT_VLR_REAL+NOV_VLR_REAL+DEZ_VLR_REAL+JAN_VLR_REAL+FEV_VLR_REAL+MAR_VLR_REAL+ABR_VLR_REAL+MAI_VLR_REAL+JUN_VLR_REAL) AS TTL_VLR_REALFROM (SELECT     MARCA,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUL_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUL_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUL_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUL_VLR_REAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS AGO_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS AGO_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS AGO_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS AGO_VLR_REAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS SET_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS SET_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS SET_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS SET_VLR_REAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS OUT_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS OUT_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS OUT_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS OUT_VLR_REAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS NOV_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS NOV_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS NOV_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS NOV_VLR_REAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS DEZ_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS DEZ_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS DEZ_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS DEZ_VLR_REAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JAN_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JAN_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JAN_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JAN_VLR_REAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS FEV_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS FEV_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS FEV_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS FEV_VLR_REAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAR_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAR_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAR_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAR_VLR_REAL,        SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS ABR_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS ABR_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS ABR_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS ABR_VLR_REAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAI_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAI_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAI_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAI_VLR_REAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUN_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUN_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUN_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUN_VLR_REALFROM(SELECT MET.DTREF, NVL(MET.CODVEND,0) AS CODVEND, NVL(MET.CODPARC,0) AS CODPARC, NVL(MET.MARCA,0) AS MARCA,NVL(VGF.CODCENCUS,0) AS CODCENCUS, NVL(MET.QTDPREV,0) AS QTDPREV, SUM(NVL(VGF.QTD,0)) AS QTDREAL,NVL(PRC.VLRVENDALT,0)AS PRECOLT, SUM(NVL(VGF.VLR,0)) AS VLRREALFROM TGFMET METLEFT JOIN VGF_VENDAS_SATIS VGF ON MET.DTREF = TRUNC(VGF.DTMOV,'MM') AND MET.CODVEND = VGF.CODVEND AND MET.CODPARC = VGF.CODPARC AND MET.MARCA = VGF.MARCA AND VGF.BONIFICACAO = 'N'LEFT JOIN AD_PRECOMARCA PRC ON (MET.MARCA = PRC.MARCA AND PRC.CODMETA = MET.CODMETA AND PRC.DTREF = (SELECT MAX(DTREF) FROM AD_PRECOMARCA WHERE CODMETA = MET.CODMETA AND DTREF <= MET.DTREF AND MARCA = MET.MARCA))WHERE MET.CODMETA = :P_CODMETAAND MET.DTREF BETWEEN :P_PERIODO.INI   AND  :P_PERIODO.FINAND (VGF.CODGRUPOPROD = :P_GRUPOPROD OR :P_GRUPOPROD IS NULL)GROUP BY MET.DTREF,NVL(MET.CODVEND,0),NVL(MET.CODPARC,0),NVL(MET.MARCA,0),NVL(VGF.CODCENCUS,0), NVL(MET.QTDPREV,0), NVL(PRC.VLRVENDALT,0))AINNER JOIN TGFPAR PAR ON A.CODPARC = PAR.CODPARCINNER JOIN TGFVEN VEN ON A.CODVEND = VEN.CODVENDWHERE(VEN.CODVEND IN :P_CODVEND)AND (VEN.CODGER IN :P_CODGER)AND (PAR.CODPARC = :P_CODPARC OR :P_CODPARC IS NULL)AND (A.MARCA IN (SELECT MARCA FROM TGFPRO WHERE CODPROD IN :P_MARCA))AND (A.CODCENCUS = :P_CR OR :P_CR IS NULL)AND(VEN.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA VENDEDOROR VEN.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA GERENTEOR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' ---CONSULTA MASTER)GROUP BY MARCA)T)WHERE ((:P_NTEMMETA = 'S' AND (TTL_QTDPREV <> 0 OR TTL_QTDREAL <> 0 OR TTL_VLR_PREV <> 0 OR TTL_VLR_REAL<> 0)) OR :P_NTEMMETA = 'N')ORDER BY 1]]></expression>
          <metadata>
            <field name="MARCA" label="Marca" type="S" visible="true" useFooter="false"/>
            <field name="JUL_QTDPREV" label="Jul. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUL_QTDREAL" label="Jul. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUL_VLR_PREV" label="Jul. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUL_VLR_REAL" label="Jul. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="AGO_QTDPREV" label="Ago. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="AGO_QTDREAL" label="Ago. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="AGO_VLR_PREV" label="Ago. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="AGO_VLR_REAL" label="Ago. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="SET_QTDPREV" label="Set. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="SET_QTDREAL" label="Set. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="SET_VLR_PREV" label="Set. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="SET_VLR_REAL" label="Set. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="OUT_QTDPREV" label="Out. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="OUT_QTDREAL" label="Out. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="OUT_VLR_PREV" label="Out. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="OUT_VLR_REAL" label="Out. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="NOV_QTDPREV" label="Nov. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="NOV_QTDREAL" label="Nov. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="NOV_VLR_PREV" label="Nov. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="NOV_VLR_REAL" label="Nov. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="DEZ_QTDPREV" label="Dez. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="DEZ_QTDREAL" label="Dez. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="DEZ_VLR_PREV" label="Dez. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="DEZ_VLR_REAL" label="Dez. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JAN_QTDPREV" label="Jan. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JAN_QTDREAL" label="Jan. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JAN_VLR_PREV" label="Jan. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JAN_VLR_REAL" label="Jan. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="FEV_QTDPREV" label="Fev. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="FEV_QTDREAL" label="Fev. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="FEV_VLR_PREV" label="Fev. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="FEV_VLR_REAL" label="Fev. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="MAR_QTDPREV" label="Mar. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAR_QTDREAL" label="Mar. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAR_VLR_PREV" label="Mar. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAR_VLR_REAL" label="Mar. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="ABR_QTDPREV" label="Abr. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="ABR_QTDREAL" label="Abr. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="ABR_VLR_PREV" label="Abr. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="ABR_VLR_REAL" label="Abr. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="MAI_QTDPREV" label="Mai. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAI_QTDREAL" label="Mai. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAI_VLR_PREV" label="Mai. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAI_VLR_REAL" label="Mai. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUN_QTDPREV" label="Jun. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JUN_QTDREAL" label="Jun. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JUN_VLR_PREV" label="Jun. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JUN_VLR_REAL" label="Jun. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="TTL_QTDPREV" label="Ttl. Qtd. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
            <field name="TTL_QTDREAL" label="Ttl. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
            <field name="TTL_VLR_PREV" label="Ttl. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
            <field name="TTL_VLR_REAL" label="Ttl. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
          </metadata>
          <on-click navigate-to="lvl_f1xj5j"/>
        </grid>
      </container>
      <container orientacao="V" tamanhoRelativo="122">
        <grid id="grd_suypq4" useNewGrid="S">
          <title><![CDATA[<b>Consolidado por Marcas - De: :P_PERIODO1.INI  A: :P_PERIODO1.FIN</b>]]></title>
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECT*FROM(SELECTT.*,(JUL_QTDPREV + AGO_QTDPREV + SET_QTDPREV + OUT_QTDPREV+NOV_QTDPREV+DEZ_QTDPREV+JAN_QTDPREV+FEV_QTDPREV+MAR_QTDPREV+ABR_QTDPREV+MAI_QTDPREV+JUN_QTDPREV) AS TTL_QTDPREV,(JUL_QTDREAL + AGO_QTDREAL + SET_QTDREAL + OUT_QTDREAL+NOV_QTDREAL+DEZ_QTDREAL+JAN_QTDREAL+FEV_QTDREAL+MAR_QTDREAL+ABR_QTDREAL+MAI_QTDREAL+JUN_QTDREAL) AS TTL_QTDREAL,(JUL_VLR_PREV + AGO_VLR_PREV + SET_VLR_PREV + OUT_VLR_PREV+NOV_VLR_PREV+DEZ_VLR_PREV+JAN_VLR_PREV+FEV_VLR_PREV+MAR_VLR_PREV+ABR_VLR_PREV+MAI_VLR_PREV+JUN_VLR_PREV) AS TTL_VLR_PREV,(JUL_VLR_REAL + AGO_VLR_REAL + SET_VLR_REAL + OUT_VLR_REAL+NOV_VLR_REAL+DEZ_VLR_REAL+JAN_VLR_REAL+FEV_VLR_REAL+MAR_VLR_REAL+ABR_VLR_REAL+MAI_VLR_REAL+JUN_VLR_REAL) AS TTL_VLR_REALFROM (SELECT     MARCA,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUL_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUL_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUL_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUL_VLR_REAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS AGO_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS AGO_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS AGO_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS AGO_VLR_REAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS SET_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS SET_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS SET_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS SET_VLR_REAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS OUT_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS OUT_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS OUT_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS OUT_VLR_REAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS NOV_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS NOV_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS NOV_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS NOV_VLR_REAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS DEZ_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS DEZ_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS DEZ_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS DEZ_VLR_REAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JAN_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JAN_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JAN_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JAN_VLR_REAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS FEV_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS FEV_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS FEV_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS FEV_VLR_REAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAR_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAR_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAR_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAR_VLR_REAL,        SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS ABR_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS ABR_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS ABR_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS ABR_VLR_REAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAI_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAI_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAI_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAI_VLR_REAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUN_QTDPREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUN_QTDREAL,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUN_VLR_PREV,    SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUN_VLR_REALFROM(SELECT MET.DTREF, NVL(MET.CODVEND,0) AS CODVEND, NVL(MET.CODPARC,0) AS CODPARC, NVL(MET.MARCA,0) AS MARCA,NVL(VGF.CODCENCUS,0) AS CODCENCUS, NVL(MET.QTDPREV,0) AS QTDPREV, SUM(NVL(VGF.QTD,0)) AS QTDREAL,NVL(PRC.VLRVENDALT,0)AS PRECOLT, SUM(NVL(VGF.VLR,0)) AS VLRREALFROM TGFMET METLEFT JOIN VGF_VENDAS_SATIS VGF ON MET.DTREF = TRUNC(VGF.DTMOV,'MM') AND MET.CODVEND = VGF.CODVEND AND MET.CODPARC = VGF.CODPARC AND MET.MARCA = VGF.MARCA AND VGF.BONIFICACAO = 'N'LEFT JOIN AD_PRECOMARCA PRC ON (MET.MARCA = PRC.MARCA AND PRC.CODMETA = MET.CODMETA AND PRC.DTREF = (SELECT MAX(DTREF) FROM AD_PRECOMARCA WHERE CODMETA = MET.CODMETA AND DTREF <= MET.DTREF AND MARCA = MET.MARCA))WHERE MET.CODMETA = :P_CODMETAAND (  (:P_PERIODO1.INI IS NULL AND :P_PERIODO1.FIN IS NULL) OR (MET.DTREF BETWEEN :P_PERIODO1.INI AND :P_PERIODO1.FIN))   AND (VGF.CODGRUPOPROD = :P_GRUPOPROD OR :P_GRUPOPROD IS NULL)GROUP BY MET.DTREF,NVL(MET.CODVEND,0),NVL(MET.CODPARC,0),NVL(MET.MARCA,0),NVL(VGF.CODCENCUS,0), NVL(MET.QTDPREV,0), NVL(PRC.VLRVENDALT,0))AINNER JOIN TGFPAR PAR ON A.CODPARC = PAR.CODPARCINNER JOIN TGFVEN VEN ON A.CODVEND = VEN.CODVENDWHERE(VEN.CODVEND IN :P_CODVEND)AND (VEN.CODGER IN :P_CODGER)AND (PAR.CODPARC = :P_CODPARC OR :P_CODPARC IS NULL)AND (A.MARCA IN (SELECT MARCA FROM TGFPRO WHERE CODPROD IN :P_MARCA))AND (A.CODCENCUS = :P_CR OR :P_CR IS NULL)AND(VEN.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA VENDEDOROR VEN.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA GERENTEOR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' ---CONSULTA MASTER)GROUP BY MARCA)T)WHERE ((:P_NTEMMETA = 'S' AND (TTL_QTDPREV <> 0 OR TTL_QTDREAL <> 0 OR TTL_VLR_PREV <> 0 OR TTL_VLR_REAL<> 0)) OR :P_NTEMMETA = 'N')ORDER BY 1]]></expression>
          <metadata>
            <field name="MARCA" label="Marca" type="S" visible="true" useFooter="false"/>
            <field name="JUL_QTDPREV" label="Jul. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUL_QTDREAL" label="Jul. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUL_VLR_PREV" label="Jul. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUL_VLR_REAL" label="Jul. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="AGO_QTDPREV" label="Ago. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="AGO_QTDREAL" label="Ago. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="AGO_VLR_PREV" label="Ago. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="AGO_VLR_REAL" label="Ago. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="SET_QTDPREV" label="Set. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="SET_QTDREAL" label="Set. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="SET_VLR_PREV" label="Set. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="SET_VLR_REAL" label="Set. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="OUT_QTDPREV" label="Out. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="OUT_QTDREAL" label="Out. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="OUT_VLR_PREV" label="Out. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="OUT_VLR_REAL" label="Out. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="NOV_QTDPREV" label="Nov. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="NOV_QTDREAL" label="Nov. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="NOV_VLR_PREV" label="Nov. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="NOV_VLR_REAL" label="Nov. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="DEZ_QTDPREV" label="Dez. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="DEZ_QTDREAL" label="Dez. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="DEZ_VLR_PREV" label="Dez. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="DEZ_VLR_REAL" label="Dez. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JAN_QTDPREV" label="Jan. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JAN_QTDREAL" label="Jan. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JAN_VLR_PREV" label="Jan. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JAN_VLR_REAL" label="Jan. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="FEV_QTDPREV" label="Fev. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="FEV_QTDREAL" label="Fev. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="FEV_VLR_PREV" label="Fev. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="FEV_VLR_REAL" label="Fev. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="MAR_QTDPREV" label="Mar. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAR_QTDREAL" label="Mar. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAR_VLR_PREV" label="Mar. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAR_VLR_REAL" label="Mar. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="ABR_QTDPREV" label="Abr. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="ABR_QTDREAL" label="Abr. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="ABR_VLR_PREV" label="Abr. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="ABR_VLR_REAL" label="Abr. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="MAI_QTDPREV" label="Mai. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAI_QTDREAL" label="Mai. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAI_VLR_PREV" label="Mai. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAI_VLR_REAL" label="Mai. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUN_QTDPREV" label="Jun. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JUN_QTDREAL" label="Jun. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JUN_VLR_PREV" label="Jun. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JUN_VLR_REAL" label="Jun. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="TTL_QTDPREV" label="Ttl. Qtd. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
            <field name="TTL_QTDREAL" label="Ttl. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
            <field name="TTL_VLR_PREV" label="Ttl. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
            <field name="TTL_VLR_REAL" label="Ttl. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
          </metadata>
          <on-click navigate-to="lvl_f1xj5j"/>
        </grid>
      </container>
    </container>
  </level>
  <level id="lvl_p6ng9q" description="Nivel1_A">
    <args>
      <arg id="A_CODVEND" type="integer"/>
      <arg id="A_VENDEDOR" type="text"/>
    </args>
    <container orientacao="V" tamanhoRelativo="100">
      <container orientacao="H" tamanhoRelativo="50">
        <container orientacao="H" tamanhoRelativo="100">
          <chart id="cht_vrj7n5" type="line" nroColuna="12">
            <title><![CDATA[<b>Evolução Meta por VOLUME -  :A_VENDEDOR - DE :P_PERIODO.INI A: :P_PERIODO.FIN  >>> :A_VENDEDOR </b>]]></title>
            <expression type="sql" data-source="MGEDS"><![CDATA[SELECTCODVEND,VENDEDOR,MES,ORDEM,MES1,SUM(QTDPREV1) AS QTDPREV1,SUM(QTDREAL1) AS QTDREAL1,SUM(VLRPREV1) AS VLRPREV1,SUM(VLRREAL1) AS VLRREAL1,SUM(QTDPREV2) AS QTDPREV2,SUM(QTDREAL2) AS QTDREAL2,SUM(VLRPREV2) AS VLRPREV2,SUM(VLRREAL2) AS VLRREAL2FROM(SELECT(CASE     WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEN3.CODGER    ELSE B.CODVEND END) AS CODVEND,  (CASE    WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEN3.APELIDO    ELSE B.APELIDO END) AS VENDEDOR,MES,QTDPREV1,QTDREAL1,VLRPREV1,VLRREAL1,QTDPREV2,QTDREAL2,VLRPREV2,VLRREAL2,	ORDEM,MES1FROM(SELECTCODVEND,APELIDO,MAX(MES) AS MES,SUM(QTDPREV1) AS QTDPREV1,SUM(QTDREAL1) AS QTDREAL1,SUM(VLRPREV1) AS VLRPREV1,SUM(VLRREAL1) AS VLRREAL1,SUM(QTDPREV2) AS QTDPREV2,SUM(QTDREAL2) AS QTDREAL2,SUM(VLRPREV2) AS VLRPREV2,SUM(VLRREAL2) AS VLRREAL2,CASE WHEN MES = '07' THEN 1WHEN MES = '08' THEN 2WHEN MES = '09' THEN 3WHEN MES = '10' THEN 4WHEN MES = '11' THEN 5WHEN MES = '12' THEN 6WHEN MES = '01' THEN 7WHEN MES = '02' THEN 8WHEN MES = '03' THEN 9WHEN MES = '04' THEN 10WHEN MES = '05' THEN 11WHEN MES = '06' THEN 12ELSE 0 END AS ORDEM,CASE WHEN MES = '07' THEN 'JUL'WHEN MES = '08' THEN 'AGO'WHEN MES = '09' THEN 'SET'WHEN MES = '10' THEN 'OUT'WHEN MES = '11' THEN 'NOV'WHEN MES = '12' THEN 'DEZ'WHEN MES = '01' THEN 'JAN'WHEN MES = '02' THEN 'FEV'WHEN MES = '03' THEN 'MAR'WHEN MES = '04' THEN 'ABR'WHEN MES = '05' THEN 'MAI'WHEN MES = '06' THEN 'JUN'ELSE '0' END AS MES1  FROM(SELECTCODVEND,APELIDO,CASE WHEN MES1 <> '0' THEN MES1 ELSE MES2 END AS MES,SUM(QTDPREV1) AS QTDPREV1,SUM(QTDREAL1) AS QTDREAL1,SUM(VLRPREV1) AS VLRPREV1,SUM(VLRREAL1) AS VLRREAL1,SUM(QTDPREV2) AS QTDPREV2,SUM(QTDREAL2) AS QTDREAL2,SUM(VLRPREV2) AS VLRPREV2,SUM(VLRREAL2) AS VLRREAL2FROM(SELECT A.CODVEND,APELIDO,(CASE WHEN SAFRA1 = 'SAFRA1'THEN MES1 ELSE '0' END) AS MES1,SUM(CASE WHEN SAFRA1 = 'SAFRA1'THEN QTDPREV ELSE 0 END) AS QTDPREV1,SUM(CASE WHEN SAFRA1 = 'SAFRA1'THEN QTDREAL ELSE 0 END) AS QTDREAL1,SUM(CASE WHEN SAFRA1 = 'SAFRA1'THEN (QTDPREV * PRECOLT) ELSE 0 END) AS VLRPREV1,SUM(CASE WHEN SAFRA1 = 'SAFRA1'THEN VLRREAL ELSE 0 END) AS VLRREAL1,'0' AS MES2,0 AS QTDPREV2,0 AS QTDREAL2,0 AS VLRPREV2,0 AS VLRREAL2FROM(SELECT MET.DTREF, NVL(MET.CODVEND,0) AS CODVEND, NVL(MET.CODPARC,0) AS CODPARC, NVL(MET.MARCA,0) AS MARCA,NVL(VGF.CODCENCUS,0) AS CODCENCUS, NVL(MET.QTDPREV,0) AS QTDPREV, SUM(NVL(VGF.QTD,0)) AS QTDREAL,NVL(PRC.VLRVENDALT,0)AS PRECOLT, SUM(NVL(VGF.VLR,0)) AS VLRREAL,MAX(CASE WHEN (MET.DTREF BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN) THEN 'SAFRA1' END) AS SAFRA1,MAX(CASE WHEN (MET.DTREF BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN) THEN TO_CHAR(MET.DTREF,'MM') END) AS MES1FROM TGFMET METLEFT JOIN VGF_VENDAS_SATIS VGF ON MET.DTREF = TRUNC(VGF.DTMOV,'MM') AND MET.CODVEND = VGF.CODVEND AND MET.CODPARC = VGF.CODPARC AND MET.MARCA = VGF.MARCA AND VGF.BONIFICACAO = 'N'LEFT JOIN AD_PRECOMARCA PRC ON (MET.MARCA = PRC.MARCA AND PRC.CODMETA = MET.CODMETA AND PRC.DTREF = (SELECT MAX(DTREF) FROM AD_PRECOMARCA WHERE CODMETA = MET.CODMETA AND DTREF <= MET.DTREF AND MARCA = MET.MARCA))WHERE MET.CODMETA = :P_CODMETAAND MET.DTREF BETWEEN :P_PERIODO.INI AND :P_PERIODO.FINAND ((:P_NTEMMETA = 'S' AND (MET.QTDPREV <> 0 OR MET.QTDREAL <> 0)) OR :P_NTEMMETA = 'N')AND (VGF.CODGRUPOPROD = :P_GRUPOPROD OR :P_GRUPOPROD IS NULL)GROUP BY MET.DTREF,NVL(MET.CODVEND,0),NVL(MET.CODPARC,0),NVL(MET.MARCA,0),NVL(VGF.CODCENCUS,0), NVL(MET.QTDPREV,0),NVL(PRC.VLRVENDALT,0)) AINNER JOIN TGFVEN VEN ON A.CODVEND = VEN.CODVENDINNER JOIN TGFPAR PAR ON A.CODPARC = PAR.CODPARCWHERE(VEN.CODGER IN :P_CODGER)AND (PAR.CODPARC = :P_CODPARC OR :P_CODPARC IS NULL)AND (A.MARCA IN (SELECT MARCA FROM TGFPRO WHERE CODPROD IN :P_MARCA))AND (A.CODCENCUS = :P_CR OR :P_CR IS NULL)AND(VEN.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA VENDEDOROR VEN.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA GERENTEOR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' ---CONSULTA MASTER)GROUP BY A.CODVEND, APELIDO, (CASE WHEN SAFRA1 = 'SAFRA1'THEN MES1 ELSE '0' END)UNION ALLSELECT A.CODVEND,APELIDO,'0' AS MES1,0 AS QTDPREV1,0 AS QTDREAL1,0 AS VLRPREV1,0 AS VLRREAL1,(CASE WHEN SAFRA2 = 'SAFRA2'THEN MES2 ELSE '0' END) MES2,SUM(CASE WHEN SAFRA2 = 'SAFRA2'THEN QTDPREV ELSE 0 END) AS QTDPREV2,SUM(CASE WHEN SAFRA2 = 'SAFRA2'THEN QTDREAL ELSE 0 END) AS QTDREAL2,SUM(CASE WHEN SAFRA2 = 'SAFRA2'THEN (QTDPREV * PRECOLT) ELSE 0 END) AS VLRPREV2,SUM(CASE WHEN SAFRA2 = 'SAFRA2'THEN VLRREAL ELSE 0 END) AS VLRREAL2FROM(SELECT MET.DTREF, NVL(MET.CODVEND,0) AS CODVEND, NVL(MET.CODPARC,0) AS CODPARC, NVL(MET.MARCA,0) AS MARCA,NVL(VGF.CODCENCUS,0) AS CODCENCUS, NVL(MET.QTDPREV,0) AS QTDPREV, SUM(NVL(VGF.QTD,0)) AS QTDREAL,NVL(PRC.VLRVENDALT,0)AS PRECOLT, SUM(NVL(VGF.VLR,0)) AS VLRREAL,MAX(CASE WHEN (MET.DTREF BETWEEN :P_PERIODO1.INI AND :P_PERIODO1.FIN) THEN 'SAFRA2' END) AS SAFRA2,MAX(CASE WHEN (MET.DTREF BETWEEN :P_PERIODO1.INI AND :P_PERIODO1.FIN) THEN TO_CHAR(MET.DTREF,'MM') END) AS MES2FROM TGFMET METLEFT JOIN VGF_VENDAS_SATIS VGF ON MET.DTREF = TRUNC(VGF.DTMOV,'MM') AND MET.CODVEND = VGF.CODVEND AND MET.CODPARC = VGF.CODPARC AND MET.MARCA = VGF.MARCA AND VGF.BONIFICACAO = 'N'LEFT JOIN AD_PRECOMARCA PRC ON (MET.MARCA = PRC.MARCA AND PRC.CODMETA = MET.CODMETA AND PRC.DTREF = (SELECT MAX(DTREF) FROM AD_PRECOMARCA WHERE CODMETA = MET.CODMETA AND DTREF <= MET.DTREF AND MARCA = MET.MARCA))WHERE MET.CODMETA = :P_CODMETAAND (  (:P_PERIODO1.INI IS NULL AND :P_PERIODO1.FIN IS NULL) OR (MET.DTREF BETWEEN :P_PERIODO1.INI AND :P_PERIODO1.FIN))AND ((:P_NTEMMETA = 'S' AND (MET.QTDPREV <> 0 OR MET.QTDREAL <> 0)) OR :P_NTEMMETA = 'N')AND (VGF.CODGRUPOPROD = :P_GRUPOPROD OR :P_GRUPOPROD IS NULL)GROUP BY MET.DTREF,NVL(MET.CODVEND,0),NVL(MET.CODPARC,0),NVL(MET.MARCA,0),NVL(VGF.CODCENCUS,0), NVL(MET.QTDPREV,0),NVL(PRC.VLRVENDALT,0))AINNER JOIN TGFVEN VEN ON A.CODVEND = VEN.CODVENDINNER JOIN TGFPAR PAR ON A.CODPARC = PAR.CODPARCWHERE(VEN.CODGER IN :P_CODGER)AND (PAR.CODPARC = :P_CODPARC OR :P_CODPARC IS NULL)AND (A.MARCA IN (SELECT MARCA FROM TGFPRO WHERE CODPROD IN :P_MARCA))AND (A.CODCENCUS = :P_CR OR :P_CR IS NULL)AND(VEN.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA VENDEDOROR VEN.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA GERENTEOR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' ---CONSULTA MASTER)GROUP BY A.CODVEND, APELIDO,(CASE WHEN SAFRA2 = 'SAFRA2'THEN MES2 ELSE '0' END))GROUP BYCODVEND,APELIDO,MES1,MES2)GROUP BYCODVEND,APELIDO,MES)BINNER JOIN TGFVEN VEN3 ON B.CODVEND = VEN3.CODVEND)WHERE (CODVEND = :A_CODVEND)GROUP BY CODVEND,VENDEDOR,MES,ORDEM,MES1ORDER BY ORDEM]]></expression>
            <metadata>
              <field name="CODVEND" label="CODVEND" type="I" visible="true" useFooter="false"/>
              <field name="VENDEDOR" label="VENDEDOR" type="S" visible="true" useFooter="false"/>
              <field name="MES" label="MES" type="S" visible="true" useFooter="false"/>
              <field name="ORDEM" label="ORDEM" type="I" visible="true" useFooter="false" mask=""/>
              <field name="MES1" label="Mês" type="S" visible="true" useFooter="false"/>
              <field name="QTDPREV1" label="Qtd. Prev.1" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
              <field name="QTDREAL1" label="Qtd. Real1" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
              <field name="VLRPREV1" label="Vlr. Prev.1" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
              <field name="VLRREAL1" label="Vlr. Real1" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
              <field name="QTDPREV2" label="Qtd. Prev.2" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
              <field name="QTDREAL2" label="Qtd. Real2" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
              <field name="VLRPREV2" label="Vlr. Prev.2" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
              <field name="VLRREAL2" label="VLRREAL2" type="I" visible="true" useFooter="false"/>
            </metadata>
            <horizontal-axis>
              <category field="MES1" rotation="-90" dropLabel="false">
                <initView value="first"/>
              </category>
            </horizontal-axis>
            <vertical-axis>
              <linear resultRotation="-45" vResizing="true">
                <mask/>
              </linear>
            </vertical-axis>
            <series>
              <serie type="line" circle-intersection="true">
                <xField>MES1</xField>
                <yField>QTDPREV1</yField>
                <display><![CDATA[Atual Volume - Prev.1]]></display>
                <color>0xff</color>
              </serie>
              <serie type="line" circle-intersection="true">
                <xField>MES1</xField>
                <yField>QTDREAL1</yField>
                <display><![CDATA[Atual Volume - Real1]]></display>
                <color>0x33ff00</color>
              </serie>
              <serie type="line" circle-intersection="true">
                <xField>MES1</xField>
                <yField>QTDPREV2</yField>
                <display><![CDATA[Anterior Volume - Prev.2]]></display>
                <color>0xff00ff</color>
              </serie>
              <serie type="line" circle-intersection="true">
                <xField>MES1</xField>
                <yField>QTDREAL2</yField>
                <display><![CDATA[Anterior Volume - Real2]]></display>
                <color>0xff0000</color>
              </serie>
            </series>
            <legend position="top" direction="v"/>
          </chart>
        </container>
      </container>
      <container orientacao="H" tamanhoRelativo="50">
        <container orientacao="H" tamanhoRelativo="100">
          <chart id="cht_vrj7qc" type="line" nroColuna="12">
            <title><![CDATA[<b>Evolução Meta por VALOR  :A_VENDEDOR -  DE: :P_PERIODO1.INI A: :P_PERIODO1.FIN  >>> :A_VENDEDOR </b>]]></title>
            <expression type="sql" data-source="MGEDS"><![CDATA[SELECTCODVEND,VENDEDOR,MES,ORDEM,MES1,SUM(QTDPREV1) AS QTDPREV1,SUM(QTDREAL1) AS QTDREAL1,SUM(VLRPREV1) AS VLRPREV1,SUM(VLRREAL1) AS VLRREAL1,SUM(QTDPREV2) AS QTDPREV2,SUM(QTDREAL2) AS QTDREAL2,SUM(VLRPREV2) AS VLRPREV2,SUM(VLRREAL2) AS VLRREAL2FROM(SELECT(CASE     WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEN3.CODGER    ELSE B.CODVEND END) AS CODVEND,  (CASE    WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEN3.APELIDO    ELSE B.APELIDO END) AS VENDEDOR,MES,QTDPREV1,QTDREAL1,VLRPREV1,VLRREAL1,QTDPREV2,QTDREAL2,VLRPREV2,VLRREAL2,	ORDEM,MES1FROM(SELECTCODVEND,APELIDO,MAX(MES) AS MES,SUM(QTDPREV1) AS QTDPREV1,SUM(QTDREAL1) AS QTDREAL1,SUM(VLRPREV1) AS VLRPREV1,SUM(VLRREAL1) AS VLRREAL1,SUM(QTDPREV2) AS QTDPREV2,SUM(QTDREAL2) AS QTDREAL2,SUM(VLRPREV2) AS VLRPREV2,SUM(VLRREAL2) AS VLRREAL2,CASE WHEN MES = '07' THEN 1WHEN MES = '08' THEN 2WHEN MES = '09' THEN 3WHEN MES = '10' THEN 4WHEN MES = '11' THEN 5WHEN MES = '12' THEN 6WHEN MES = '01' THEN 7WHEN MES = '02' THEN 8WHEN MES = '03' THEN 9WHEN MES = '04' THEN 10WHEN MES = '05' THEN 11WHEN MES = '06' THEN 12ELSE 0 END AS ORDEM,CASE WHEN MES = '07' THEN 'JUL'WHEN MES = '08' THEN 'AGO'WHEN MES = '09' THEN 'SET'WHEN MES = '10' THEN 'OUT'WHEN MES = '11' THEN 'NOV'WHEN MES = '12' THEN 'DEZ'WHEN MES = '01' THEN 'JAN'WHEN MES = '02' THEN 'FEV'WHEN MES = '03' THEN 'MAR'WHEN MES = '04' THEN 'ABR'WHEN MES = '05' THEN 'MAI'WHEN MES = '06' THEN 'JUN'ELSE '0' END AS MES1  FROM(SELECTCODVEND,APELIDO,CASE WHEN MES1 <> '0' THEN MES1 ELSE MES2 END AS MES,SUM(QTDPREV1) AS QTDPREV1,SUM(QTDREAL1) AS QTDREAL1,SUM(VLRPREV1) AS VLRPREV1,SUM(VLRREAL1) AS VLRREAL1,SUM(QTDPREV2) AS QTDPREV2,SUM(QTDREAL2) AS QTDREAL2,SUM(VLRPREV2) AS VLRPREV2,SUM(VLRREAL2) AS VLRREAL2FROM(SELECT A.CODVEND,APELIDO,(CASE WHEN SAFRA1 = 'SAFRA1'THEN MES1 ELSE '0' END) AS MES1,SUM(CASE WHEN SAFRA1 = 'SAFRA1'THEN QTDPREV ELSE 0 END) AS QTDPREV1,SUM(CASE WHEN SAFRA1 = 'SAFRA1'THEN QTDREAL ELSE 0 END) AS QTDREAL1,SUM(CASE WHEN SAFRA1 = 'SAFRA1'THEN (QTDPREV * PRECOLT) ELSE 0 END) AS VLRPREV1,SUM(CASE WHEN SAFRA1 = 'SAFRA1'THEN VLRREAL ELSE 0 END) AS VLRREAL1,'0' AS MES2,0 AS QTDPREV2,0 AS QTDREAL2,0 AS VLRPREV2,0 AS VLRREAL2FROM(SELECT MET.DTREF, NVL(MET.CODVEND,0) AS CODVEND, NVL(MET.CODPARC,0) AS CODPARC, NVL(MET.MARCA,0) AS MARCA,NVL(VGF.CODCENCUS,0) AS CODCENCUS, NVL(MET.QTDPREV,0) AS QTDPREV, SUM(NVL(VGF.QTD,0)) AS QTDREAL,NVL(PRC.VLRVENDALT,0)AS PRECOLT, SUM(NVL(VGF.VLR,0)) AS VLRREAL,MAX(CASE WHEN (MET.DTREF BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN) THEN 'SAFRA1' END) AS SAFRA1,MAX(CASE WHEN (MET.DTREF BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN) THEN TO_CHAR(MET.DTREF,'MM') END) AS MES1FROM TGFMET METLEFT JOIN VGF_VENDAS_SATIS VGF ON MET.DTREF = TRUNC(VGF.DTMOV,'MM') AND MET.CODVEND = VGF.CODVEND AND MET.CODPARC = VGF.CODPARC AND MET.MARCA = VGF.MARCA AND VGF.BONIFICACAO = 'N'LEFT JOIN AD_PRECOMARCA PRC ON (MET.MARCA = PRC.MARCA AND PRC.CODMETA = MET.CODMETA AND PRC.DTREF = (SELECT MAX(DTREF) FROM AD_PRECOMARCA WHERE CODMETA = MET.CODMETA AND DTREF <= MET.DTREF AND MARCA = MET.MARCA))WHERE MET.CODMETA = :P_CODMETAAND MET.DTREF BETWEEN :P_PERIODO.INI AND :P_PERIODO.FINAND ((:P_NTEMMETA = 'S' AND (MET.QTDPREV <> 0 OR MET.QTDREAL <> 0)) OR :P_NTEMMETA = 'N')AND (VGF.CODGRUPOPROD = :P_GRUPOPROD OR :P_GRUPOPROD IS NULL)GROUP BY MET.DTREF,NVL(MET.CODVEND,0),NVL(MET.CODPARC,0),NVL(MET.MARCA,0),NVL(VGF.CODCENCUS,0), NVL(MET.QTDPREV,0),NVL(PRC.VLRVENDALT,0)) AINNER JOIN TGFVEN VEN ON A.CODVEND = VEN.CODVENDINNER JOIN TGFPAR PAR ON A.CODPARC = PAR.CODPARCWHERE(VEN.CODGER IN :P_CODGER)AND (PAR.CODPARC = :P_CODPARC OR :P_CODPARC IS NULL)AND (A.MARCA IN (SELECT MARCA FROM TGFPRO WHERE CODPROD IN :P_MARCA))AND (A.CODCENCUS = :P_CR OR :P_CR IS NULL)AND(VEN.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA VENDEDOROR VEN.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA GERENTEOR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' ---CONSULTA MASTER)GROUP BY A.CODVEND, APELIDO, (CASE WHEN SAFRA1 = 'SAFRA1'THEN MES1 ELSE '0' END)UNION ALLSELECT A.CODVEND,APELIDO,'0' AS MES1,0 AS QTDPREV1,0 AS QTDREAL1,0 AS VLRPREV1,0 AS VLRREAL1,(CASE WHEN SAFRA2 = 'SAFRA2'THEN MES2 ELSE '0' END) MES2,SUM(CASE WHEN SAFRA2 = 'SAFRA2'THEN QTDPREV ELSE 0 END) AS QTDPREV2,SUM(CASE WHEN SAFRA2 = 'SAFRA2'THEN QTDREAL ELSE 0 END) AS QTDREAL2,SUM(CASE WHEN SAFRA2 = 'SAFRA2'THEN (QTDPREV * PRECOLT) ELSE 0 END) AS VLRPREV2,SUM(CASE WHEN SAFRA2 = 'SAFRA2'THEN VLRREAL ELSE 0 END) AS VLRREAL2FROM(SELECT MET.DTREF, NVL(MET.CODVEND,0) AS CODVEND, NVL(MET.CODPARC,0) AS CODPARC, NVL(MET.MARCA,0) AS MARCA,NVL(VGF.CODCENCUS,0) AS CODCENCUS, NVL(MET.QTDPREV,0) AS QTDPREV, SUM(NVL(VGF.QTD,0)) AS QTDREAL,NVL(PRC.VLRVENDALT,0)AS PRECOLT, SUM(NVL(VGF.VLR,0)) AS VLRREAL,MAX(CASE WHEN (MET.DTREF BETWEEN :P_PERIODO1.INI AND :P_PERIODO1.FIN) THEN 'SAFRA2' END) AS SAFRA2,MAX(CASE WHEN (MET.DTREF BETWEEN :P_PERIODO1.INI AND :P_PERIODO1.FIN) THEN TO_CHAR(MET.DTREF,'MM') END) AS MES2FROM TGFMET METLEFT JOIN VGF_VENDAS_SATIS VGF ON MET.DTREF = TRUNC(VGF.DTMOV,'MM') AND MET.CODVEND = VGF.CODVEND AND MET.CODPARC = VGF.CODPARC AND MET.MARCA = VGF.MARCA AND VGF.BONIFICACAO = 'N'LEFT JOIN AD_PRECOMARCA PRC ON (MET.MARCA = PRC.MARCA AND PRC.CODMETA = MET.CODMETA AND PRC.DTREF = (SELECT MAX(DTREF) FROM AD_PRECOMARCA WHERE CODMETA = MET.CODMETA AND DTREF <= MET.DTREF AND MARCA = MET.MARCA))WHERE MET.CODMETA = :P_CODMETAAND (  (:P_PERIODO1.INI IS NULL AND :P_PERIODO1.FIN IS NULL) OR (MET.DTREF BETWEEN :P_PERIODO1.INI AND :P_PERIODO1.FIN))AND ((:P_NTEMMETA = 'S' AND (MET.QTDPREV <> 0 OR MET.QTDREAL <> 0)) OR :P_NTEMMETA = 'N')AND (VGF.CODGRUPOPROD = :P_GRUPOPROD OR :P_GRUPOPROD IS NULL)GROUP BY MET.DTREF,NVL(MET.CODVEND,0),NVL(MET.CODPARC,0),NVL(MET.MARCA,0),NVL(VGF.CODCENCUS,0), NVL(MET.QTDPREV,0),NVL(PRC.VLRVENDALT,0))AINNER JOIN TGFVEN VEN ON A.CODVEND = VEN.CODVENDINNER JOIN TGFPAR PAR ON A.CODPARC = PAR.CODPARCWHERE(VEN.CODGER IN :P_CODGER)AND (PAR.CODPARC = :P_CODPARC OR :P_CODPARC IS NULL)AND (A.MARCA IN (SELECT MARCA FROM TGFPRO WHERE CODPROD IN :P_MARCA))AND (A.CODCENCUS = :P_CR OR :P_CR IS NULL)AND(VEN.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA VENDEDOROR VEN.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA GERENTEOR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' ---CONSULTA MASTER)GROUP BY A.CODVEND, APELIDO,(CASE WHEN SAFRA2 = 'SAFRA2'THEN MES2 ELSE '0' END))GROUP BYCODVEND,APELIDO,MES1,MES2)GROUP BYCODVEND,APELIDO,MES)BINNER JOIN TGFVEN VEN3 ON B.CODVEND = VEN3.CODVEND)WHERE (CODVEND = :A_CODVEND)GROUP BY CODVEND,VENDEDOR,MES,ORDEM,MES1ORDER BY ORDEM]]></expression>
            <metadata>
              <field name="CODVEND" label="CODVEND" type="I" visible="true" useFooter="false"/>
              <field name="VENDEDOR" label="VENDEDOR" type="S" visible="true" useFooter="false"/>
              <field name="MES" label="MES" type="S" visible="true" useFooter="false"/>
              <field name="ORDEM" label="ORDEM" type="I" visible="true" useFooter="false" mask=""/>
              <field name="MES1" label="Mês" type="S" visible="true" useFooter="false"/>
              <field name="QTDPREV1" label="Qtd. Prev.1" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
              <field name="QTDREAL1" label="Qtd. Real1" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
              <field name="VLRPREV1" label="Vlr. Prev.1" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
              <field name="VLRREAL1" label="Vlr. Real1" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
              <field name="QTDPREV2" label="Qtd. Prev.2" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
              <field name="QTDREAL2" label="Qtd. Real2" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
              <field name="VLRPREV2" label="Vlr. Prev.2" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
              <field name="VLRREAL2" label="Vlr. Real2" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
            </metadata>
            <horizontal-axis>
              <category field="MES1" rotation="-90" dropLabel="false">
                <initView value="first"/>
              </category>
            </horizontal-axis>
            <vertical-axis>
              <linear resultRotation="-45" vResizing="true">
                <mask/>
              </linear>
            </vertical-axis>
            <series>
              <serie type="line" circle-intersection="true">
                <xField>MES1</xField>
                <yField>VLRPREV1</yField>
                <display><![CDATA[Atual Valor - Prev.1]]></display>
                <color>0xff</color>
              </serie>
              <serie type="line" circle-intersection="true">
                <xField>MES1</xField>
                <yField>VLRREAL1</yField>
                <display><![CDATA[Atual  Valor - Real1]]></display>
                <color>0x33ff00</color>
              </serie>
              <serie type="line" circle-intersection="true">
                <xField>MES1</xField>
                <yField>VLRPREV2</yField>
                <display><![CDATA[Anterior Valor - Prev.2]]></display>
                <color>0xff00ff</color>
              </serie>
              <serie type="line" circle-intersection="true">
                <xField>MES1</xField>
                <yField>VLRREAL2</yField>
                <display><![CDATA[Anterior Valor - Real2]]></display>
                <color>0xff0000</color>
              </serie>
            </series>
            <legend position="top" direction="v"/>
          </chart>
        </container>
      </container>
    </container>
  </level>
  <level id="lvl_vrj7sv" description="Nivel1_B">
    <container orientacao="V" tamanhoRelativo="100">
      <container orientacao="V" tamanhoRelativo="50">
        <chart id="cht_vrj7sx" type="line" nroColuna="12">
          <title><![CDATA[<b>Evolução Meta por VOLUME - DE :P_PERIODO.INI A: :P_PERIODO.FIN</b>]]></title>
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECTMAX(MES) AS MES,SUM(QTDPREV1) AS QTDPREV1,SUM(QTDREAL1) AS QTDREAL1,SUM(VLRPREV1) AS VLRPREV1,SUM(VLRREAL1) AS VLRREAL1,SUM(QTDPREV2) AS QTDPREV2,SUM(QTDREAL2) AS QTDREAL2,SUM(VLRPREV2) AS VLRPREV2,SUM(VLRREAL2) AS VLRREAL2,CASE WHEN MES = '07' THEN 1WHEN MES = '08' THEN 2WHEN MES = '09' THEN 3WHEN MES = '10' THEN 4WHEN MES = '11' THEN 5WHEN MES = '12' THEN 6WHEN MES = '01' THEN 7WHEN MES = '02' THEN 8WHEN MES = '03' THEN 9WHEN MES = '04' THEN 10WHEN MES = '05' THEN 11WHEN MES = '06' THEN 12ELSE 0 END AS ORDEM,CASE WHEN MES = '07' THEN 'JUL'WHEN MES = '08' THEN 'AGO'WHEN MES = '09' THEN 'SET'WHEN MES = '10' THEN 'OUT'WHEN MES = '11' THEN 'NOV'WHEN MES = '12' THEN 'DEZ'WHEN MES = '01' THEN 'JAN'WHEN MES = '02' THEN 'FEV'WHEN MES = '03' THEN 'MAR'WHEN MES = '04' THEN 'ABR'WHEN MES = '05' THEN 'MAI'WHEN MES = '06' THEN 'JUN'ELSE '0' END AS MES1  FROM(SELECTCASE WHEN MES1 <> '0' THEN MES1 ELSE MES2 END AS MES,SUM(QTDPREV1) AS QTDPREV1,SUM(QTDREAL1) AS QTDREAL1,SUM(VLRPREV1) AS VLRPREV1,SUM(VLRREAL1) AS VLRREAL1,SUM(QTDPREV2) AS QTDPREV2,SUM(QTDREAL2) AS QTDREAL2,SUM(VLRPREV2) AS VLRPREV2,SUM(VLRREAL2) AS VLRREAL2FROM(SELECT (CASE WHEN SAFRA1 = 'SAFRA1'THEN MES1 ELSE '0' END) AS MES1,SUM(CASE WHEN SAFRA1 = 'SAFRA1'THEN QTDPREV ELSE 0 END) AS QTDPREV1,SUM(CASE WHEN SAFRA1 = 'SAFRA1'THEN QTDREAL ELSE 0 END) AS QTDREAL1,SUM(CASE WHEN SAFRA1 = 'SAFRA1'THEN (QTDPREV * PRECOLT) ELSE 0 END) AS VLRPREV1,SUM(CASE WHEN SAFRA1 = 'SAFRA1'THEN VLRREAL ELSE 0 END) AS VLRREAL1,'0' AS MES2,0 AS QTDPREV2,0 AS QTDREAL2,0 AS VLRPREV2,0 AS VLRREAL2FROM(SELECT MET.DTREF, NVL(MET.CODVEND,0) AS CODVEND, NVL(MET.CODPARC,0) AS CODPARC, NVL(MET.MARCA,0) AS MARCA,NVL(VGF.CODCENCUS,0) AS CODCENCUS, NVL(MET.QTDPREV,0) AS QTDPREV, SUM(NVL(VGF.QTD,0)) AS QTDREAL,NVL(PRC.VLRVENDALT,0)AS PRECOLT, SUM(NVL(VGF.VLR,0)) AS VLRREAL,MAX(CASE WHEN (MET.DTREF BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN) THEN 'SAFRA1' END) AS SAFRA1,MAX(CASE WHEN (MET.DTREF BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN) THEN TO_CHAR(MET.DTREF,'MM') END) AS MES1FROM TGFMET METLEFT JOIN VGF_VENDAS_SATIS VGF ON MET.DTREF = TRUNC(VGF.DTMOV,'MM') AND MET.CODVEND = VGF.CODVEND AND MET.CODPARC = VGF.CODPARC AND MET.MARCA = VGF.MARCA AND VGF.BONIFICACAO = 'N'LEFT JOIN AD_PRECOMARCA PRC ON (MET.MARCA = PRC.MARCA AND PRC.CODMETA = MET.CODMETA AND PRC.DTREF = (SELECT MAX(DTREF) FROM AD_PRECOMARCA WHERE CODMETA = MET.CODMETA AND DTREF <= MET.DTREF AND MARCA = MET.MARCA))WHERE MET.CODMETA = :P_CODMETAAND MET.DTREF BETWEEN :P_PERIODO.INI AND :P_PERIODO.FINAND ((:P_NTEMMETA = 'S' AND (MET.QTDPREV <> 0 OR MET.QTDREAL <> 0)) OR :P_NTEMMETA = 'N')AND (VGF.CODGRUPOPROD = :P_GRUPOPROD OR :P_GRUPOPROD IS NULL)GROUP BY MET.DTREF,NVL(MET.CODVEND,0),NVL(MET.CODPARC,0),NVL(MET.MARCA,0),NVL(VGF.CODCENCUS,0), NVL(MET.QTDPREV,0),NVL(PRC.VLRVENDALT,0)) AINNER JOIN TGFVEN VEN ON A.CODVEND = VEN.CODVENDINNER JOIN TGFPAR PAR ON A.CODPARC = PAR.CODPARCWHERE(VEN.CODGER IN :P_CODGER)AND (PAR.CODPARC = :P_CODPARC OR :P_CODPARC IS NULL)AND (A.MARCA IN (SELECT MARCA FROM TGFPRO WHERE CODPROD IN :P_MARCA))AND (A.CODCENCUS = :P_CR OR :P_CR IS NULL)AND(VEN.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA VENDEDOROR VEN.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA GERENTEOR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' ---CONSULTA MASTER)GROUP BY (CASE WHEN SAFRA1 = 'SAFRA1'THEN MES1 ELSE '0' END)UNION ALLSELECT '0' AS MES1,0 AS QTDPREV1,0 AS QTDREAL1,0 AS VLRPREV1,0 AS VLRREAL1,(CASE WHEN SAFRA2 = 'SAFRA2'THEN MES2 ELSE '0' END) MES2,SUM(CASE WHEN SAFRA2 = 'SAFRA2'THEN QTDPREV ELSE 0 END) AS QTDPREV2,SUM(CASE WHEN SAFRA2 = 'SAFRA2'THEN QTDREAL ELSE 0 END) AS QTDREAL2,SUM(CASE WHEN SAFRA2 = 'SAFRA2'THEN (QTDPREV * PRECOLT) ELSE 0 END) AS VLRPREV2,SUM(CASE WHEN SAFRA2 = 'SAFRA2'THEN VLRREAL ELSE 0 END) AS VLRREAL2FROM(SELECT MET.DTREF, NVL(MET.CODVEND,0) AS CODVEND, NVL(MET.CODPARC,0) AS CODPARC, NVL(MET.MARCA,0) AS MARCA,NVL(VGF.CODCENCUS,0) AS CODCENCUS, NVL(MET.QTDPREV,0) AS QTDPREV, SUM(NVL(VGF.QTD,0)) AS QTDREAL,NVL(PRC.VLRVENDALT,0)AS PRECOLT, SUM(NVL(VGF.VLR,0)) AS VLRREAL,MAX(CASE WHEN (MET.DTREF BETWEEN :P_PERIODO1.INI AND :P_PERIODO1.FIN) THEN 'SAFRA2' END) AS SAFRA2,MAX(CASE WHEN (MET.DTREF BETWEEN :P_PERIODO1.INI AND :P_PERIODO1.FIN) THEN TO_CHAR(MET.DTREF,'MM') END) AS MES2FROM TGFMET METLEFT JOIN VGF_VENDAS_SATIS VGF ON MET.DTREF = TRUNC(VGF.DTMOV,'MM') AND MET.CODVEND = VGF.CODVEND AND MET.CODPARC = VGF.CODPARC AND MET.MARCA = VGF.MARCA AND VGF.BONIFICACAO = 'N'LEFT JOIN AD_PRECOMARCA PRC ON (MET.MARCA = PRC.MARCA AND PRC.CODMETA = MET.CODMETA AND PRC.DTREF = (SELECT MAX(DTREF) FROM AD_PRECOMARCA WHERE CODMETA = MET.CODMETA AND DTREF <= MET.DTREF AND MARCA = MET.MARCA))WHERE MET.CODMETA = :P_CODMETAAND (  (:P_PERIODO1.INI IS NULL AND :P_PERIODO1.FIN IS NULL) OR (MET.DTREF BETWEEN :P_PERIODO1.INI AND :P_PERIODO1.FIN))AND ((:P_NTEMMETA = 'S' AND (MET.QTDPREV <> 0 OR MET.QTDREAL <> 0)) OR :P_NTEMMETA = 'N')AND (VGF.CODGRUPOPROD = :P_GRUPOPROD OR :P_GRUPOPROD IS NULL)GROUP BY MET.DTREF,NVL(MET.CODVEND,0),NVL(MET.CODPARC,0),NVL(MET.MARCA,0),NVL(VGF.CODCENCUS,0), NVL(MET.QTDPREV,0),NVL(PRC.VLRVENDALT,0))AINNER JOIN TGFVEN VEN ON A.CODVEND = VEN.CODVENDINNER JOIN TGFPAR PAR ON A.CODPARC = PAR.CODPARCWHERE(VEN.CODGER IN :P_CODGER)AND (PAR.CODPARC = :P_CODPARC OR :P_CODPARC IS NULL)AND (A.MARCA IN (SELECT MARCA FROM TGFPRO WHERE CODPROD IN :P_MARCA))AND (A.CODCENCUS = :P_CR OR :P_CR IS NULL)AND(VEN.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA VENDEDOROR VEN.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA GERENTEOR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' ---CONSULTA MASTER)GROUP BY (CASE WHEN SAFRA2 = 'SAFRA2'THEN MES2 ELSE '0' END))GROUP BYMES1,MES2)GROUP BYMESORDER BY "ORDEM"]]></expression>
          <metadata>
            <field name="MES" label="MES" type="S" visible="true" useFooter="false"/>
            <field name="QTDPREV1" label="Qtd. Prev.1" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
            <field name="QTDREAL1" label="Qtd. Real1" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
            <field name="VLRPREV1" label="Vlr. Prev.1" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
            <field name="VLRREAL1" label="Vlr. Real1" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
            <field name="QTDPREV2" label="Qtd. Prev.2" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
            <field name="QTDREAL2" label="Qtd. Real2" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
            <field name="VLRPREV2" label="Vlr. Prev.2" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
            <field name="VLRREAL2" label="Vlr. Real2" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
            <field name="ORDEM" label="ORDEM" type="I" visible="true" useFooter="false" mask=""/>
            <field name="MES1" label="Mês" type="S" visible="true" useFooter="false"/>
          </metadata>
          <horizontal-axis>
            <category field="MES1" rotation="-90" dropLabel="false">
              <initView value="first"/>
            </category>
          </horizontal-axis>
          <vertical-axis>
            <linear resultRotation="-45" vResizing="true">
              <mask/>
            </linear>
          </vertical-axis>
          <series>
            <serie type="line" circle-intersection="true">
              <xField>MES1</xField>
              <yField>QTDPREV1</yField>
              <display><![CDATA[Atual Volume - Prev.1]]></display>
              <color>0xff</color>
            </serie>
            <serie type="line" circle-intersection="true">
              <xField>MES1</xField>
              <yField>QTDREAL1</yField>
              <display><![CDATA[Atual Volume - Real1]]></display>
              <color>0x33ff00</color>
            </serie>
            <serie type="line" circle-intersection="true">
              <xField>MES1</xField>
              <yField>QTDPREV2</yField>
              <display><![CDATA[Anterior Volume - Prev.2]]></display>
              <color>0xff00ff</color>
            </serie>
            <serie type="line" circle-intersection="true">
              <xField>MES1</xField>
              <yField>QTDREAL2</yField>
              <display><![CDATA[Anterior Volume - Real2]]></display>
              <color>0xff0000</color>
            </serie>
          </series>
          <legend position="top" direction="v"/>
        </chart>
      </container>
      <container orientacao="V" tamanhoRelativo="50">
        <chart id="cht_vrj7sz" type="line" nroColuna="12">
          <title><![CDATA[<b>Evolução Meta por VALOR :P_PERIODO1.INI A: :P_PERIODO1.FIN</b>]]></title>
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECTMAX(MES) AS MES,SUM(QTDPREV1) AS QTDPREV1,SUM(QTDREAL1) AS QTDREAL1,SUM(VLRPREV1) AS VLRPREV1,SUM(VLRREAL1) AS VLRREAL1,SUM(QTDPREV2) AS QTDPREV2,SUM(QTDREAL2) AS QTDREAL2,SUM(VLRPREV2) AS VLRPREV2,SUM(VLRREAL2) AS VLRREAL2,CASE WHEN MES = '07' THEN 1WHEN MES = '08' THEN 2WHEN MES = '09' THEN 3WHEN MES = '10' THEN 4WHEN MES = '11' THEN 5WHEN MES = '12' THEN 6WHEN MES = '01' THEN 7WHEN MES = '02' THEN 8WHEN MES = '03' THEN 9WHEN MES = '04' THEN 10WHEN MES = '05' THEN 11WHEN MES = '06' THEN 12ELSE 0 END AS ORDEM,CASE WHEN MES = '07' THEN 'JUL'WHEN MES = '08' THEN 'AGO'WHEN MES = '09' THEN 'SET'WHEN MES = '10' THEN 'OUT'WHEN MES = '11' THEN 'NOV'WHEN MES = '12' THEN 'DEZ'WHEN MES = '01' THEN 'JAN'WHEN MES = '02' THEN 'FEV'WHEN MES = '03' THEN 'MAR'WHEN MES = '04' THEN 'ABR'WHEN MES = '05' THEN 'MAI'WHEN MES = '06' THEN 'JUN'ELSE '0' END AS MES1  FROM(SELECTCODVEND,APELIDO,CASE WHEN MES1 <> '0' THEN MES1 ELSE MES2 END AS MES,SUM(QTDPREV1) AS QTDPREV1,SUM(QTDREAL1) AS QTDREAL1,SUM(VLRPREV1) AS VLRPREV1,SUM(VLRREAL1) AS VLRREAL1,SUM(QTDPREV2) AS QTDPREV2,SUM(QTDREAL2) AS QTDREAL2,SUM(VLRPREV2) AS VLRPREV2,SUM(VLRREAL2) AS VLRREAL2FROM(SELECT A.CODVEND,APELIDO,(CASE WHEN SAFRA1 = 'SAFRA1'THEN MES1 ELSE '0' END) AS MES1,SUM(CASE WHEN SAFRA1 = 'SAFRA1'THEN QTDPREV ELSE 0 END) AS QTDPREV1,SUM(CASE WHEN SAFRA1 = 'SAFRA1'THEN QTDREAL ELSE 0 END) AS QTDREAL1,SUM(CASE WHEN SAFRA1 = 'SAFRA1'THEN (QTDPREV * PRECOLT) ELSE 0 END) AS VLRPREV1,SUM(CASE WHEN SAFRA1 = 'SAFRA1'THEN VLRREAL ELSE 0 END) AS VLRREAL1,'0' AS MES2,0 AS QTDPREV2,0 AS QTDREAL2,0 AS VLRPREV2,0 AS VLRREAL2FROM(SELECT MET.DTREF, NVL(MET.CODVEND,0) AS CODVEND, NVL(MET.CODPARC,0) AS CODPARC, NVL(MET.MARCA,0) AS MARCA,NVL(VGF.CODCENCUS,0) AS CODCENCUS, NVL(MET.QTDPREV,0) AS QTDPREV, SUM(NVL(VGF.QTD,0)) AS QTDREAL,NVL(PRC.VLRVENDALT,0)AS PRECOLT, SUM(NVL(VGF.VLR,0)) AS VLRREAL,MAX(CASE WHEN (MET.DTREF BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN) THEN 'SAFRA1' END) AS SAFRA1,MAX(CASE WHEN (MET.DTREF BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN) THEN TO_CHAR(MET.DTREF,'MM') END) AS MES1FROM TGFMET METLEFT JOIN VGF_VENDAS_SATIS VGF ON MET.DTREF = TRUNC(VGF.DTMOV,'MM') AND MET.CODVEND = VGF.CODVEND AND MET.CODPARC = VGF.CODPARC AND MET.MARCA = VGF.MARCA AND VGF.BONIFICACAO = 'N'LEFT JOIN AD_PRECOMARCA PRC ON (MET.MARCA = PRC.MARCA AND PRC.CODMETA = MET.CODMETA AND PRC.DTREF = (SELECT MAX(DTREF) FROM AD_PRECOMARCA WHERE CODMETA = MET.CODMETA AND DTREF <= MET.DTREF AND MARCA = MET.MARCA))WHERE MET.CODMETA = :P_CODMETAAND MET.DTREF BETWEEN :P_PERIODO.INI AND :P_PERIODO.FINAND ((:P_NTEMMETA = 'S' AND (MET.QTDPREV <> 0 OR MET.QTDREAL <> 0)) OR :P_NTEMMETA = 'N')AND (VGF.CODGRUPOPROD = :P_GRUPOPROD OR :P_GRUPOPROD IS NULL)GROUP BY MET.DTREF,NVL(MET.CODVEND,0),NVL(MET.CODPARC,0),NVL(MET.MARCA,0),NVL(VGF.CODCENCUS,0), NVL(MET.QTDPREV,0),NVL(PRC.VLRVENDALT,0)) AINNER JOIN TGFVEN VEN ON A.CODVEND = VEN.CODVENDINNER JOIN TGFPAR PAR ON A.CODPARC = PAR.CODPARCWHERE(VEN.CODGER IN :P_CODGER)AND (PAR.CODPARC = :P_CODPARC OR :P_CODPARC IS NULL)AND (A.MARCA IN (SELECT MARCA FROM TGFPRO WHERE CODPROD IN :P_MARCA))AND (A.CODCENCUS = :P_CR OR :P_CR IS NULL)AND(VEN.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA VENDEDOROR VEN.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA GERENTEOR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' ---CONSULTA MASTER)GROUP BY A.CODVEND, APELIDO, (CASE WHEN SAFRA1 = 'SAFRA1'THEN MES1 ELSE '0' END)UNION ALLSELECT A.CODVEND,APELIDO,'0' AS MES1,0 AS QTDPREV1,0 AS QTDREAL1,0 AS VLRPREV1,0 AS VLRREAL1,(CASE WHEN SAFRA2 = 'SAFRA2'THEN MES2 ELSE '0' END) MES2,SUM(CASE WHEN SAFRA2 = 'SAFRA2'THEN QTDPREV ELSE 0 END) AS QTDPREV2,SUM(CASE WHEN SAFRA2 = 'SAFRA2'THEN QTDREAL ELSE 0 END) AS QTDREAL2,SUM(CASE WHEN SAFRA2 = 'SAFRA2'THEN (QTDPREV * PRECOLT) ELSE 0 END) AS VLRPREV2,SUM(CASE WHEN SAFRA2 = 'SAFRA2'THEN VLRREAL ELSE 0 END) AS VLRREAL2FROM(SELECT MET.DTREF, NVL(MET.CODVEND,0) AS CODVEND, NVL(MET.CODPARC,0) AS CODPARC, NVL(MET.MARCA,0) AS MARCA,NVL(VGF.CODCENCUS,0) AS CODCENCUS, NVL(MET.QTDPREV,0) AS QTDPREV, SUM(NVL(VGF.QTD,0)) AS QTDREAL,NVL(PRC.VLRVENDALT,0)AS PRECOLT, SUM(NVL(VGF.VLR,0)) AS VLRREAL,MAX(CASE WHEN (MET.DTREF BETWEEN :P_PERIODO1.INI AND :P_PERIODO1.FIN) THEN 'SAFRA2' END) AS SAFRA2,MAX(CASE WHEN (MET.DTREF BETWEEN :P_PERIODO1.INI AND :P_PERIODO1.FIN) THEN TO_CHAR(MET.DTREF,'MM') END) AS MES2FROM TGFMET METLEFT JOIN VGF_VENDAS_SATIS VGF ON MET.DTREF = TRUNC(VGF.DTMOV,'MM') AND MET.CODVEND = VGF.CODVEND AND MET.CODPARC = VGF.CODPARC AND MET.MARCA = VGF.MARCA AND VGF.BONIFICACAO = 'N'LEFT JOIN AD_PRECOMARCA PRC ON (MET.MARCA = PRC.MARCA AND PRC.CODMETA = MET.CODMETA AND PRC.DTREF = (SELECT MAX(DTREF) FROM AD_PRECOMARCA WHERE CODMETA = MET.CODMETA AND DTREF <= MET.DTREF AND MARCA = MET.MARCA))WHERE MET.CODMETA = :P_CODMETAAND (  (:P_PERIODO1.INI IS NULL AND :P_PERIODO1.FIN IS NULL) OR (MET.DTREF BETWEEN :P_PERIODO1.INI AND :P_PERIODO1.FIN))AND ((:P_NTEMMETA = 'S' AND (MET.QTDPREV <> 0 OR MET.QTDREAL <> 0)) OR :P_NTEMMETA = 'N')AND (VGF.CODGRUPOPROD = :P_GRUPOPROD OR :P_GRUPOPROD IS NULL)GROUP BY MET.DTREF,NVL(MET.CODVEND,0),NVL(MET.CODPARC,0),NVL(MET.MARCA,0),NVL(VGF.CODCENCUS,0), NVL(MET.QTDPREV,0),NVL(PRC.VLRVENDALT,0))AINNER JOIN TGFVEN VEN ON A.CODVEND = VEN.CODVENDINNER JOIN TGFPAR PAR ON A.CODPARC = PAR.CODPARCWHERE(VEN.CODGER IN :P_CODGER)AND (PAR.CODPARC = :P_CODPARC OR :P_CODPARC IS NULL)AND (A.MARCA IN (SELECT MARCA FROM TGFPRO WHERE CODPROD IN :P_MARCA))AND (A.CODCENCUS = :P_CR OR :P_CR IS NULL)AND(VEN.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA VENDEDOROR VEN.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA GERENTEOR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' ---CONSULTA MASTER)GROUP BY A.CODVEND, APELIDO,(CASE WHEN SAFRA2 = 'SAFRA2'THEN MES2 ELSE '0' END))GROUP BYCODVEND,APELIDO,MES1,MES2)GROUP BYMESORDER BY "ORDEM"]]></expression>
          <metadata>
            <field name="MES" label="MES" type="S" visible="true" useFooter="false"/>
            <field name="QTDPREV1" label="Qtd. Prev.1" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
            <field name="QTDREAL1" label="Qtd. Real1" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
            <field name="VLRPREV1" label="Vlr. Prev.1" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
            <field name="VLRREAL1" label="Vlr. Real1" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
            <field name="QTDPREV2" label="Qtd. Prev.2" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
            <field name="QTDREAL2" label="Qtd. Real2" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
            <field name="VLRPREV2" label="Vlr. Prev.2" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
            <field name="VLRREAL2" label="Vlr. Real2" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
            <field name="ORDEM" label="ORDEM" type="I" visible="true" useFooter="false" mask=""/>
            <field name="MES1" label="Mês" type="S" visible="true" useFooter="false"/>
          </metadata>
          <horizontal-axis>
            <category field="MES1" rotation="-90" dropLabel="false">
              <initView value="first"/>
            </category>
          </horizontal-axis>
          <vertical-axis>
            <linear resultRotation="-45" vResizing="true">
              <mask/>
            </linear>
          </vertical-axis>
          <series>
            <serie type="line" circle-intersection="true">
              <xField>MES1</xField>
              <yField>VLRPREV1</yField>
              <display><![CDATA[Atual Valor - Prev.1]]></display>
              <color>0xff</color>
            </serie>
            <serie type="line" circle-intersection="true">
              <xField>MES1</xField>
              <yField>VLRREAL1</yField>
              <display><![CDATA[Atual  Valor - Real1]]></display>
              <color>0x33ff00</color>
            </serie>
            <serie type="line" circle-intersection="true">
              <xField>MES1</xField>
              <yField>VLRPREV2</yField>
              <display><![CDATA[Anterior Valor - Prev.2]]></display>
              <color>0xff00ff</color>
            </serie>
            <serie type="line" circle-intersection="true">
              <xField>MES1</xField>
              <yField>VLRREAL2</yField>
              <display><![CDATA[Anterior Valor - Real2]]></display>
              <color>0xff0000</color>
            </serie>
          </series>
          <legend position="top" direction="v"/>
        </chart>
      </container>
    </container>
  </level>
  <level id="lvl_rq48q6" description="Nivel2_A">
    <args>
      <arg id="A_CODVEND" type="integer"/>
      <arg id="A_VENDEDOR" type="text"/>
    </args>
    <container orientacao="V" tamanhoRelativo="100">
      <container orientacao="V" tamanhoRelativo="50">
        <grid id="grd_rq48q8" useNewGrid="S">
          <title><![CDATA[<b>Consolidado por Marcas - :A_VENDEDOR - De: :P_PERIODO.INI  A: :P_PERIODO.FIN</b>]]></title>
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECT*FROM(SELECTCODVEND,VENDEDOR AS APELIDO, MARCA,SUM(JUL_QTDPREV) AS JUL_QTDPREV, SUM(JUL_QTDREAL) AS JUL_QTDREAL,  SUM(JUL_VLR_PREV) AS JUL_VLR_PREV, SUM(JUL_VLR_REAL) AS JUL_VLR_REAL, SUM(AGO_QTDPREV) AS AGO_QTDPREV, SUM(AGO_QTDREAL) AS AGO_QTDREAL, SUM(AGO_VLR_PREV) AS AGO_VLR_PREV, SUM(AGO_VLR_REAL) AS AGO_VLR_REAL, SUM(SET_QTDPREV) AS SET_QTDPREV, SUM(SET_QTDREAL) AS SET_QTDREAL, SUM(SET_VLR_PREV) AS SET_VLR_PREV, SUM(SET_VLR_REAL) AS SET_VLR_REAL, SUM(OUT_QTDPREV) AS OUT_QTDPREV, SUM(OUT_QTDREAL) AS OUT_QTDREAL, SUM(OUT_VLR_PREV) AS OUT_VLR_PREV, SUM(OUT_VLR_REAL) AS OUT_VLR_REAL, SUM(NOV_QTDPREV) AS NOV_QTDPREV, SUM(NOV_QTDREAL) AS NOV_QTDREAL, SUM(NOV_VLR_PREV) AS NOV_VLR_PREV, SUM(NOV_VLR_REAL) AS NOV_VLR_REAL, SUM(DEZ_QTDPREV) AS DEZ_QTDPREV, SUM(DEZ_QTDREAL) AS DEZ_QTDREAL, SUM(DEZ_VLR_PREV) AS DEZ_VLR_PREV, SUM(DEZ_VLR_REAL) AS DEZ_VLR_REAL, SUM(JAN_QTDPREV) AS JAN_QTDPREV, SUM(JAN_QTDREAL) AS JAN_QTDREAL, SUM(JAN_VLR_PREV) AS JAN_VLR_PREV, SUM(JAN_VLR_REAL) AS JAN_VLR_REAL, SUM(FEV_QTDPREV) AS FEV_QTDPREV, SUM(FEV_QTDREAL) AS FEV_QTDREAL, SUM(FEV_VLR_PREV) AS FEV_VLR_PREV, SUM(FEV_VLR_REAL) AS FEV_VLR_REAL, SUM(MAR_QTDPREV) AS MAR_QTDPREV, SUM(MAR_QTDREAL) AS MAR_QTDREAL, SUM(MAR_VLR_PREV) AS MAR_VLR_PREV, SUM(MAR_VLR_REAL) AS MAR_VLR_REAL, SUM(ABR_QTDPREV) AS ABR_QTDPREV, SUM(ABR_QTDREAL) AS ABR_QTDREAL, SUM(ABR_VLR_PREV) AS ABR_VLR_PREV, SUM(ABR_VLR_REAL) AS ABR_VLR_REAL, SUM(MAI_QTDPREV) AS MAI_QTDPREV, SUM(MAI_QTDREAL) AS MAI_QTDREAL, SUM(MAI_VLR_PREV) AS MAI_VLR_PREV, SUM(MAI_VLR_REAL) AS MAI_VLR_REAL, SUM(JUN_QTDPREV) AS JUN_QTDPREV, SUM(JUN_QTDREAL) AS JUN_QTDREAL, SUM(JUN_VLR_PREV) AS JUN_VLR_PREV, SUM(JUN_VLR_REAL) AS JUN_VLR_REAL, SUM(TTL_QTDPREV) AS TTL_QTDPREV, SUM(TTL_QTDREAL) AS TTL_QTDREAL, SUM(TTL_VLR_PREV) AS TTL_VLR_PREV, SUM(TTL_VLR_REAL) AS TTL_VLR_REAL FROM(WITH VEND AS (SELECT VEN.CODVEND, VEN.APELIDO AS VENDEDOR, VEN.CODGER,VEN1.APELIDO AS COORD FROM TGFVEN VEN INNER JOIN TGFVEN VEN1 ON VEN.CODGER = VEN1.CODVEND)SELECT  (CASE     WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEND.CODGER    ELSE X.CODVEND END) AS CODVEND,  (CASE    WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEND.COORD    ELSE VEND.VENDEDOR END) AS VENDEDOR,MARCA,JUL_QTDPREV, JUL_QTDREAL, JUL_VLR_PREV, JUL_VLR_REAL, AGO_QTDPREV, AGO_QTDREAL, AGO_VLR_PREV, AGO_VLR_REAL, SET_QTDPREV, SET_QTDREAL, SET_VLR_PREV, SET_VLR_REAL, OUT_QTDPREV, OUT_QTDREAL, OUT_VLR_PREV, OUT_VLR_REAL, NOV_QTDPREV, NOV_QTDREAL, NOV_VLR_PREV, NOV_VLR_REAL, DEZ_QTDPREV, DEZ_QTDREAL, DEZ_VLR_PREV, DEZ_VLR_REAL, JAN_QTDPREV, JAN_QTDREAL, JAN_VLR_PREV, JAN_VLR_REAL, FEV_QTDPREV, FEV_QTDREAL, FEV_VLR_PREV, FEV_VLR_REAL, MAR_QTDPREV, MAR_QTDREAL, MAR_VLR_PREV, MAR_VLR_REAL, ABR_QTDPREV, ABR_QTDREAL, ABR_VLR_PREV, ABR_VLR_REAL, MAI_QTDPREV, MAI_QTDREAL, MAI_VLR_PREV, MAI_VLR_REAL, JUN_QTDPREV, JUN_QTDREAL, JUN_VLR_PREV, JUN_VLR_REAL,TTL_QTDPREV,TTL_QTDREAL,TTL_VLR_PREV,TTL_VLR_REALFROM(SELECTT.*,(JUL_QTDPREV + AGO_QTDPREV + SET_QTDPREV + OUT_QTDPREV+NOV_QTDPREV+DEZ_QTDPREV+JAN_QTDPREV+FEV_QTDPREV+MAR_QTDPREV+ABR_QTDPREV+MAI_QTDPREV+JUN_QTDPREV) AS TTL_QTDPREV,(JUL_QTDREAL + AGO_QTDREAL + SET_QTDREAL + OUT_QTDREAL+NOV_QTDREAL+DEZ_QTDREAL+JAN_QTDREAL+FEV_QTDREAL+MAR_QTDREAL+ABR_QTDREAL+MAI_QTDREAL+JUN_QTDREAL) AS TTL_QTDREAL,(JUL_VLR_PREV + AGO_VLR_PREV + SET_VLR_PREV + OUT_VLR_PREV+NOV_VLR_PREV+DEZ_VLR_PREV+JAN_VLR_PREV+FEV_VLR_PREV+MAR_VLR_PREV+ABR_VLR_PREV+MAI_VLR_PREV+JUN_VLR_PREV) AS TTL_VLR_PREV,(JUL_VLR_REAL + AGO_VLR_REAL + SET_VLR_REAL + OUT_VLR_REAL+NOV_VLR_REAL+DEZ_VLR_REAL+JAN_VLR_REAL+FEV_VLR_REAL+MAR_VLR_REAL+ABR_VLR_REAL+MAI_VLR_REAL+JUN_VLR_REAL) AS TTL_VLR_REALFROM (SELECT A.CODVEND,APELIDO,A.MARCA,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUL_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUL_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUL_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUL_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS AGO_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS AGO_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS AGO_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS AGO_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS SET_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS SET_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS SET_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS SET_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS OUT_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS OUT_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS OUT_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS OUT_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS NOV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS NOV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS NOV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS NOV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS DEZ_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS DEZ_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS DEZ_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS DEZ_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JAN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JAN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JAN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JAN_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS FEV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS FEV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS FEV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS FEV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS ABR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS ABR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS ABR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS ABR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAI_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAI_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAI_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAI_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUN_VLR_REALFROM(SELECT MET.DTREF, NVL(MET.CODVEND,0) AS CODVEND, NVL(MET.CODPARC,0) AS CODPARC, NVL(MET.MARCA,0) AS MARCA,NVL(VGF.CODCENCUS,0) AS CODCENCUS, NVL(MET.QTDPREV,0) AS QTDPREV, SUM(NVL(VGF.QTD,0)) AS QTDREAL,NVL(PRC.VLRVENDALT,0)AS PRECOLT, SUM(NVL(VGF.VLR,0)) AS VLRREALFROM TGFMET METLEFT JOIN VGF_VENDAS_SATIS VGF ON MET.DTREF = TRUNC(VGF.DTMOV,'MM') AND MET.CODVEND = VGF.CODVEND AND MET.CODPARC = VGF.CODPARC AND MET.MARCA = VGF.MARCA AND VGF.BONIFICACAO = 'N'LEFT JOIN AD_PRECOMARCA PRC ON (MET.MARCA = PRC.MARCA AND PRC.CODMETA = MET.CODMETA AND PRC.DTREF = (SELECT MAX(DTREF) FROM AD_PRECOMARCA WHERE CODMETA = MET.CODMETA AND DTREF <= MET.DTREF AND MARCA = MET.MARCA))WHERE MET.CODMETA = :P_CODMETAAND MET.DTREF BETWEEN :P_PERIODO.INI   AND  :P_PERIODO.FINAND (VGF.CODGRUPOPROD = :P_GRUPOPROD OR :P_GRUPOPROD IS NULL)GROUP BY MET.DTREF,NVL(MET.CODVEND,0),NVL(MET.CODPARC,0),NVL(MET.MARCA,0),NVL(VGF.CODCENCUS,0), NVL(MET.QTDPREV,0), NVL(PRC.VLRVENDALT,0))AINNER JOIN TGFPAR PAR ON A.CODPARC = PAR.CODPARCINNER JOIN TGFVEN VEN ON A.CODVEND = VEN.CODVENDWHERE(VEN.CODVEND = :A_CODVEND OR VEN.CODGER = :A_CODVEND)AND (VEN.CODGER IN :P_CODGER)AND (PAR.CODPARC = :P_CODPARC OR :P_CODPARC IS NULL)AND (A.MARCA IN (SELECT MARCA FROM TGFPRO WHERE CODPROD IN :P_MARCA))AND (A.CODCENCUS = :P_CR OR :P_CR IS NULL)AND(VEN.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA VENDEDOROR VEN.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA GERENTEOR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' ---CONSULTA MASTER)GROUP BY A.CODVEND, APELIDO,A.MARCA)T)XINNER JOIN VEND ON X.CODVEND = VEND.CODVEND)GROUP BY CODVEND,VENDEDOR,MARCA)WHERE ((:P_NTEMMETA = 'S' AND (TTL_QTDPREV <> 0 OR TTL_QTDREAL <> 0 OR TTL_VLR_PREV <> 0 OR TTL_VLR_REAL<> 0)) OR :P_NTEMMETA = 'N')ORDER BY 2]]></expression>
          <metadata>
            <field name="CODVEND" label="Cód.Vend." type="I" visible="false" useFooter="false"/>
            <field name="APELIDO" label="Vendedor" type="S" visible="false" useFooter="false"/>
            <field name="MARCA" label="Marca" type="S" visible="true" useFooter="false"/>
            <field name="JUL_QTDPREV" label="Jul. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUL_QTDREAL" label="Jul. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUL_VLR_PREV" label="Jul. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUL_VLR_REAL" label="Jul. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="AGO_QTDPREV" label="Ago. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="AGO_QTDREAL" label="Ago. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="AGO_VLR_PREV" label="Ago. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="AGO_VLR_REAL" label="Ago. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="SET_QTDPREV" label="Set. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="SET_QTDREAL" label="Set. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="SET_VLR_PREV" label="Set. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="SET_VLR_REAL" label="Set. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="OUT_QTDPREV" label="Out. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="OUT_QTDREAL" label="Out. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="OUT_VLR_PREV" label="Out. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="OUT_VLR_REAL" label="Out. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="NOV_QTDPREV" label="Nov. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="NOV_QTDREAL" label="Nov. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="NOV_VLR_PREV" label="Nov. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="NOV_VLR_REAL" label="Nov. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="DEZ_QTDPREV" label="Dez. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="DEZ_QTDREAL" label="Dez. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="DEZ_VLR_PREV" label="Dez. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="DEZ_VLR_REAL" label="Dez. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JAN_QTDPREV" label="Jan. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JAN_QTDREAL" label="Jan. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JAN_VLR_PREV" label="Jan. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JAN_VLR_REAL" label="Jan. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="FEV_QTDPREV" label="Fev. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="FEV_QTDREAL" label="Fev. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="FEV_VLR_PREV" label="Fev. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="FEV_VLR_REAL" label="Fev. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="MAR_QTDPREV" label="Mar. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAR_QTDREAL" label="Mar. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAR_VLR_PREV" label="Mar. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAR_VLR_REAL" label="Mar. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="ABR_QTDPREV" label="Abr. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="ABR_QTDREAL" label="Abr. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="ABR_VLR_PREV" label="Abr. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="ABR_VLR_REAL" label="Abr. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="MAI_QTDPREV" label="Mai. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAI_QTDREAL" label="Mai. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAI_VLR_PREV" label="Mai. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAI_VLR_REAL" label="Mai. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUN_QTDPREV" label="Jun. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JUN_QTDREAL" label="Jun. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JUN_VLR_PREV" label="Jun. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JUN_VLR_REAL" label="Jun. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="TTL_QTDPREV" label="Ttl. Qtd. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
            <field name="TTL_QTDREAL" label="Ttl. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
            <field name="TTL_VLR_PREV" label="Ttl. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
            <field name="TTL_VLR_REAL" label="Ttl. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
          </metadata>
        </grid>
      </container>
      <container orientacao="V" tamanhoRelativo="50">
        <grid id="grd_suyps6" useNewGrid="S">
          <title><![CDATA[<b>Consolidado por Marcas - :A_VENDEDOR - De: :P_PERIODO1.INI  A: :P_PERIODO1.FIN</b>]]></title>
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECT*FROM(SELECTCODVEND,VENDEDOR AS APELIDO, MARCA,SUM(JUL_QTDPREV) AS JUL_QTDPREV, SUM(JUL_QTDREAL) AS JUL_QTDREAL,  SUM(JUL_VLR_PREV) AS JUL_VLR_PREV, SUM(JUL_VLR_REAL) AS JUL_VLR_REAL, SUM(AGO_QTDPREV) AS AGO_QTDPREV, SUM(AGO_QTDREAL) AS AGO_QTDREAL, SUM(AGO_VLR_PREV) AS AGO_VLR_PREV, SUM(AGO_VLR_REAL) AS AGO_VLR_REAL, SUM(SET_QTDPREV) AS SET_QTDPREV, SUM(SET_QTDREAL) AS SET_QTDREAL, SUM(SET_VLR_PREV) AS SET_VLR_PREV, SUM(SET_VLR_REAL) AS SET_VLR_REAL, SUM(OUT_QTDPREV) AS OUT_QTDPREV, SUM(OUT_QTDREAL) AS OUT_QTDREAL, SUM(OUT_VLR_PREV) AS OUT_VLR_PREV, SUM(OUT_VLR_REAL) AS OUT_VLR_REAL, SUM(NOV_QTDPREV) AS NOV_QTDPREV, SUM(NOV_QTDREAL) AS NOV_QTDREAL, SUM(NOV_VLR_PREV) AS NOV_VLR_PREV, SUM(NOV_VLR_REAL) AS NOV_VLR_REAL, SUM(DEZ_QTDPREV) AS DEZ_QTDPREV, SUM(DEZ_QTDREAL) AS DEZ_QTDREAL, SUM(DEZ_VLR_PREV) AS DEZ_VLR_PREV, SUM(DEZ_VLR_REAL) AS DEZ_VLR_REAL, SUM(JAN_QTDPREV) AS JAN_QTDPREV, SUM(JAN_QTDREAL) AS JAN_QTDREAL, SUM(JAN_VLR_PREV) AS JAN_VLR_PREV, SUM(JAN_VLR_REAL) AS JAN_VLR_REAL, SUM(FEV_QTDPREV) AS FEV_QTDPREV, SUM(FEV_QTDREAL) AS FEV_QTDREAL, SUM(FEV_VLR_PREV) AS FEV_VLR_PREV, SUM(FEV_VLR_REAL) AS FEV_VLR_REAL, SUM(MAR_QTDPREV) AS MAR_QTDPREV, SUM(MAR_QTDREAL) AS MAR_QTDREAL, SUM(MAR_VLR_PREV) AS MAR_VLR_PREV, SUM(MAR_VLR_REAL) AS MAR_VLR_REAL, SUM(ABR_QTDPREV) AS ABR_QTDPREV, SUM(ABR_QTDREAL) AS ABR_QTDREAL, SUM(ABR_VLR_PREV) AS ABR_VLR_PREV, SUM(ABR_VLR_REAL) AS ABR_VLR_REAL, SUM(MAI_QTDPREV) AS MAI_QTDPREV, SUM(MAI_QTDREAL) AS MAI_QTDREAL, SUM(MAI_VLR_PREV) AS MAI_VLR_PREV, SUM(MAI_VLR_REAL) AS MAI_VLR_REAL, SUM(JUN_QTDPREV) AS JUN_QTDPREV, SUM(JUN_QTDREAL) AS JUN_QTDREAL, SUM(JUN_VLR_PREV) AS JUN_VLR_PREV, SUM(JUN_VLR_REAL) AS JUN_VLR_REAL, SUM(TTL_QTDPREV) AS TTL_QTDPREV, SUM(TTL_QTDREAL) AS TTL_QTDREAL, SUM(TTL_VLR_PREV) AS TTL_VLR_PREV, SUM(TTL_VLR_REAL) AS TTL_VLR_REAL FROM(WITH VEND AS (SELECT VEN.CODVEND, VEN.APELIDO AS VENDEDOR, VEN.CODGER,VEN1.APELIDO AS COORD FROM TGFVEN VEN INNER JOIN TGFVEN VEN1 ON VEN.CODGER = VEN1.CODVEND)SELECT  (CASE     WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEND.CODGER    ELSE X.CODVEND END) AS CODVEND,  (CASE    WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEND.COORD    ELSE VEND.VENDEDOR END) AS VENDEDOR,MARCA,JUL_QTDPREV, JUL_QTDREAL, JUL_VLR_PREV, JUL_VLR_REAL, AGO_QTDPREV, AGO_QTDREAL, AGO_VLR_PREV, AGO_VLR_REAL, SET_QTDPREV, SET_QTDREAL, SET_VLR_PREV, SET_VLR_REAL, OUT_QTDPREV, OUT_QTDREAL, OUT_VLR_PREV, OUT_VLR_REAL, NOV_QTDPREV, NOV_QTDREAL, NOV_VLR_PREV, NOV_VLR_REAL, DEZ_QTDPREV, DEZ_QTDREAL, DEZ_VLR_PREV, DEZ_VLR_REAL, JAN_QTDPREV, JAN_QTDREAL, JAN_VLR_PREV, JAN_VLR_REAL, FEV_QTDPREV, FEV_QTDREAL, FEV_VLR_PREV, FEV_VLR_REAL, MAR_QTDPREV, MAR_QTDREAL, MAR_VLR_PREV, MAR_VLR_REAL, ABR_QTDPREV, ABR_QTDREAL, ABR_VLR_PREV, ABR_VLR_REAL, MAI_QTDPREV, MAI_QTDREAL, MAI_VLR_PREV, MAI_VLR_REAL, JUN_QTDPREV, JUN_QTDREAL, JUN_VLR_PREV, JUN_VLR_REAL,TTL_QTDPREV,TTL_QTDREAL,TTL_VLR_PREV,TTL_VLR_REALFROM(SELECTT.*,(JUL_QTDPREV + AGO_QTDPREV + SET_QTDPREV + OUT_QTDPREV+NOV_QTDPREV+DEZ_QTDPREV+JAN_QTDPREV+FEV_QTDPREV+MAR_QTDPREV+ABR_QTDPREV+MAI_QTDPREV+JUN_QTDPREV) AS TTL_QTDPREV,(JUL_QTDREAL + AGO_QTDREAL + SET_QTDREAL + OUT_QTDREAL+NOV_QTDREAL+DEZ_QTDREAL+JAN_QTDREAL+FEV_QTDREAL+MAR_QTDREAL+ABR_QTDREAL+MAI_QTDREAL+JUN_QTDREAL) AS TTL_QTDREAL,(JUL_VLR_PREV + AGO_VLR_PREV + SET_VLR_PREV + OUT_VLR_PREV+NOV_VLR_PREV+DEZ_VLR_PREV+JAN_VLR_PREV+FEV_VLR_PREV+MAR_VLR_PREV+ABR_VLR_PREV+MAI_VLR_PREV+JUN_VLR_PREV) AS TTL_VLR_PREV,(JUL_VLR_REAL + AGO_VLR_REAL + SET_VLR_REAL + OUT_VLR_REAL+NOV_VLR_REAL+DEZ_VLR_REAL+JAN_VLR_REAL+FEV_VLR_REAL+MAR_VLR_REAL+ABR_VLR_REAL+MAI_VLR_REAL+JUN_VLR_REAL) AS TTL_VLR_REALFROM (SELECT A.CODVEND,APELIDO,A.MARCA,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUL_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUL_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUL_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUL_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS AGO_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS AGO_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS AGO_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS AGO_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS SET_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS SET_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS SET_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS SET_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS OUT_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS OUT_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS OUT_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS OUT_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS NOV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS NOV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS NOV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS NOV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS DEZ_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS DEZ_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS DEZ_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS DEZ_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JAN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JAN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JAN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JAN_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS FEV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS FEV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS FEV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS FEV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS ABR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS ABR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS ABR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS ABR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAI_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAI_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAI_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAI_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUN_VLR_REALFROM(SELECT MET.DTREF, NVL(MET.CODVEND,0) AS CODVEND, NVL(MET.CODPARC,0) AS CODPARC, NVL(MET.MARCA,0) AS MARCA,NVL(VGF.CODCENCUS,0) AS CODCENCUS, NVL(MET.QTDPREV,0) AS QTDPREV, SUM(NVL(VGF.QTD,0)) AS QTDREAL,NVL(PRC.VLRVENDALT,0)AS PRECOLT, SUM(NVL(VGF.VLR,0)) AS VLRREALFROM TGFMET METLEFT JOIN VGF_VENDAS_SATIS VGF ON MET.DTREF = TRUNC(VGF.DTMOV,'MM') AND MET.CODVEND = VGF.CODVEND AND MET.CODPARC = VGF.CODPARC AND MET.MARCA = VGF.MARCA AND VGF.BONIFICACAO = 'N'LEFT JOIN AD_PRECOMARCA PRC ON (MET.MARCA = PRC.MARCA AND PRC.CODMETA = MET.CODMETA AND PRC.DTREF = (SELECT MAX(DTREF) FROM AD_PRECOMARCA WHERE CODMETA = MET.CODMETA AND DTREF <= MET.DTREF AND MARCA = MET.MARCA))WHERE MET.CODMETA = :P_CODMETAAND MET.DTREF BETWEEN :P_PERIODO1.INI   AND  :P_PERIODO1.FINAND ((:P_NTEMMETA = 'S' AND (MET.QTDPREV <> 0 OR MET.QTDREAL <> 0)) OR :P_NTEMMETA = 'N')AND (VGF.CODGRUPOPROD = :P_GRUPOPROD OR :P_GRUPOPROD IS NULL)GROUP BY MET.DTREF,NVL(MET.CODVEND,0),NVL(MET.CODPARC,0),NVL(MET.MARCA,0),NVL(VGF.CODCENCUS,0), NVL(MET.QTDPREV,0), NVL(PRC.VLRVENDALT,0))AINNER JOIN TGFPAR PAR ON A.CODPARC = PAR.CODPARCINNER JOIN TGFVEN VEN ON A.CODVEND = VEN.CODVENDWHERE(VEN.CODVEND = :A_CODVEND OR VEN.CODGER = :A_CODVEND)AND (VEN.CODGER IN :P_CODGER)AND (PAR.CODPARC = :P_CODPARC OR :P_CODPARC IS NULL)AND (A.MARCA IN (SELECT MARCA FROM TGFPRO WHERE CODPROD IN :P_MARCA))AND (A.CODCENCUS = :P_CR OR :P_CR IS NULL)AND(VEN.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA VENDEDOROR VEN.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA GERENTEOR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' ---CONSULTA MASTER)GROUP BY A.CODVEND, APELIDO,A.MARCA)T)XINNER JOIN VEND ON X.CODVEND = VEND.CODVEND)GROUP BY CODVEND,VENDEDOR,MARCA)WHERE ((:P_NTEMMETA = 'S' AND (TTL_QTDPREV <> 0 OR TTL_QTDREAL <> 0 OR TTL_VLR_PREV <> 0 OR TTL_VLR_REAL<> 0)) OR :P_NTEMMETA = 'N')ORDER BY 2]]></expression>
          <metadata>
            <field name="CODVEND" label="Cód.Vend." type="I" visible="false" useFooter="false"/>
            <field name="APELIDO" label="Vendedor" type="S" visible="false" useFooter="false"/>
            <field name="MARCA" label="Marca" type="S" visible="true" useFooter="false"/>
            <field name="JUL_QTDPREV" label="Jul. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUL_QTDREAL" label="Jul. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUL_VLR_PREV" label="Jul. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUL_VLR_REAL" label="Jul. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="AGO_QTDPREV" label="Ago. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="AGO_QTDREAL" label="Ago. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="AGO_VLR_PREV" label="Ago. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="AGO_VLR_REAL" label="Ago. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="SET_QTDPREV" label="Set. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="SET_QTDREAL" label="Set. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="SET_VLR_PREV" label="Set. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="SET_VLR_REAL" label="Set. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="OUT_QTDPREV" label="Out. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="OUT_QTDREAL" label="Out. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="OUT_VLR_PREV" label="Out. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="OUT_VLR_REAL" label="Out. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="NOV_QTDPREV" label="Nov. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="NOV_QTDREAL" label="Nov. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="NOV_VLR_PREV" label="Nov. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="NOV_VLR_REAL" label="Nov. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="DEZ_QTDPREV" label="Dez. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="DEZ_QTDREAL" label="Dez. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="DEZ_VLR_PREV" label="Dez. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="DEZ_VLR_REAL" label="Dez. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JAN_QTDPREV" label="Jan. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JAN_QTDREAL" label="Jan. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JAN_VLR_PREV" label="Jan. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JAN_VLR_REAL" label="Jan. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="FEV_QTDPREV" label="Fev. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="FEV_QTDREAL" label="Fev. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="FEV_VLR_PREV" label="Fev. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="FEV_VLR_REAL" label="Fev. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="MAR_QTDPREV" label="Mar. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAR_QTDREAL" label="Mar. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAR_VLR_PREV" label="Mar. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAR_VLR_REAL" label="Mar. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="ABR_QTDPREV" label="Abr. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="ABR_QTDREAL" label="Abr. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="ABR_VLR_PREV" label="Abr. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="ABR_VLR_REAL" label="Abr. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="MAI_QTDPREV" label="Mai. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAI_QTDREAL" label="Mai. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAI_VLR_PREV" label="Mai. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAI_VLR_REAL" label="Mai. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUN_QTDPREV" label="Jun. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JUN_QTDREAL" label="Jun. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JUN_VLR_PREV" label="Jun. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JUN_VLR_REAL" label="Jun. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="TTL_QTDPREV" label="Ttl. Qtd. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
            <field name="TTL_QTDREAL" label="Ttl. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
            <field name="TTL_VLR_PREV" label="Ttl. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
            <field name="TTL_VLR_REAL" label="Ttl. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
          </metadata>
        </grid>
      </container>
    </container>
  </level>
  <level id="lvl_ayrmn01" description="Nivel3">
    <container orientacao="V" tamanhoRelativo="100">
      <grid id="grd_ayxu9q2" useNewGrid="S">
        <title><![CDATA[<b>Consolidado por Vendedor - De: :P_PERIODO.INI  A: :P_PERIODO.FIN</b>]]></title>
        <expression type="sql" data-source="MGEDS"><![CDATA[SELECT*FROM(SELECTCODVEND,VENDEDOR, 'Periodo 1: de '||:P_PERIODO.INI||' até '||:P_PERIODO.FIN AS PERIODO,SUM(JUL_QTDPREV) AS JUL_QTDPREV, SUM(JUL_QTDREAL) AS JUL_QTDREAL,  SUM(JUL_VLR_PREV) AS JUL_VLR_PREV, SUM(JUL_VLR_REAL) AS JUL_VLR_REAL, SUM(AGO_QTDPREV) AS AGO_QTDPREV, SUM(AGO_QTDREAL) AS AGO_QTDREAL, SUM(AGO_VLR_PREV) AS AGO_VLR_PREV, SUM(AGO_VLR_REAL) AS AGO_VLR_REAL, SUM(SET_QTDPREV) AS SET_QTDPREV, SUM(SET_QTDREAL) AS SET_QTDREAL, SUM(SET_VLR_PREV) AS SET_VLR_PREV, SUM(SET_VLR_REAL) AS SET_VLR_REAL, SUM(OUT_QTDPREV) AS OUT_QTDPREV, SUM(OUT_QTDREAL) AS OUT_QTDREAL, SUM(OUT_VLR_PREV) AS OUT_VLR_PREV, SUM(OUT_VLR_REAL) AS OUT_VLR_REAL, SUM(NOV_QTDPREV) AS NOV_QTDPREV, SUM(NOV_QTDREAL) AS NOV_QTDREAL, SUM(NOV_VLR_PREV) AS NOV_VLR_PREV, SUM(NOV_VLR_REAL) AS NOV_VLR_REAL, SUM(DEZ_QTDPREV) AS DEZ_QTDPREV, SUM(DEZ_QTDREAL) AS DEZ_QTDREAL, SUM(DEZ_VLR_PREV) AS DEZ_VLR_PREV, SUM(DEZ_VLR_REAL) AS DEZ_VLR_REAL, SUM(JAN_QTDPREV) AS JAN_QTDPREV, SUM(JAN_QTDREAL) AS JAN_QTDREAL, SUM(JAN_VLR_PREV) AS JAN_VLR_PREV, SUM(JAN_VLR_REAL) AS JAN_VLR_REAL, SUM(FEV_QTDPREV) AS FEV_QTDPREV, SUM(FEV_QTDREAL) AS FEV_QTDREAL, SUM(FEV_VLR_PREV) AS FEV_VLR_PREV, SUM(FEV_VLR_REAL) AS FEV_VLR_REAL, SUM(MAR_QTDPREV) AS MAR_QTDPREV, SUM(MAR_QTDREAL) AS MAR_QTDREAL, SUM(MAR_VLR_PREV) AS MAR_VLR_PREV, SUM(MAR_VLR_REAL) AS MAR_VLR_REAL, SUM(ABR_QTDPREV) AS ABR_QTDPREV, SUM(ABR_QTDREAL) AS ABR_QTDREAL, SUM(ABR_VLR_PREV) AS ABR_VLR_PREV, SUM(ABR_VLR_REAL) AS ABR_VLR_REAL, SUM(MAI_QTDPREV) AS MAI_QTDPREV, SUM(MAI_QTDREAL) AS MAI_QTDREAL, SUM(MAI_VLR_PREV) AS MAI_VLR_PREV, SUM(MAI_VLR_REAL) AS MAI_VLR_REAL, SUM(JUN_QTDPREV) AS JUN_QTDPREV, SUM(JUN_QTDREAL) AS JUN_QTDREAL, SUM(JUN_VLR_PREV) AS JUN_VLR_PREV, SUM(JUN_VLR_REAL) AS JUN_VLR_REAL, SUM(TTL_QTDPREV) AS TTL_QTDPREV, SUM(TTL_QTDREAL) AS TTL_QTDREAL, SUM(TTL_VLR_PREV) AS TTL_VLR_PREV, SUM(TTL_VLR_REAL) AS TTL_VLR_REAL FROM(WITH VEND AS (SELECT VEN.CODVEND, VEN.APELIDO AS VENDEDOR, VEN.CODGER,VEN1.APELIDO AS COORD FROM TGFVEN VEN INNER JOIN TGFVEN VEN1 ON VEN.CODGER = VEN1.CODVEND)SELECT  (CASE     WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEND.CODGER    ELSE X.CODVEND END) AS CODVEND,  (CASE    WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEND.COORD    ELSE VEND.VENDEDOR END) AS VENDEDOR,JUL_QTDPREV, JUL_QTDREAL, JUL_VLR_PREV, JUL_VLR_REAL, AGO_QTDPREV, AGO_QTDREAL, AGO_VLR_PREV, AGO_VLR_REAL, SET_QTDPREV, SET_QTDREAL, SET_VLR_PREV, SET_VLR_REAL, OUT_QTDPREV, OUT_QTDREAL, OUT_VLR_PREV, OUT_VLR_REAL, NOV_QTDPREV, NOV_QTDREAL, NOV_VLR_PREV, NOV_VLR_REAL, DEZ_QTDPREV, DEZ_QTDREAL, DEZ_VLR_PREV, DEZ_VLR_REAL, JAN_QTDPREV, JAN_QTDREAL, JAN_VLR_PREV, JAN_VLR_REAL, FEV_QTDPREV, FEV_QTDREAL, FEV_VLR_PREV, FEV_VLR_REAL, MAR_QTDPREV, MAR_QTDREAL, MAR_VLR_PREV, MAR_VLR_REAL, ABR_QTDPREV, ABR_QTDREAL, ABR_VLR_PREV, ABR_VLR_REAL, MAI_QTDPREV, MAI_QTDREAL, MAI_VLR_PREV, MAI_VLR_REAL, JUN_QTDPREV, JUN_QTDREAL, JUN_VLR_PREV, JUN_VLR_REAL,TTL_QTDPREV,TTL_QTDREAL,TTL_VLR_PREV,TTL_VLR_REALFROM(SELECTT.*,(JUL_QTDPREV + AGO_QTDPREV + SET_QTDPREV + OUT_QTDPREV+NOV_QTDPREV+DEZ_QTDPREV+JAN_QTDPREV+FEV_QTDPREV+MAR_QTDPREV+ABR_QTDPREV+MAI_QTDPREV+JUN_QTDPREV) AS TTL_QTDPREV,(JUL_QTDREAL + AGO_QTDREAL + SET_QTDREAL + OUT_QTDREAL+NOV_QTDREAL+DEZ_QTDREAL+JAN_QTDREAL+FEV_QTDREAL+MAR_QTDREAL+ABR_QTDREAL+MAI_QTDREAL+JUN_QTDREAL) AS TTL_QTDREAL,(JUL_VLR_PREV + AGO_VLR_PREV + SET_VLR_PREV + OUT_VLR_PREV+NOV_VLR_PREV+DEZ_VLR_PREV+JAN_VLR_PREV+FEV_VLR_PREV+MAR_VLR_PREV+ABR_VLR_PREV+MAI_VLR_PREV+JUN_VLR_PREV) AS TTL_VLR_PREV,(JUL_VLR_REAL + AGO_VLR_REAL + SET_VLR_REAL + OUT_VLR_REAL+NOV_VLR_REAL+DEZ_VLR_REAL+JAN_VLR_REAL+FEV_VLR_REAL+MAR_VLR_REAL+ABR_VLR_REAL+MAI_VLR_REAL+JUN_VLR_REAL) AS TTL_VLR_REALFROM (SELECT A.CODVEND,APELIDO,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUL_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUL_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUL_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUL_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS AGO_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS AGO_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS AGO_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS AGO_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS SET_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS SET_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS SET_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS SET_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS OUT_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS OUT_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS OUT_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS OUT_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS NOV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS NOV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS NOV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS NOV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS DEZ_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS DEZ_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS DEZ_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS DEZ_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JAN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JAN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JAN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JAN_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS FEV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS FEV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS FEV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS FEV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS ABR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS ABR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS ABR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS ABR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAI_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAI_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAI_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAI_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUN_VLR_REALFROM(SELECT MET.DTREF, NVL(MET.CODVEND,0) AS CODVEND, NVL(MET.CODPARC,0) AS CODPARC, NVL(MET.MARCA,0) AS MARCA,NVL(VGF.CODCENCUS,0) AS CODCENCUS, NVL(MET.QTDPREV,0) AS QTDPREV, SUM(NVL(VGF.QTD,0)) AS QTDREAL,NVL(PRC.VLRVENDALT,0)AS PRECOLT, SUM(NVL(VGF.VLR,0)) AS VLRREALFROM TGFMET METLEFT JOIN VGF_VENDAS_SATIS VGF ON MET.DTREF = TRUNC(VGF.DTMOV,'MM') AND MET.CODVEND = VGF.CODVEND AND MET.CODPARC = VGF.CODPARC AND MET.MARCA = VGF.MARCA AND VGF.BONIFICACAO = 'N'LEFT JOIN AD_PRECOMARCA PRC ON (MET.MARCA = PRC.MARCA AND PRC.CODMETA = MET.CODMETA AND PRC.DTREF = (SELECT MAX(DTREF) FROM AD_PRECOMARCA WHERE CODMETA = MET.CODMETA AND DTREF <= MET.DTREF AND MARCA = MET.MARCA))WHERE MET.CODMETA = :P_CODMETAAND MET.DTREF BETWEEN :P_PERIODO.INI   AND  :P_PERIODO.FINAND (VGF.CODGRUPOPROD = :P_GRUPOPROD OR :P_GRUPOPROD IS NULL)GROUP BY MET.DTREF,NVL(MET.CODVEND,0),NVL(MET.CODPARC,0),NVL(MET.MARCA,0),NVL(VGF.CODCENCUS,0), NVL(MET.QTDPREV,0), NVL(PRC.VLRVENDALT,0))AINNER JOIN TGFPAR PAR ON A.CODPARC = PAR.CODPARCINNER JOIN TGFVEN VEN ON A.CODVEND = VEN.CODVENDWHERE(VEN.CODVEND IN :P_CODVEND)AND (VEN.CODGER IN :P_CODGER)AND (PAR.CODPARC = :P_CODPARC OR :P_CODPARC IS NULL)AND (A.MARCA IN (SELECT MARCA FROM TGFPRO WHERE CODPROD IN :P_MARCA))AND (A.CODCENCUS = :P_CR OR :P_CR IS NULL)AND(VEN.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA VENDEDOROR VEN.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA GERENTEOR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' ---CONSULTA MASTER)GROUP BY A.CODVEND, APELIDO)T)XINNER JOIN VEND ON X.CODVEND = VEND.CODVEND)GROUP BY CODVEND,VENDEDORUNION ALLSELECTCODVEND,VENDEDOR, 'Periodo 2: de '||:P_PERIODO1.INI||' até '||:P_PERIODO1.FIN AS PERIODO,SUM(JUL_QTDPREV) AS JUL_QTDPREV, SUM(JUL_QTDREAL) AS JUL_QTDREAL,  SUM(JUL_VLR_PREV) AS JUL_VLR_PREV, SUM(JUL_VLR_REAL) AS JUL_VLR_REAL, SUM(AGO_QTDPREV) AS AGO_QTDPREV, SUM(AGO_QTDREAL) AS AGO_QTDREAL, SUM(AGO_VLR_PREV) AS AGO_VLR_PREV, SUM(AGO_VLR_REAL) AS AGO_VLR_REAL, SUM(SET_QTDPREV) AS SET_QTDPREV, SUM(SET_QTDREAL) AS SET_QTDREAL, SUM(SET_VLR_PREV) AS SET_VLR_PREV, SUM(SET_VLR_REAL) AS SET_VLR_REAL, SUM(OUT_QTDPREV) AS OUT_QTDPREV, SUM(OUT_QTDREAL) AS OUT_QTDREAL, SUM(OUT_VLR_PREV) AS OUT_VLR_PREV, SUM(OUT_VLR_REAL) AS OUT_VLR_REAL, SUM(NOV_QTDPREV) AS NOV_QTDPREV, SUM(NOV_QTDREAL) AS NOV_QTDREAL, SUM(NOV_VLR_PREV) AS NOV_VLR_PREV, SUM(NOV_VLR_REAL) AS NOV_VLR_REAL, SUM(DEZ_QTDPREV) AS DEZ_QTDPREV, SUM(DEZ_QTDREAL) AS DEZ_QTDREAL, SUM(DEZ_VLR_PREV) AS DEZ_VLR_PREV, SUM(DEZ_VLR_REAL) AS DEZ_VLR_REAL, SUM(JAN_QTDPREV) AS JAN_QTDPREV, SUM(JAN_QTDREAL) AS JAN_QTDREAL, SUM(JAN_VLR_PREV) AS JAN_VLR_PREV, SUM(JAN_VLR_REAL) AS JAN_VLR_REAL, SUM(FEV_QTDPREV) AS FEV_QTDPREV, SUM(FEV_QTDREAL) AS FEV_QTDREAL, SUM(FEV_VLR_PREV) AS FEV_VLR_PREV, SUM(FEV_VLR_REAL) AS FEV_VLR_REAL, SUM(MAR_QTDPREV) AS MAR_QTDPREV, SUM(MAR_QTDREAL) AS MAR_QTDREAL, SUM(MAR_VLR_PREV) AS MAR_VLR_PREV, SUM(MAR_VLR_REAL) AS MAR_VLR_REAL, SUM(ABR_QTDPREV) AS ABR_QTDPREV, SUM(ABR_QTDREAL) AS ABR_QTDREAL, SUM(ABR_VLR_PREV) AS ABR_VLR_PREV, SUM(ABR_VLR_REAL) AS ABR_VLR_REAL, SUM(MAI_QTDPREV) AS MAI_QTDPREV, SUM(MAI_QTDREAL) AS MAI_QTDREAL, SUM(MAI_VLR_PREV) AS MAI_VLR_PREV, SUM(MAI_VLR_REAL) AS MAI_VLR_REAL, SUM(JUN_QTDPREV) AS JUN_QTDPREV, SUM(JUN_QTDREAL) AS JUN_QTDREAL, SUM(JUN_VLR_PREV) AS JUN_VLR_PREV, SUM(JUN_VLR_REAL) AS JUN_VLR_REAL, SUM(TTL_QTDPREV) AS TTL_QTDPREV, SUM(TTL_QTDREAL) AS TTL_QTDREAL, SUM(TTL_VLR_PREV) AS TTL_VLR_PREV, SUM(TTL_VLR_REAL) AS TTL_VLR_REAL FROM(WITH VEND AS (SELECT VEN.CODVEND, VEN.APELIDO AS VENDEDOR, VEN.CODGER,VEN1.APELIDO AS COORD FROM TGFVEN VEN INNER JOIN TGFVEN VEN1 ON VEN.CODGER = VEN1.CODVEND)SELECT  (CASE     WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEND.CODGER    ELSE X.CODVEND END) AS CODVEND,  (CASE    WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEND.COORD    ELSE VEND.VENDEDOR END) AS VENDEDOR,JUL_QTDPREV, JUL_QTDREAL, JUL_VLR_PREV, JUL_VLR_REAL, AGO_QTDPREV, AGO_QTDREAL, AGO_VLR_PREV, AGO_VLR_REAL, SET_QTDPREV, SET_QTDREAL, SET_VLR_PREV, SET_VLR_REAL, OUT_QTDPREV, OUT_QTDREAL, OUT_VLR_PREV, OUT_VLR_REAL, NOV_QTDPREV, NOV_QTDREAL, NOV_VLR_PREV, NOV_VLR_REAL, DEZ_QTDPREV, DEZ_QTDREAL, DEZ_VLR_PREV, DEZ_VLR_REAL, JAN_QTDPREV, JAN_QTDREAL, JAN_VLR_PREV, JAN_VLR_REAL, FEV_QTDPREV, FEV_QTDREAL, FEV_VLR_PREV, FEV_VLR_REAL, MAR_QTDPREV, MAR_QTDREAL, MAR_VLR_PREV, MAR_VLR_REAL, ABR_QTDPREV, ABR_QTDREAL, ABR_VLR_PREV, ABR_VLR_REAL, MAI_QTDPREV, MAI_QTDREAL, MAI_VLR_PREV, MAI_VLR_REAL, JUN_QTDPREV, JUN_QTDREAL, JUN_VLR_PREV, JUN_VLR_REAL,TTL_QTDPREV,TTL_QTDREAL,TTL_VLR_PREV,TTL_VLR_REALFROM(SELECTT.*,(JUL_QTDPREV + AGO_QTDPREV + SET_QTDPREV + OUT_QTDPREV+NOV_QTDPREV+DEZ_QTDPREV+JAN_QTDPREV+FEV_QTDPREV+MAR_QTDPREV+ABR_QTDPREV+MAI_QTDPREV+JUN_QTDPREV) AS TTL_QTDPREV,(JUL_QTDREAL + AGO_QTDREAL + SET_QTDREAL + OUT_QTDREAL+NOV_QTDREAL+DEZ_QTDREAL+JAN_QTDREAL+FEV_QTDREAL+MAR_QTDREAL+ABR_QTDREAL+MAI_QTDREAL+JUN_QTDREAL) AS TTL_QTDREAL,(JUL_VLR_PREV + AGO_VLR_PREV + SET_VLR_PREV + OUT_VLR_PREV+NOV_VLR_PREV+DEZ_VLR_PREV+JAN_VLR_PREV+FEV_VLR_PREV+MAR_VLR_PREV+ABR_VLR_PREV+MAI_VLR_PREV+JUN_VLR_PREV) AS TTL_VLR_PREV,(JUL_VLR_REAL + AGO_VLR_REAL + SET_VLR_REAL + OUT_VLR_REAL+NOV_VLR_REAL+DEZ_VLR_REAL+JAN_VLR_REAL+FEV_VLR_REAL+MAR_VLR_REAL+ABR_VLR_REAL+MAI_VLR_REAL+JUN_VLR_REAL) AS TTL_VLR_REALFROM (SELECT A.CODVEND,APELIDO,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUL_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUL_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUL_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUL_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS AGO_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS AGO_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS AGO_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS AGO_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS SET_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS SET_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS SET_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS SET_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS OUT_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS OUT_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS OUT_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS OUT_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS NOV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS NOV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS NOV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS NOV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS DEZ_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS DEZ_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS DEZ_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS DEZ_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JAN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JAN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JAN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JAN_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS FEV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS FEV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS FEV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS FEV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS ABR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS ABR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS ABR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS ABR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAI_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAI_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAI_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAI_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUN_VLR_REALFROM(SELECT MET.DTREF, NVL(MET.CODVEND,0) AS CODVEND, NVL(MET.CODPARC,0) AS CODPARC, NVL(MET.MARCA,0) AS MARCA,NVL(VGF.CODCENCUS,0) AS CODCENCUS, NVL(MET.QTDPREV,0) AS QTDPREV, SUM(NVL(VGF.QTD,0)) AS QTDREAL,NVL(PRC.VLRVENDALT,0)AS PRECOLT, SUM(NVL(VGF.VLR,0)) AS VLRREALFROM TGFMET METLEFT JOIN VGF_VENDAS_SATIS VGF ON MET.DTREF = TRUNC(VGF.DTMOV,'MM') AND MET.CODVEND = VGF.CODVEND AND MET.CODPARC = VGF.CODPARC AND MET.MARCA = VGF.MARCA AND VGF.BONIFICACAO = 'N'LEFT JOIN AD_PRECOMARCA PRC ON (MET.MARCA = PRC.MARCA AND PRC.CODMETA = MET.CODMETA AND PRC.DTREF = (SELECT MAX(DTREF) FROM AD_PRECOMARCA WHERE CODMETA = MET.CODMETA AND DTREF <= MET.DTREF AND MARCA = MET.MARCA))WHERE MET.CODMETA = :P_CODMETAAND MET.DTREF BETWEEN :P_PERIODO1.INI   AND  :P_PERIODO1.FINAND (VGF.CODGRUPOPROD = :P_GRUPOPROD OR :P_GRUPOPROD IS NULL)GROUP BY MET.DTREF,NVL(MET.CODVEND,0),NVL(MET.CODPARC,0),NVL(MET.MARCA,0),NVL(VGF.CODCENCUS,0), NVL(MET.QTDPREV,0), NVL(PRC.VLRVENDALT,0))AINNER JOIN TGFPAR PAR ON A.CODPARC = PAR.CODPARCINNER JOIN TGFVEN VEN ON A.CODVEND = VEN.CODVENDWHERE(VEN.CODVEND IN :P_CODVEND)AND (VEN.CODGER IN :P_CODGER)AND (PAR.CODPARC = :P_CODPARC OR :P_CODPARC IS NULL)AND (A.MARCA IN (SELECT MARCA FROM TGFPRO WHERE CODPROD IN :P_MARCA))AND (A.CODCENCUS = :P_CR OR :P_CR IS NULL)AND(VEN.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA VENDEDOROR VEN.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA GERENTEOR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' ---CONSULTA MASTER)GROUP BY A.CODVEND, APELIDO)T)XINNER JOIN VEND ON X.CODVEND = VEND.CODVEND)GROUP BY CODVEND,VENDEDOR)WHERE ((:P_NTEMMETA = 'S' AND (TTL_QTDPREV <> 0 OR TTL_QTDREAL <> 0 OR TTL_VLR_PREV <> 0 OR TTL_VLR_REAL<> 0)) OR :P_NTEMMETA = 'N')ORDER BY 2,3]]></expression>
        <metadata>
          <field name="CODVEND" label="Cód. Vend." type="I" visible="true" useFooter="false"/>
          <field name="VENDEDOR" label="Vendedor" type="S" visible="true" useFooter="false"/>
          <field name="PERIODO" label="Periodo" type="S" visible="true" useFooter="false"/>
          <field name="JUL_QTDPREV" label="Jul. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="JUL_QTDREAL" label="Jul. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="JUL_VLR_PREV" label="Jul. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="JUL_VLR_REAL" label="Jul. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="AGO_QTDPREV" label="Ago. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="AGO_QTDREAL" label="Ago. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="AGO_VLR_PREV" label="Ago. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="AGO_VLR_REAL" label="Ago. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="SET_QTDPREV" label="Set. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="SET_QTDREAL" label="Set. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="SET_VLR_PREV" label="Set. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="SET_VLR_REAL" label="Set. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="OUT_QTDPREV" label="Out. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="OUT_QTDREAL" label="Out. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="OUT_VLR_PREV" label="Out. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="OUT_VLR_REAL" label="Out. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="NOV_QTDPREV" label="Nov. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="NOV_QTDREAL" label="Nov. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="NOV_VLR_PREV" label="Nov. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="NOV_VLR_REAL" label="Nov. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="DEZ_QTDPREV" label="Dez. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="DEZ_QTDREAL" label="Dez. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="DEZ_VLR_PREV" label="Dez. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="DEZ_VLR_REAL" label="Dez. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="JAN_QTDPREV" label="Jan. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="JAN_QTDREAL" label="Jan. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="JAN_VLR_PREV" label="Jan. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="JAN_VLR_REAL" label="Jan. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="FEV_QTDPREV" label="Fev. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="FEV_QTDREAL" label="Fev. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="FEV_VLR_PREV" label="Fev. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="FEV_VLR_REAL" label="Fev. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="MAR_QTDPREV" label="Mar. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="MAR_QTDREAL" label="Mar. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="MAR_VLR_PREV" label="Mar. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="MAR_VLR_REAL" label="Mar. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="ABR_QTDPREV" label="Abr. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="ABR_QTDREAL" label="Abr. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="ABR_VLR_PREV" label="Abr. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="ABR_VLR_REAL" label="Abr. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="MAI_QTDPREV" label="Mai. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="MAI_QTDREAL" label="Mai. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="MAI_VLR_PREV" label="Mai. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="MAI_VLR_REAL" label="Mai. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="JUN_QTDPREV" label="Jun. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="JUN_QTDREAL" label="Jun. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="JUN_VLR_PREV" label="Jun. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="JUN_VLR_REAL" label="Jun. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="TTL_QTDPREV" label="Ttl. Qtd. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
          </field>
          <field name="TTL_QTDREAL" label="Ttl. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
          </field>
          <field name="TTL_VLR_PREV" label="Ttl. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
          </field>
          <field name="TTL_VLR_REAL" label="Ttl. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
          </field>
        </metadata>
        <on-click navigate-to="lvl_rq48q6">
          <param id="A_CODVEND">$CODVEND</param>
          <param id="A_VENDEDOR">$VENDEDOR</param>
        </on-click>
      </grid>
    </container>
  </level>
  <level id="lvl_ayxu9wi" description="Nivel4">
    <container orientacao="V" tamanhoRelativo="100">
      <grid id="grd_ayxu95j" useNewGrid="S">
        <title><![CDATA[<b>Consolidado por Marca - De: :P_PERIODO.INI  A: :P_PERIODO.FIN</b>]]></title>
        <expression type="sql" data-source="MGEDS"><![CDATA[SELECT*FROM(SELECTMARCA, 'Periodo 1: de '||:P_PERIODO.INI||' até '||:P_PERIODO.FIN AS PERIODO,SUM(JUL_QTDPREV) AS JUL_QTDPREV, SUM(JUL_QTDREAL) AS JUL_QTDREAL,  SUM(JUL_VLR_PREV) AS JUL_VLR_PREV, SUM(JUL_VLR_REAL) AS JUL_VLR_REAL, SUM(AGO_QTDPREV) AS AGO_QTDPREV, SUM(AGO_QTDREAL) AS AGO_QTDREAL, SUM(AGO_VLR_PREV) AS AGO_VLR_PREV, SUM(AGO_VLR_REAL) AS AGO_VLR_REAL, SUM(SET_QTDPREV) AS SET_QTDPREV, SUM(SET_QTDREAL) AS SET_QTDREAL, SUM(SET_VLR_PREV) AS SET_VLR_PREV, SUM(SET_VLR_REAL) AS SET_VLR_REAL, SUM(OUT_QTDPREV) AS OUT_QTDPREV, SUM(OUT_QTDREAL) AS OUT_QTDREAL, SUM(OUT_VLR_PREV) AS OUT_VLR_PREV, SUM(OUT_VLR_REAL) AS OUT_VLR_REAL, SUM(NOV_QTDPREV) AS NOV_QTDPREV, SUM(NOV_QTDREAL) AS NOV_QTDREAL, SUM(NOV_VLR_PREV) AS NOV_VLR_PREV, SUM(NOV_VLR_REAL) AS NOV_VLR_REAL, SUM(DEZ_QTDPREV) AS DEZ_QTDPREV, SUM(DEZ_QTDREAL) AS DEZ_QTDREAL, SUM(DEZ_VLR_PREV) AS DEZ_VLR_PREV, SUM(DEZ_VLR_REAL) AS DEZ_VLR_REAL, SUM(JAN_QTDPREV) AS JAN_QTDPREV, SUM(JAN_QTDREAL) AS JAN_QTDREAL, SUM(JAN_VLR_PREV) AS JAN_VLR_PREV, SUM(JAN_VLR_REAL) AS JAN_VLR_REAL, SUM(FEV_QTDPREV) AS FEV_QTDPREV, SUM(FEV_QTDREAL) AS FEV_QTDREAL, SUM(FEV_VLR_PREV) AS FEV_VLR_PREV, SUM(FEV_VLR_REAL) AS FEV_VLR_REAL, SUM(MAR_QTDPREV) AS MAR_QTDPREV, SUM(MAR_QTDREAL) AS MAR_QTDREAL, SUM(MAR_VLR_PREV) AS MAR_VLR_PREV, SUM(MAR_VLR_REAL) AS MAR_VLR_REAL, SUM(ABR_QTDPREV) AS ABR_QTDPREV, SUM(ABR_QTDREAL) AS ABR_QTDREAL, SUM(ABR_VLR_PREV) AS ABR_VLR_PREV, SUM(ABR_VLR_REAL) AS ABR_VLR_REAL, SUM(MAI_QTDPREV) AS MAI_QTDPREV, SUM(MAI_QTDREAL) AS MAI_QTDREAL, SUM(MAI_VLR_PREV) AS MAI_VLR_PREV, SUM(MAI_VLR_REAL) AS MAI_VLR_REAL, SUM(JUN_QTDPREV) AS JUN_QTDPREV, SUM(JUN_QTDREAL) AS JUN_QTDREAL, SUM(JUN_VLR_PREV) AS JUN_VLR_PREV, SUM(JUN_VLR_REAL) AS JUN_VLR_REAL, SUM(TTL_QTDPREV) AS TTL_QTDPREV, SUM(TTL_QTDREAL) AS TTL_QTDREAL, SUM(TTL_VLR_PREV) AS TTL_VLR_PREV, SUM(TTL_VLR_REAL) AS TTL_VLR_REAL FROM(---------------------------------------------------------------- NIVEL 3SELECTT.*,(JUL_QTDPREV + AGO_QTDPREV + SET_QTDPREV + OUT_QTDPREV+NOV_QTDPREV+DEZ_QTDPREV+JAN_QTDPREV+FEV_QTDPREV+MAR_QTDPREV+ABR_QTDPREV+MAI_QTDPREV+JUN_QTDPREV) AS TTL_QTDPREV,(JUL_QTDREAL + AGO_QTDREAL + SET_QTDREAL + OUT_QTDREAL+NOV_QTDREAL+DEZ_QTDREAL+JAN_QTDREAL+FEV_QTDREAL+MAR_QTDREAL+ABR_QTDREAL+MAI_QTDREAL+JUN_QTDREAL) AS TTL_QTDREAL,(JUL_VLR_PREV + AGO_VLR_PREV + SET_VLR_PREV + OUT_VLR_PREV+NOV_VLR_PREV+DEZ_VLR_PREV+JAN_VLR_PREV+FEV_VLR_PREV+MAR_VLR_PREV+ABR_VLR_PREV+MAI_VLR_PREV+JUN_VLR_PREV) AS TTL_VLR_PREV,(JUL_VLR_REAL + AGO_VLR_REAL + SET_VLR_REAL + OUT_VLR_REAL+NOV_VLR_REAL+DEZ_VLR_REAL+JAN_VLR_REAL+FEV_VLR_REAL+MAR_VLR_REAL+ABR_VLR_REAL+MAI_VLR_REAL+JUN_VLR_REAL) AS TTL_VLR_REALFROM (---------------------------------------------------------------- NIVEL 2SELECT A.MARCA,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUL_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUL_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUL_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUL_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS AGO_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS AGO_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS AGO_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS AGO_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS SET_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS SET_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS SET_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS SET_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS OUT_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS OUT_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS OUT_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS OUT_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS NOV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS NOV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS NOV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS NOV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS DEZ_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS DEZ_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS DEZ_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS DEZ_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JAN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JAN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JAN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JAN_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS FEV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS FEV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS FEV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS FEV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS ABR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS ABR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS ABR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS ABR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAI_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAI_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAI_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAI_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUN_VLR_REALFROM(---------------------------------------------------------------------------- NIVEL 1SELECT MET.DTREF, NVL(MET.CODVEND,0) AS CODVEND, NVL(MET.CODPARC,0) AS CODPARC, NVL(MET.MARCA,0) AS MARCA,NVL(VGF.CODCENCUS,0) AS CODCENCUS, NVL(MET.QTDPREV,0) AS QTDPREV, SUM(NVL(VGF.QTD,0)) AS QTDREAL,NVL(PRC.VLRVENDALT,0)AS PRECOLT, SUM(NVL(VGF.VLR,0)) AS VLRREALFROM TGFMET METLEFT JOIN VGF_VENDAS_SATIS VGF ON MET.DTREF = TRUNC(VGF.DTMOV,'MM') AND MET.CODVEND = VGF.CODVEND AND MET.CODPARC = VGF.CODPARC AND MET.MARCA = VGF.MARCA AND VGF.BONIFICACAO = 'N'LEFT JOIN AD_PRECOMARCA PRC ON (MET.MARCA = PRC.MARCA AND PRC.CODMETA = MET.CODMETA AND PRC.DTREF = (SELECT MAX(DTREF) FROM AD_PRECOMARCA WHERE CODMETA = MET.CODMETA AND DTREF <= MET.DTREF AND MARCA = MET.MARCA))WHERE MET.CODMETA = :P_CODMETAAND MET.DTREF BETWEEN :P_PERIODO.INI   AND  :P_PERIODO.FINAND (VGF.CODGRUPOPROD = :P_GRUPOPROD OR :P_GRUPOPROD IS NULL)GROUP BY MET.DTREF,NVL(MET.CODVEND,0),NVL(MET.CODPARC,0),NVL(MET.MARCA,0),NVL(VGF.CODCENCUS,0), NVL(MET.QTDPREV,0), NVL(PRC.VLRVENDALT,0)---------------------------------------------------------------- NIVEL 1)AINNER JOIN TGFPAR PAR ON A.CODPARC = PAR.CODPARCINNER JOIN TGFVEN VEN ON A.CODVEND = VEN.CODVENDWHERE(VEN.CODVEND IN :P_CODVEND)AND (VEN.CODGER IN :P_CODGER)AND (PAR.CODPARC = :P_CODPARC OR :P_CODPARC IS NULL)AND (A.MARCA IN (SELECT MARCA FROM TGFPRO WHERE CODPROD IN :P_MARCA))AND (A.CODCENCUS = :P_CR OR :P_CR IS NULL)AND(VEN.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA VENDEDOROR VEN.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA GERENTEOR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' ---CONSULTA MASTER)GROUP BY A.MARCA	------------------------------------------------------------------- NIVEL 2	)T	---------------------------------------------------------------- NIVEL 3	)GROUP BY MARCAUNION ALLSELECTMARCA, 'Periodo 2: de '||:P_PERIODO1.INI||' até '||:P_PERIODO1.FIN AS PERIODO,SUM(JUL_QTDPREV) AS JUL_QTDPREV, SUM(JUL_QTDREAL) AS JUL_QTDREAL,  SUM(JUL_VLR_PREV) AS JUL_VLR_PREV, SUM(JUL_VLR_REAL) AS JUL_VLR_REAL, SUM(AGO_QTDPREV) AS AGO_QTDPREV, SUM(AGO_QTDREAL) AS AGO_QTDREAL, SUM(AGO_VLR_PREV) AS AGO_VLR_PREV, SUM(AGO_VLR_REAL) AS AGO_VLR_REAL, SUM(SET_QTDPREV) AS SET_QTDPREV, SUM(SET_QTDREAL) AS SET_QTDREAL, SUM(SET_VLR_PREV) AS SET_VLR_PREV, SUM(SET_VLR_REAL) AS SET_VLR_REAL, SUM(OUT_QTDPREV) AS OUT_QTDPREV, SUM(OUT_QTDREAL) AS OUT_QTDREAL, SUM(OUT_VLR_PREV) AS OUT_VLR_PREV, SUM(OUT_VLR_REAL) AS OUT_VLR_REAL, SUM(NOV_QTDPREV) AS NOV_QTDPREV, SUM(NOV_QTDREAL) AS NOV_QTDREAL, SUM(NOV_VLR_PREV) AS NOV_VLR_PREV, SUM(NOV_VLR_REAL) AS NOV_VLR_REAL, SUM(DEZ_QTDPREV) AS DEZ_QTDPREV, SUM(DEZ_QTDREAL) AS DEZ_QTDREAL, SUM(DEZ_VLR_PREV) AS DEZ_VLR_PREV, SUM(DEZ_VLR_REAL) AS DEZ_VLR_REAL, SUM(JAN_QTDPREV) AS JAN_QTDPREV, SUM(JAN_QTDREAL) AS JAN_QTDREAL, SUM(JAN_VLR_PREV) AS JAN_VLR_PREV, SUM(JAN_VLR_REAL) AS JAN_VLR_REAL, SUM(FEV_QTDPREV) AS FEV_QTDPREV, SUM(FEV_QTDREAL) AS FEV_QTDREAL, SUM(FEV_VLR_PREV) AS FEV_VLR_PREV, SUM(FEV_VLR_REAL) AS FEV_VLR_REAL, SUM(MAR_QTDPREV) AS MAR_QTDPREV, SUM(MAR_QTDREAL) AS MAR_QTDREAL, SUM(MAR_VLR_PREV) AS MAR_VLR_PREV, SUM(MAR_VLR_REAL) AS MAR_VLR_REAL, SUM(ABR_QTDPREV) AS ABR_QTDPREV, SUM(ABR_QTDREAL) AS ABR_QTDREAL, SUM(ABR_VLR_PREV) AS ABR_VLR_PREV, SUM(ABR_VLR_REAL) AS ABR_VLR_REAL, SUM(MAI_QTDPREV) AS MAI_QTDPREV, SUM(MAI_QTDREAL) AS MAI_QTDREAL, SUM(MAI_VLR_PREV) AS MAI_VLR_PREV, SUM(MAI_VLR_REAL) AS MAI_VLR_REAL, SUM(JUN_QTDPREV) AS JUN_QTDPREV, SUM(JUN_QTDREAL) AS JUN_QTDREAL, SUM(JUN_VLR_PREV) AS JUN_VLR_PREV, SUM(JUN_VLR_REAL) AS JUN_VLR_REAL, SUM(TTL_QTDPREV) AS TTL_QTDPREV, SUM(TTL_QTDREAL) AS TTL_QTDREAL, SUM(TTL_VLR_PREV) AS TTL_VLR_PREV, SUM(TTL_VLR_REAL) AS TTL_VLR_REAL FROM(---------------------------------------------------------------- NIVEL 3SELECTT.*,(JUL_QTDPREV + AGO_QTDPREV + SET_QTDPREV + OUT_QTDPREV+NOV_QTDPREV+DEZ_QTDPREV+JAN_QTDPREV+FEV_QTDPREV+MAR_QTDPREV+ABR_QTDPREV+MAI_QTDPREV+JUN_QTDPREV) AS TTL_QTDPREV,(JUL_QTDREAL + AGO_QTDREAL + SET_QTDREAL + OUT_QTDREAL+NOV_QTDREAL+DEZ_QTDREAL+JAN_QTDREAL+FEV_QTDREAL+MAR_QTDREAL+ABR_QTDREAL+MAI_QTDREAL+JUN_QTDREAL) AS TTL_QTDREAL,(JUL_VLR_PREV + AGO_VLR_PREV + SET_VLR_PREV + OUT_VLR_PREV+NOV_VLR_PREV+DEZ_VLR_PREV+JAN_VLR_PREV+FEV_VLR_PREV+MAR_VLR_PREV+ABR_VLR_PREV+MAI_VLR_PREV+JUN_VLR_PREV) AS TTL_VLR_PREV,(JUL_VLR_REAL + AGO_VLR_REAL + SET_VLR_REAL + OUT_VLR_REAL+NOV_VLR_REAL+DEZ_VLR_REAL+JAN_VLR_REAL+FEV_VLR_REAL+MAR_VLR_REAL+ABR_VLR_REAL+MAI_VLR_REAL+JUN_VLR_REAL) AS TTL_VLR_REALFROM (---------------------------------------------------------------- NIVEL 2SELECT A.MARCA,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUL_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUL_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUL_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUL_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS AGO_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS AGO_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS AGO_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS AGO_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS SET_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS SET_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS SET_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS SET_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS OUT_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS OUT_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS OUT_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS OUT_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS NOV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS NOV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS NOV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS NOV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS DEZ_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS DEZ_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS DEZ_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS DEZ_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JAN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JAN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JAN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JAN_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS FEV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS FEV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS FEV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS FEV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS ABR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS ABR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS ABR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS ABR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAI_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAI_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAI_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAI_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUN_VLR_REAL	FROM(---------------------------------------------------------------------------- NIVEL 1SELECT MET.DTREF, NVL(MET.CODVEND,0) AS CODVEND, NVL(MET.CODPARC,0) AS CODPARC, NVL(MET.MARCA,0) AS MARCA,NVL(VGF.CODCENCUS,0) AS CODCENCUS, NVL(MET.QTDPREV,0) AS QTDPREV, SUM(NVL(VGF.QTD,0)) AS QTDREAL,NVL(PRC.VLRVENDALT,0)AS PRECOLT, SUM(NVL(VGF.VLR,0)) AS VLRREALFROM TGFMET METLEFT JOIN VGF_VENDAS_SATIS VGF ON MET.DTREF = TRUNC(VGF.DTMOV,'MM') AND MET.CODVEND = VGF.CODVEND AND MET.CODPARC = VGF.CODPARC AND MET.MARCA = VGF.MARCA AND VGF.BONIFICACAO = 'N'LEFT JOIN AD_PRECOMARCA PRC ON (MET.MARCA = PRC.MARCA AND PRC.CODMETA = MET.CODMETA AND PRC.DTREF = (SELECT MAX(DTREF) FROM AD_PRECOMARCA WHERE CODMETA = MET.CODMETA AND DTREF <= MET.DTREF AND MARCA = MET.MARCA))WHERE MET.CODMETA = :P_CODMETAAND MET.DTREF BETWEEN :P_PERIODO1.INI   AND  :P_PERIODO1.FINAND (VGF.CODGRUPOPROD = :P_GRUPOPROD OR :P_GRUPOPROD IS NULL)GROUP BY MET.DTREF,NVL(MET.CODVEND,0),NVL(MET.CODPARC,0),NVL(MET.MARCA,0),NVL(VGF.CODCENCUS,0), NVL(MET.QTDPREV,0), NVL(PRC.VLRVENDALT,0)---------------------------------------------------------------- NIVEL 1)AINNER JOIN TGFPAR PAR ON A.CODPARC = PAR.CODPARCINNER JOIN TGFVEN VEN ON A.CODVEND = VEN.CODVENDWHERE(VEN.CODVEND IN :P_CODVEND)AND (VEN.CODGER IN :P_CODGER)AND (PAR.CODPARC = :P_CODPARC OR :P_CODPARC IS NULL)AND (A.MARCA IN (SELECT MARCA FROM TGFPRO WHERE CODPROD IN :P_MARCA))AND (A.CODCENCUS = :P_CR OR :P_CR IS NULL)AND(VEN.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA VENDEDOROR VEN.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA GERENTEOR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' ---CONSULTA MASTER)GROUP BY A.MARCA	------------------------------------------------------------------- NIVEL 2	)T	---------------------------------------------------------------- NIVEL 3	)GROUP BY MARCA)WHERE ((:P_NTEMMETA = 'S' AND (TTL_QTDPREV <> 0 OR TTL_QTDREAL <> 0 OR TTL_VLR_PREV <> 0 OR TTL_VLR_REAL<> 0)) OR :P_NTEMMETA = 'N')ORDER BY 1,2]]></expression>
        <metadata>
          <field name="MARCA" label="MARCA" type="S" visible="true" useFooter="false"/>
          <field name="PERIODO" label="Periodo" type="S" visible="true" useFooter="false"/>
          <field name="JUL_QTDPREV" label="Jul. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="JUL_QTDREAL" label="Jul. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="JUL_VLR_PREV" label="Jul. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="JUL_VLR_REAL" label="Jul. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="AGO_QTDPREV" label="Ago. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="AGO_QTDREAL" label="Ago. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="AGO_VLR_PREV" label="Ago. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="AGO_VLR_REAL" label="Ago. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="SET_QTDPREV" label="Set. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="SET_QTDREAL" label="Set. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="SET_VLR_PREV" label="Set. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="SET_VLR_REAL" label="Set. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="OUT_QTDPREV" label="Out. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="OUT_QTDREAL" label="Out. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="OUT_VLR_PREV" label="Out. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="OUT_VLR_REAL" label="Out. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="NOV_QTDPREV" label="Nov. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="NOV_QTDREAL" label="Nov. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="NOV_VLR_PREV" label="Nov. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="NOV_VLR_REAL" label="Nov. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="DEZ_QTDPREV" label="Dez. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="DEZ_QTDREAL" label="Dez. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="DEZ_VLR_PREV" label="Dez. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="DEZ_VLR_REAL" label="Dez. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="JAN_QTDPREV" label="Jan. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="JAN_QTDREAL" label="Jan. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="JAN_VLR_PREV" label="Jan. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="JAN_VLR_REAL" label="Jan. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="FEV_QTDPREV" label="Fev. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="FEV_QTDREAL" label="Fev. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="FEV_VLR_PREV" label="Fev. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="FEV_VLR_REAL" label="Fev. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="MAR_QTDPREV" label="Mar. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="MAR_QTDREAL" label="Mar. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="MAR_VLR_PREV" label="Mar. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="MAR_VLR_REAL" label="Mar. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="ABR_QTDPREV" label="Abr. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="ABR_QTDREAL" label="Abr. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="ABR_VLR_PREV" label="Abr. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="ABR_VLR_REAL" label="Abr. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="MAI_QTDPREV" label="Mai. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="MAI_QTDREAL" label="Mai. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="MAI_VLR_PREV" label="Mai. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="MAI_VLR_REAL" label="Mai. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
          </field>
          <field name="JUN_QTDPREV" label="Jun. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="JUN_QTDREAL" label="Jun. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="JUN_VLR_PREV" label="Jun. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="JUN_VLR_REAL" label="Jun. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
          <field name="TTL_QTDPREV" label="Ttl. Qtd. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
          </field>
          <field name="TTL_QTDREAL" label="Ttl. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
          </field>
          <field name="TTL_VLR_PREV" label="Ttl. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
          </field>
          <field name="TTL_VLR_REAL" label="Ttl. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
            <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
          </field>
        </metadata>
        <on-click navigate-to="lvl_a3aoohn">
          <param id="A_MARCA">$MARCA</param>
        </on-click>
      </grid>
    </container>
  </level>
  <level id="lvl_a3aoohn" description="Nivel5">
    <args>
      <arg id="A_MARCA" type="text"/>
    </args>
    <container orientacao="V" tamanhoRelativo="100">
      <container orientacao="V" tamanhoRelativo="50">
        <grid id="grd_a3aooh8" useNewGrid="S">
          <title><![CDATA[<b>Consolidado por Vendedor - De: :P_PERIODO.INI  A: :P_PERIODO.FIN</b>]]></title>
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECTCODVEND, VENDEDOR AS APELIDO,SUM(JUL_QTDPREV) AS JUL_QTDPREV, SUM(JUL_QTDREAL) AS JUL_QTDREAL,  SUM(JUL_VLR_PREV) AS JUL_VLR_PREV, SUM(JUL_VLR_REAL) AS JUL_VLR_REAL, SUM(AGO_QTDPREV) AS AGO_QTDPREV, SUM(AGO_QTDREAL) AS AGO_QTDREAL, SUM(AGO_VLR_PREV) AS AGO_VLR_PREV, SUM(AGO_VLR_REAL) AS AGO_VLR_REAL, SUM(SET_QTDPREV) AS SET_QTDPREV, SUM(SET_QTDREAL) AS SET_QTDREAL, SUM(SET_VLR_PREV) AS SET_VLR_PREV, SUM(SET_VLR_REAL) AS SET_VLR_REAL, SUM(OUT_QTDPREV) AS OUT_QTDPREV, SUM(OUT_QTDREAL) AS OUT_QTDREAL, SUM(OUT_VLR_PREV) AS OUT_VLR_PREV, SUM(OUT_VLR_REAL) AS OUT_VLR_REAL, SUM(NOV_QTDPREV) AS NOV_QTDPREV, SUM(NOV_QTDREAL) AS NOV_QTDREAL, SUM(NOV_VLR_PREV) AS NOV_VLR_PREV, SUM(NOV_VLR_REAL) AS NOV_VLR_REAL, SUM(DEZ_QTDPREV) AS DEZ_QTDPREV, SUM(DEZ_QTDREAL) AS DEZ_QTDREAL, SUM(DEZ_VLR_PREV) AS DEZ_VLR_PREV, SUM(DEZ_VLR_REAL) AS DEZ_VLR_REAL, SUM(JAN_QTDPREV) AS JAN_QTDPREV, SUM(JAN_QTDREAL) AS JAN_QTDREAL, SUM(JAN_VLR_PREV) AS JAN_VLR_PREV, SUM(JAN_VLR_REAL) AS JAN_VLR_REAL, SUM(FEV_QTDPREV) AS FEV_QTDPREV, SUM(FEV_QTDREAL) AS FEV_QTDREAL, SUM(FEV_VLR_PREV) AS FEV_VLR_PREV, SUM(FEV_VLR_REAL) AS FEV_VLR_REAL, SUM(MAR_QTDPREV) AS MAR_QTDPREV, SUM(MAR_QTDREAL) AS MAR_QTDREAL, SUM(MAR_VLR_PREV) AS MAR_VLR_PREV, SUM(MAR_VLR_REAL) AS MAR_VLR_REAL, SUM(ABR_QTDPREV) AS ABR_QTDPREV, SUM(ABR_QTDREAL) AS ABR_QTDREAL, SUM(ABR_VLR_PREV) AS ABR_VLR_PREV, SUM(ABR_VLR_REAL) AS ABR_VLR_REAL, SUM(MAI_QTDPREV) AS MAI_QTDPREV, SUM(MAI_QTDREAL) AS MAI_QTDREAL, SUM(MAI_VLR_PREV) AS MAI_VLR_PREV, SUM(MAI_VLR_REAL) AS MAI_VLR_REAL, SUM(JUN_QTDPREV) AS JUN_QTDPREV, SUM(JUN_QTDREAL) AS JUN_QTDREAL, SUM(JUN_VLR_PREV) AS JUN_VLR_PREV, SUM(JUN_VLR_REAL) AS JUN_VLR_REAL, SUM(TTL_QTDPREV) AS TTL_QTDPREV, SUM(TTL_QTDREAL) AS TTL_QTDREAL, SUM(TTL_VLR_PREV) AS TTL_VLR_PREV, SUM(TTL_VLR_REAL) AS TTL_VLR_REAL FROM(WITH VEND AS (SELECT VEN.CODVEND, VEN.APELIDO AS VENDEDOR, VEN.CODGER,VEN1.APELIDO AS COORD FROM TGFVEN VEN INNER JOIN TGFVEN VEN1 ON VEN.CODGER = VEN1.CODVEND)SELECT  (CASE     WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEND.CODGER    ELSE X.CODVEND END) AS CODVEND,  (CASE    WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEND.COORD    ELSE VEND.VENDEDOR END) AS VENDEDOR,JUL_QTDPREV, JUL_QTDREAL, JUL_VLR_PREV, JUL_VLR_REAL, AGO_QTDPREV, AGO_QTDREAL, AGO_VLR_PREV, AGO_VLR_REAL, SET_QTDPREV, SET_QTDREAL, SET_VLR_PREV, SET_VLR_REAL, OUT_QTDPREV, OUT_QTDREAL, OUT_VLR_PREV, OUT_VLR_REAL, NOV_QTDPREV, NOV_QTDREAL, NOV_VLR_PREV, NOV_VLR_REAL, DEZ_QTDPREV, DEZ_QTDREAL, DEZ_VLR_PREV, DEZ_VLR_REAL, JAN_QTDPREV, JAN_QTDREAL, JAN_VLR_PREV, JAN_VLR_REAL, FEV_QTDPREV, FEV_QTDREAL, FEV_VLR_PREV, FEV_VLR_REAL, MAR_QTDPREV, MAR_QTDREAL, MAR_VLR_PREV, MAR_VLR_REAL, ABR_QTDPREV, ABR_QTDREAL, ABR_VLR_PREV, ABR_VLR_REAL, MAI_QTDPREV, MAI_QTDREAL, MAI_VLR_PREV, MAI_VLR_REAL, JUN_QTDPREV, JUN_QTDREAL, JUN_VLR_PREV, JUN_VLR_REAL,TTL_QTDPREV,TTL_QTDREAL,TTL_VLR_PREV,TTL_VLR_REALFROM(SELECTT.*,(JUL_QTDPREV + AGO_QTDPREV + SET_QTDPREV + OUT_QTDPREV+NOV_QTDPREV+DEZ_QTDPREV+JAN_QTDPREV+FEV_QTDPREV+MAR_QTDPREV+ABR_QTDPREV+MAI_QTDPREV+JUN_QTDPREV) AS TTL_QTDPREV,(JUL_QTDREAL + AGO_QTDREAL + SET_QTDREAL + OUT_QTDREAL+NOV_QTDREAL+DEZ_QTDREAL+JAN_QTDREAL+FEV_QTDREAL+MAR_QTDREAL+ABR_QTDREAL+MAI_QTDREAL+JUN_QTDREAL) AS TTL_QTDREAL,(JUL_VLR_PREV + AGO_VLR_PREV + SET_VLR_PREV + OUT_VLR_PREV+NOV_VLR_PREV+DEZ_VLR_PREV+JAN_VLR_PREV+FEV_VLR_PREV+MAR_VLR_PREV+ABR_VLR_PREV+MAI_VLR_PREV+JUN_VLR_PREV) AS TTL_VLR_PREV,(JUL_VLR_REAL + AGO_VLR_REAL + SET_VLR_REAL + OUT_VLR_REAL+NOV_VLR_REAL+DEZ_VLR_REAL+JAN_VLR_REAL+FEV_VLR_REAL+MAR_VLR_REAL+ABR_VLR_REAL+MAI_VLR_REAL+JUN_VLR_REAL) AS TTL_VLR_REALFROM (SELECT A.CODVEND,APELIDO,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUL_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUL_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUL_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUL_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS AGO_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS AGO_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS AGO_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS AGO_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS SET_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS SET_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS SET_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS SET_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS OUT_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS OUT_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS OUT_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS OUT_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS NOV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS NOV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS NOV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS NOV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS DEZ_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS DEZ_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS DEZ_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS DEZ_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JAN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JAN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JAN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JAN_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS FEV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS FEV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS FEV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS FEV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS ABR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS ABR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS ABR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS ABR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAI_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAI_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAI_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAI_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUN_VLR_REALFROM(SELECT MET.DTREF, NVL(MET.CODVEND,0) AS CODVEND, NVL(MET.CODPARC,0) AS CODPARC, NVL(MET.MARCA,0) AS MARCA,NVL(VGF.CODCENCUS,0) AS CODCENCUS, NVL(MET.QTDPREV,0) AS QTDPREV, SUM(NVL(VGF.QTD,0)) AS QTDREAL,NVL(PRC.VLRVENDALT,0)AS PRECOLT, SUM(NVL(VGF.VLR,0)) AS VLRREALFROM TGFMET METLEFT JOIN VGF_VENDAS_SATIS VGF ON MET.DTREF = TRUNC(VGF.DTMOV,'MM') AND MET.CODVEND = VGF.CODVEND AND MET.CODPARC = VGF.CODPARC AND MET.MARCA = VGF.MARCA AND VGF.BONIFICACAO = 'N'LEFT JOIN AD_PRECOMARCA PRC ON (MET.MARCA = PRC.MARCA AND PRC.CODMETA = MET.CODMETA AND PRC.DTREF = (SELECT MAX(DTREF) FROM AD_PRECOMARCA WHERE CODMETA = MET.CODMETA AND DTREF <= MET.DTREF AND MARCA = MET.MARCA))WHERE MET.CODMETA = :P_CODMETAAND MET.DTREF BETWEEN :P_PERIODO.INI   AND  :P_PERIODO.FINAND ((:P_NTEMMETA = 'S' AND (MET.QTDPREV <> 0 OR MET.QTDREAL <> 0)) OR :P_NTEMMETA = 'N')AND (VGF.CODGRUPOPROD = :P_GRUPOPROD OR :P_GRUPOPROD IS NULL)GROUP BY MET.DTREF,NVL(MET.CODVEND,0),NVL(MET.CODPARC,0),NVL(MET.MARCA,0),NVL(VGF.CODCENCUS,0), NVL(MET.QTDPREV,0), NVL(PRC.VLRVENDALT,0))AINNER JOIN TGFPAR PAR ON A.CODPARC = PAR.CODPARCINNER JOIN TGFVEN VEN ON A.CODVEND = VEN.CODVENDWHERE(VEN.CODVEND IN :P_CODVEND)AND (VEN.CODGER IN :P_CODGER)AND (PAR.CODPARC = :P_CODPARC OR :P_CODPARC IS NULL)AND (A.MARCA = :A_MARCA)AND (A.CODCENCUS = :P_CR OR :P_CR IS NULL)AND(VEN.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA VENDEDOROR VEN.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA GERENTEOR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' ---CONSULTA MASTER)GROUP BY A.CODVEND, APELIDO)T)XINNER JOIN VEND ON X.CODVEND = VEND.CODVEND)GROUP BY CODVEND, VENDEDORORDER BY 2]]></expression>
          <metadata>
            <field name="CODVEND" label="Cód. Vend." type="I" visible="true" useFooter="false"/>
            <field name="APELIDO" label="Vendedor" type="S" visible="true" useFooter="false"/>
            <field name="JUL_QTDPREV" label="Jul. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUL_QTDREAL" label="Jul. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUL_VLR_PREV" label="Jul. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUL_VLR_REAL" label="Jul. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="AGO_QTDPREV" label="Ago. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="AGO_QTDREAL" label="Ago. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="AGO_VLR_PREV" label="Ago. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="AGO_VLR_REAL" label="Ago. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="SET_QTDPREV" label="Set. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="SET_QTDREAL" label="Set. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="SET_VLR_PREV" label="Set. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="SET_VLR_REAL" label="Set. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="OUT_QTDPREV" label="Out. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="OUT_QTDREAL" label="Out. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="OUT_VLR_PREV" label="Out. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="OUT_VLR_REAL" label="Out. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="NOV_QTDPREV" label="Nov. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="NOV_QTDREAL" label="Nov. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="NOV_VLR_PREV" label="Nov. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="NOV_VLR_REAL" label="Nov. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="DEZ_QTDPREV" label="Dez. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="DEZ_QTDREAL" label="Dez. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="DEZ_VLR_PREV" label="Dez. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="DEZ_VLR_REAL" label="Dez. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JAN_QTDPREV" label="Jan. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JAN_QTDREAL" label="Jan. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JAN_VLR_PREV" label="Jan. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JAN_VLR_REAL" label="Jan. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="FEV_QTDPREV" label="Fev. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="FEV_QTDREAL" label="Fev. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="FEV_VLR_PREV" label="Fev. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="FEV_VLR_REAL" label="Fev. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="MAR_QTDPREV" label="Mar. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAR_QTDREAL" label="Mar. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAR_VLR_PREV" label="Mar. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAR_VLR_REAL" label="Mar. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="ABR_QTDPREV" label="Abr. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="ABR_QTDREAL" label="Abr. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="ABR_VLR_PREV" label="Abr. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="ABR_VLR_REAL" label="Abr. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="MAI_QTDPREV" label="Mai. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAI_QTDREAL" label="Mai. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAI_VLR_PREV" label="Mai. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAI_VLR_REAL" label="Mai. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUN_QTDPREV" label="Jun. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JUN_QTDREAL" label="Jun. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JUN_VLR_PREV" label="Jun. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JUN_VLR_REAL" label="Jun. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="TTL_QTDPREV" label="Ttl. Qtd. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
            <field name="TTL_QTDREAL" label="Ttl. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
            <field name="TTL_VLR_PREV" label="Ttl. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
            <field name="TTL_VLR_REAL" label="Ttl. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
          </metadata>
          <on-click navigate-to="lvl_rq48q6">
            <param id="A_CODVEND">$CODVEND</param>
            <param id="A_VENDEDOR">$APELIDO</param>
          </on-click>
          <refresh-details ui-list="svl_rlk0da">
            <param id="A_CODVEND">$CODVEND</param>
            <param id="A_VENDEDOR">$APELIDO</param>
          </refresh-details>
        </grid>
      </container>
      <container orientacao="V" tamanhoRelativo="50">
        <grid id="grd_a3aoois" useNewGrid="S">
          <title><![CDATA[<b>Consolidado por Vendedor - De: :P_PERIODO1.INI  A: :P_PERIODO1.FIN</b>]]></title>
          <expression type="sql" data-source="MGEDS"><![CDATA[SELECTCODVEND,VENDEDOR AS APELIDO,SUM(JUL_QTDPREV) AS JUL_QTDPREV, SUM(JUL_QTDREAL) AS JUL_QTDREAL,  SUM(JUL_VLR_PREV) AS JUL_VLR_PREV, SUM(JUL_VLR_REAL) AS JUL_VLR_REAL, SUM(AGO_QTDPREV) AS AGO_QTDPREV, SUM(AGO_QTDREAL) AS AGO_QTDREAL, SUM(AGO_VLR_PREV) AS AGO_VLR_PREV, SUM(AGO_VLR_REAL) AS AGO_VLR_REAL, SUM(SET_QTDPREV) AS SET_QTDPREV, SUM(SET_QTDREAL) AS SET_QTDREAL, SUM(SET_VLR_PREV) AS SET_VLR_PREV, SUM(SET_VLR_REAL) AS SET_VLR_REAL, SUM(OUT_QTDPREV) AS OUT_QTDPREV, SUM(OUT_QTDREAL) AS OUT_QTDREAL, SUM(OUT_VLR_PREV) AS OUT_VLR_PREV, SUM(OUT_VLR_REAL) AS OUT_VLR_REAL, SUM(NOV_QTDPREV) AS NOV_QTDPREV, SUM(NOV_QTDREAL) AS NOV_QTDREAL, SUM(NOV_VLR_PREV) AS NOV_VLR_PREV, SUM(NOV_VLR_REAL) AS NOV_VLR_REAL, SUM(DEZ_QTDPREV) AS DEZ_QTDPREV, SUM(DEZ_QTDREAL) AS DEZ_QTDREAL, SUM(DEZ_VLR_PREV) AS DEZ_VLR_PREV, SUM(DEZ_VLR_REAL) AS DEZ_VLR_REAL, SUM(JAN_QTDPREV) AS JAN_QTDPREV, SUM(JAN_QTDREAL) AS JAN_QTDREAL, SUM(JAN_VLR_PREV) AS JAN_VLR_PREV, SUM(JAN_VLR_REAL) AS JAN_VLR_REAL, SUM(FEV_QTDPREV) AS FEV_QTDPREV, SUM(FEV_QTDREAL) AS FEV_QTDREAL, SUM(FEV_VLR_PREV) AS FEV_VLR_PREV, SUM(FEV_VLR_REAL) AS FEV_VLR_REAL, SUM(MAR_QTDPREV) AS MAR_QTDPREV, SUM(MAR_QTDREAL) AS MAR_QTDREAL, SUM(MAR_VLR_PREV) AS MAR_VLR_PREV, SUM(MAR_VLR_REAL) AS MAR_VLR_REAL, SUM(ABR_QTDPREV) AS ABR_QTDPREV, SUM(ABR_QTDREAL) AS ABR_QTDREAL, SUM(ABR_VLR_PREV) AS ABR_VLR_PREV, SUM(ABR_VLR_REAL) AS ABR_VLR_REAL, SUM(MAI_QTDPREV) AS MAI_QTDPREV, SUM(MAI_QTDREAL) AS MAI_QTDREAL, SUM(MAI_VLR_PREV) AS MAI_VLR_PREV, SUM(MAI_VLR_REAL) AS MAI_VLR_REAL, SUM(JUN_QTDPREV) AS JUN_QTDPREV, SUM(JUN_QTDREAL) AS JUN_QTDREAL, SUM(JUN_VLR_PREV) AS JUN_VLR_PREV, SUM(JUN_VLR_REAL) AS JUN_VLR_REAL, SUM(TTL_QTDPREV) AS TTL_QTDPREV, SUM(TTL_QTDREAL) AS TTL_QTDREAL, SUM(TTL_VLR_PREV) AS TTL_VLR_PREV, SUM(TTL_VLR_REAL) AS TTL_VLR_REAL FROM(WITH VEND AS (SELECT VEN.CODVEND, VEN.APELIDO AS VENDEDOR, VEN.CODGER,VEN1.APELIDO AS COORD FROM TGFVEN VEN INNER JOIN TGFVEN VEN1 ON VEN.CODGER = VEN1.CODVEND)SELECT  (CASE     WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEND.CODGER    ELSE X.CODVEND END) AS CODVEND,  (CASE    WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEND.COORD    ELSE VEND.VENDEDOR END) AS VENDEDOR,JUL_QTDPREV, JUL_QTDREAL, JUL_VLR_PREV, JUL_VLR_REAL, AGO_QTDPREV, AGO_QTDREAL, AGO_VLR_PREV, AGO_VLR_REAL, SET_QTDPREV, SET_QTDREAL, SET_VLR_PREV, SET_VLR_REAL, OUT_QTDPREV, OUT_QTDREAL, OUT_VLR_PREV, OUT_VLR_REAL, NOV_QTDPREV, NOV_QTDREAL, NOV_VLR_PREV, NOV_VLR_REAL, DEZ_QTDPREV, DEZ_QTDREAL, DEZ_VLR_PREV, DEZ_VLR_REAL, JAN_QTDPREV, JAN_QTDREAL, JAN_VLR_PREV, JAN_VLR_REAL, FEV_QTDPREV, FEV_QTDREAL, FEV_VLR_PREV, FEV_VLR_REAL, MAR_QTDPREV, MAR_QTDREAL, MAR_VLR_PREV, MAR_VLR_REAL, ABR_QTDPREV, ABR_QTDREAL, ABR_VLR_PREV, ABR_VLR_REAL, MAI_QTDPREV, MAI_QTDREAL, MAI_VLR_PREV, MAI_VLR_REAL, JUN_QTDPREV, JUN_QTDREAL, JUN_VLR_PREV, JUN_VLR_REAL,TTL_QTDPREV,TTL_QTDREAL,TTL_VLR_PREV,TTL_VLR_REALFROM(SELECTT.*,(JUL_QTDPREV + AGO_QTDPREV + SET_QTDPREV + OUT_QTDPREV+NOV_QTDPREV+DEZ_QTDPREV+JAN_QTDPREV+FEV_QTDPREV+MAR_QTDPREV+ABR_QTDPREV+MAI_QTDPREV+JUN_QTDPREV) AS TTL_QTDPREV,(JUL_QTDREAL + AGO_QTDREAL + SET_QTDREAL + OUT_QTDREAL+NOV_QTDREAL+DEZ_QTDREAL+JAN_QTDREAL+FEV_QTDREAL+MAR_QTDREAL+ABR_QTDREAL+MAI_QTDREAL+JUN_QTDREAL) AS TTL_QTDREAL,(JUL_VLR_PREV + AGO_VLR_PREV + SET_VLR_PREV + OUT_VLR_PREV+NOV_VLR_PREV+DEZ_VLR_PREV+JAN_VLR_PREV+FEV_VLR_PREV+MAR_VLR_PREV+ABR_VLR_PREV+MAI_VLR_PREV+JUN_VLR_PREV) AS TTL_VLR_PREV,(JUL_VLR_REAL + AGO_VLR_REAL + SET_VLR_REAL + OUT_VLR_REAL+NOV_VLR_REAL+DEZ_VLR_REAL+JAN_VLR_REAL+FEV_VLR_REAL+MAR_VLR_REAL+ABR_VLR_REAL+MAI_VLR_REAL+JUN_VLR_REAL) AS TTL_VLR_REALFROM (SELECT A.CODVEND,APELIDO,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUL_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUL_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUL_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUL_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS AGO_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS AGO_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS AGO_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS AGO_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS SET_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS SET_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS SET_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS SET_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS OUT_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS OUT_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS OUT_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS OUT_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS NOV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS NOV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS NOV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS NOV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS DEZ_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS DEZ_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS DEZ_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS DEZ_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JAN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JAN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JAN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JAN_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS FEV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS FEV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS FEV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS FEV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS ABR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS ABR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS ABR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS ABR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAI_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAI_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAI_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAI_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO1.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUN_VLR_REALFROM(SELECT MET.DTREF, NVL(MET.CODVEND,0) AS CODVEND, NVL(MET.CODPARC,0) AS CODPARC, NVL(MET.MARCA,0) AS MARCA,NVL(VGF.CODCENCUS,0) AS CODCENCUS, NVL(MET.QTDPREV,0) AS QTDPREV, SUM(NVL(VGF.QTD,0)) AS QTDREAL,NVL(PRC.VLRVENDALT,0)AS PRECOLT, SUM(NVL(VGF.VLR,0)) AS VLRREALFROM TGFMET METLEFT JOIN VGF_VENDAS_SATIS VGF ON MET.DTREF = TRUNC(VGF.DTMOV,'MM') AND MET.CODVEND = VGF.CODVEND AND MET.CODPARC = VGF.CODPARC AND MET.MARCA = VGF.MARCA AND VGF.BONIFICACAO = 'N'LEFT JOIN AD_PRECOMARCA PRC ON (MET.MARCA = PRC.MARCA AND PRC.CODMETA = MET.CODMETA AND PRC.DTREF = (SELECT MAX(DTREF) FROM AD_PRECOMARCA WHERE CODMETA = MET.CODMETA AND DTREF <= MET.DTREF AND MARCA = MET.MARCA))WHERE MET.CODMETA = :P_CODMETAAND MET.DTREF BETWEEN :P_PERIODO1.INI   AND  :P_PERIODO1.FINAND ((:P_NTEMMETA = 'S' AND (MET.QTDPREV <> 0 OR MET.QTDREAL <> 0)) OR :P_NTEMMETA = 'N')AND (VGF.CODGRUPOPROD = :P_GRUPOPROD OR :P_GRUPOPROD IS NULL)GROUP BY MET.DTREF,NVL(MET.CODVEND,0),NVL(MET.CODPARC,0),NVL(MET.MARCA,0),NVL(VGF.CODCENCUS,0), NVL(MET.QTDPREV,0), NVL(PRC.VLRVENDALT,0))AINNER JOIN TGFPAR PAR ON A.CODPARC = PAR.CODPARCINNER JOIN TGFVEN VEN ON A.CODVEND = VEN.CODVENDWHERE(VEN.CODVEND IN :P_CODVEND)AND (VEN.CODGER IN :P_CODGER)AND (PAR.CODPARC = :P_CODPARC OR :P_CODPARC IS NULL)AND (A.MARCA = :A_MARCA)AND (A.CODCENCUS = :P_CR OR :P_CR IS NULL)AND(VEN.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA VENDEDOROR VEN.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA GERENTEOR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' ---CONSULTA MASTER)GROUP BY A.CODVEND, APELIDO)T)XINNER JOIN VEND ON X.CODVEND = VEND.CODVEND)GROUP BY CODVEND,VENDEDORORDER BY 2]]></expression>
          <metadata>
            <field name="CODVEND" label="Cód. Vend." type="I" visible="true" useFooter="false"/>
            <field name="APELIDO" label="APELIDO" type="S" visible="true" useFooter="false"/>
            <field name="JUL_QTDPREV" label="Jul. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUL_QTDREAL" label="Jul. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUL_VLR_PREV" label="Jul. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUL_VLR_REAL" label="Jul. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="AGO_QTDPREV" label="Ago. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="AGO_QTDREAL" label="Ago. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="AGO_VLR_PREV" label="Ago. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="AGO_VLR_REAL" label="Ago. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="SET_QTDPREV" label="Set. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="SET_QTDREAL" label="Set. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="SET_VLR_PREV" label="Set. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="SET_VLR_REAL" label="Set. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="OUT_QTDPREV" label="Out. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="OUT_QTDREAL" label="Out. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="OUT_VLR_PREV" label="Out. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="OUT_VLR_REAL" label="Out. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="NOV_QTDPREV" label="Nov. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="NOV_QTDREAL" label="Nov. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="NOV_VLR_PREV" label="Nov. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="NOV_VLR_REAL" label="Nov. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="DEZ_QTDPREV" label="Dez. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="DEZ_QTDREAL" label="Dez. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="DEZ_VLR_PREV" label="Dez. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="DEZ_VLR_REAL" label="Dez. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JAN_QTDPREV" label="Jan. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JAN_QTDREAL" label="Jan. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JAN_VLR_PREV" label="Jan. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JAN_VLR_REAL" label="Jan. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="FEV_QTDPREV" label="Fev. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="FEV_QTDREAL" label="Fev. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="FEV_VLR_PREV" label="Fev. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="FEV_VLR_REAL" label="Fev. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="MAR_QTDPREV" label="Mar. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAR_QTDREAL" label="Mar. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAR_VLR_PREV" label="Mar. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAR_VLR_REAL" label="Mar. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="ABR_QTDPREV" label="Abr. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="ABR_QTDREAL" label="Abr. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="ABR_VLR_PREV" label="Abr. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="ABR_VLR_REAL" label="Abr. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="MAI_QTDPREV" label="Mai. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAI_QTDREAL" label="Mai. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAI_VLR_PREV" label="Mai. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="MAI_VLR_REAL" label="Mai. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="color:#FFFFFF; background-color:#17A817">$VALUE</span>]]></formatter>
            </field>
            <field name="JUN_QTDPREV" label="Jun. Qtd. Prev" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JUN_QTDREAL" label="Jun. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JUN_VLR_PREV" label="Jun. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="JUN_VLR_REAL" label="Jun. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00"/>
            <field name="TTL_QTDPREV" label="Ttl. Qtd. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
            <field name="TTL_QTDREAL" label="Ttl. Qtd. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
            <field name="TTL_VLR_PREV" label="Ttl. Vlr. Prev." type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
            <field name="TTL_VLR_REAL" label="Ttl. Vlr. Real" type="F" visible="true" useFooter="SUM" mask="#.##0,00">
              <formatter isEmpty="false"><![CDATA[<span style="; background-color:#33FF00">
  <b>$VALUE</b>
</span>]]></formatter>
            </field>
          </metadata>
          <refresh-details ui-list="svl_rlk0da">
            <param id="A_CODVEND">$CODVEND</param>
            <param id="A_VENDEDOR">$APELIDO</param>
          </refresh-details>
        </grid>
      </container>
    </container>
  </level>
  <level id="lvl_a3vjklz" description="teste">
    <container orientacao="V" tamanhoRelativo="100">
      <simple-value id="svl_a3vjk1s">
        <expression type="sql" data-source="MGEDS"><![CDATA[SELECT'CODVEND, APELIDO, '||        (CASE WHEN SUM(JUL_QTDPREV) = 0 THEN NULL ELSE 'JUL_QTDPREV' END) || ',' AS TFROM(SELECTCODVEND, VENDEDOR AS APELIDO,SUM(JUL_QTDPREV) AS JUL_QTDPREV, SUM(JUL_QTDREAL) AS JUL_QTDREAL,  SUM(JUL_VLR_PREV) AS JUL_VLR_PREV, SUM(JUL_VLR_REAL) AS JUL_VLR_REAL, SUM(AGO_QTDPREV) AS AGO_QTDPREV, SUM(AGO_QTDREAL) AS AGO_QTDREAL, SUM(AGO_VLR_PREV) AS AGO_VLR_PREV, SUM(AGO_VLR_REAL) AS AGO_VLR_REAL, SUM(SET_QTDPREV) AS SET_QTDPREV, SUM(SET_QTDREAL) AS SET_QTDREAL, SUM(SET_VLR_PREV) AS SET_VLR_PREV, SUM(SET_VLR_REAL) AS SET_VLR_REAL, SUM(OUT_QTDPREV) AS OUT_QTDPREV, SUM(OUT_QTDREAL) AS OUT_QTDREAL, SUM(OUT_VLR_PREV) AS OUT_VLR_PREV, SUM(OUT_VLR_REAL) AS OUT_VLR_REAL, SUM(NOV_QTDPREV) AS NOV_QTDPREV, SUM(NOV_QTDREAL) AS NOV_QTDREAL, SUM(NOV_VLR_PREV) AS NOV_VLR_PREV, SUM(NOV_VLR_REAL) AS NOV_VLR_REAL, SUM(DEZ_QTDPREV) AS DEZ_QTDPREV, SUM(DEZ_QTDREAL) AS DEZ_QTDREAL, SUM(DEZ_VLR_PREV) AS DEZ_VLR_PREV, SUM(DEZ_VLR_REAL) AS DEZ_VLR_REAL, SUM(JAN_QTDPREV) AS JAN_QTDPREV, SUM(JAN_QTDREAL) AS JAN_QTDREAL, SUM(JAN_VLR_PREV) AS JAN_VLR_PREV, SUM(JAN_VLR_REAL) AS JAN_VLR_REAL, SUM(FEV_QTDPREV) AS FEV_QTDPREV, SUM(FEV_QTDREAL) AS FEV_QTDREAL, SUM(FEV_VLR_PREV) AS FEV_VLR_PREV, SUM(FEV_VLR_REAL) AS FEV_VLR_REAL, SUM(MAR_QTDPREV) AS MAR_QTDPREV, SUM(MAR_QTDREAL) AS MAR_QTDREAL, SUM(MAR_VLR_PREV) AS MAR_VLR_PREV, SUM(MAR_VLR_REAL) AS MAR_VLR_REAL, SUM(ABR_QTDPREV) AS ABR_QTDPREV, SUM(ABR_QTDREAL) AS ABR_QTDREAL, SUM(ABR_VLR_PREV) AS ABR_VLR_PREV, SUM(ABR_VLR_REAL) AS ABR_VLR_REAL, SUM(MAI_QTDPREV) AS MAI_QTDPREV, SUM(MAI_QTDREAL) AS MAI_QTDREAL, SUM(MAI_VLR_PREV) AS MAI_VLR_PREV, SUM(MAI_VLR_REAL) AS MAI_VLR_REAL, SUM(JUN_QTDPREV) AS JUN_QTDPREV, SUM(JUN_QTDREAL) AS JUN_QTDREAL, SUM(JUN_VLR_PREV) AS JUN_VLR_PREV, SUM(JUN_VLR_REAL) AS JUN_VLR_REAL, SUM(TTL_QTDPREV) AS TTL_QTDPREV, SUM(TTL_QTDREAL) AS TTL_QTDREAL, SUM(TTL_VLR_PREV) AS TTL_VLR_PREV, SUM(TTL_VLR_REAL) AS TTL_VLR_REAL FROM(WITH VEND AS (SELECT VEN.CODVEND, VEN.APELIDO AS VENDEDOR, VEN.CODGER,VEN1.APELIDO AS COORD FROM TGFVEN VEN INNER JOIN TGFVEN VEN1 ON VEN.CODGER = VEN1.CODVEND)SELECT  (CASE     WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEND.CODGER    ELSE X.CODVEND END) AS CODVEND,  (CASE    WHEN :P_AGRUP_COORDENADOR = 'S' THEN VEND.COORD    ELSE VEND.VENDEDOR END) AS VENDEDOR,JUL_QTDPREV, JUL_QTDREAL, JUL_VLR_PREV, JUL_VLR_REAL, AGO_QTDPREV, AGO_QTDREAL, AGO_VLR_PREV, AGO_VLR_REAL, SET_QTDPREV, SET_QTDREAL, SET_VLR_PREV, SET_VLR_REAL, OUT_QTDPREV, OUT_QTDREAL, OUT_VLR_PREV, OUT_VLR_REAL, NOV_QTDPREV, NOV_QTDREAL, NOV_VLR_PREV, NOV_VLR_REAL, DEZ_QTDPREV, DEZ_QTDREAL, DEZ_VLR_PREV, DEZ_VLR_REAL, JAN_QTDPREV, JAN_QTDREAL, JAN_VLR_PREV, JAN_VLR_REAL, FEV_QTDPREV, FEV_QTDREAL, FEV_VLR_PREV, FEV_VLR_REAL, MAR_QTDPREV, MAR_QTDREAL, MAR_VLR_PREV, MAR_VLR_REAL, ABR_QTDPREV, ABR_QTDREAL, ABR_VLR_PREV, ABR_VLR_REAL, MAI_QTDPREV, MAI_QTDREAL, MAI_VLR_PREV, MAI_VLR_REAL, JUN_QTDPREV, JUN_QTDREAL, JUN_VLR_PREV, JUN_VLR_REAL,TTL_QTDPREV,TTL_QTDREAL,TTL_VLR_PREV,TTL_VLR_REALFROM(SELECTT.*,(JUL_QTDPREV + AGO_QTDPREV + SET_QTDPREV + OUT_QTDPREV+NOV_QTDPREV+DEZ_QTDPREV+JAN_QTDPREV+FEV_QTDPREV+MAR_QTDPREV+ABR_QTDPREV+MAI_QTDPREV+JUN_QTDPREV) AS TTL_QTDPREV,(JUL_QTDREAL + AGO_QTDREAL + SET_QTDREAL + OUT_QTDREAL+NOV_QTDREAL+DEZ_QTDREAL+JAN_QTDREAL+FEV_QTDREAL+MAR_QTDREAL+ABR_QTDREAL+MAI_QTDREAL+JUN_QTDREAL) AS TTL_QTDREAL,(JUL_VLR_PREV + AGO_VLR_PREV + SET_VLR_PREV + OUT_VLR_PREV+NOV_VLR_PREV+DEZ_VLR_PREV+JAN_VLR_PREV+FEV_VLR_PREV+MAR_VLR_PREV+ABR_VLR_PREV+MAI_VLR_PREV+JUN_VLR_PREV) AS TTL_VLR_PREV,(JUL_VLR_REAL + AGO_VLR_REAL + SET_VLR_REAL + OUT_VLR_REAL+NOV_VLR_REAL+DEZ_VLR_REAL+JAN_VLR_REAL+FEV_VLR_REAL+MAR_VLR_REAL+ABR_VLR_REAL+MAI_VLR_REAL+JUN_VLR_REAL) AS TTL_VLR_REALFROM (SELECT A.CODVEND,APELIDO,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUL_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUL_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUL_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 7 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUL_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS AGO_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS AGO_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS AGO_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 8 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS AGO_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS SET_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS SET_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS SET_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 9 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS SET_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS OUT_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS OUT_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS OUT_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 10 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS OUT_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS NOV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS NOV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS NOV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 11 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS NOV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDPREV ELSE 0 END) AS DEZ_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN QTDREAL ELSE 0 END) AS DEZ_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS DEZ_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 12 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.INI, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS DEZ_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JAN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JAN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JAN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 1 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JAN_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS FEV_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS FEV_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS FEV_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 2 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS FEV_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 3 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS ABR_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS ABR_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS ABR_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 4 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS ABR_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS MAI_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS MAI_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS MAI_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 5 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS MAI_VLR_REAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDPREV ELSE 0 END) AS JUN_QTDPREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN QTDREAL ELSE 0 END) AS JUN_QTDREAL,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (QTDPREV * PRECOLT) ELSE 0 END) AS JUN_VLR_PREV,SUM(CASE WHEN EXTRACT(MONTH FROM DTREF) = 6 AND EXTRACT(YEAR FROM DTREF) = TO_CHAR(:P_PERIODO.FIN, 'YYYY') THEN (VLRREAL) ELSE 0 END) AS JUN_VLR_REALFROM(SELECT MET.DTREF, NVL(MET.CODVEND,0) AS CODVEND, NVL(MET.CODPARC,0) AS CODPARC, NVL(MET.MARCA,0) AS MARCA,NVL(VGF.CODCENCUS,0) AS CODCENCUS, NVL(MET.QTDPREV,0) AS QTDPREV, SUM(NVL(VGF.QTD,0)) AS QTDREAL,NVL(PRC.VLRVENDALT,0)AS PRECOLT, SUM(NVL(VGF.VLR,0)) AS VLRREALFROM TGFMET METLEFT JOIN VGF_VENDAS_SATIS VGF ON MET.DTREF = TRUNC(VGF.DTMOV,'MM') AND MET.CODVEND = VGF.CODVEND AND MET.CODPARC = VGF.CODPARC AND MET.MARCA = VGF.MARCA AND VGF.BONIFICACAO = 'N'LEFT JOIN AD_PRECOMARCA PRC ON (MET.MARCA = PRC.MARCA AND PRC.CODMETA = MET.CODMETA AND PRC.DTREF = (SELECT MAX(DTREF) FROM AD_PRECOMARCA WHERE CODMETA = MET.CODMETA AND DTREF <= MET.DTREF AND MARCA = MET.MARCA))WHERE MET.CODMETA = :P_CODMETAAND MET.DTREF BETWEEN :P_PERIODO.INI   AND  :P_PERIODO.FINAND (VGF.CODGRUPOPROD = :P_GRUPOPROD OR :P_GRUPOPROD IS NULL)GROUP BY MET.DTREF,NVL(MET.CODVEND,0),NVL(MET.CODPARC,0),NVL(MET.MARCA,0),NVL(VGF.CODCENCUS,0), NVL(MET.QTDPREV,0), NVL(PRC.VLRVENDALT,0))AINNER JOIN TGFPAR PAR ON A.CODPARC = PAR.CODPARCINNER JOIN TGFVEN VEN ON A.CODVEND = VEN.CODVENDWHERE(VEN.CODVEND IN :P_CODVEND)AND (VEN.CODGER IN :P_CODGER)AND (PAR.CODPARC = :P_CODPARC OR :P_CODPARC IS NULL)AND (A.MARCA IN (SELECT MARCA FROM TGFPRO WHERE CODPROD IN :P_MARCA))AND (A.CODCENCUS = :P_CR OR :P_CR IS NULL)AND(VEN.CODVEND = (SELECT CODVEND FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA VENDEDOROR VEN.CODVEND IN (SELECT VEN.CODVEND FROM TGFVEN VEN, TSIUSU USU WHERE USU.CODVEND = VEN.CODGER AND USU.CODUSU = STP_GET_CODUSULOGADO) ---CONSULTA GERENTEOR (SELECT AD_GESTOR_META FROM TSIUSU WHERE CODUSU = STP_GET_CODUSULOGADO) = 'S' ---CONSULTA MASTER)GROUP BY A.CODVEND, APELIDO)T)XINNER JOIN VEND ON X.CODVEND = VEND.CODVEND)GROUP BY CODVEND, VENDEDOR)WHERE ((:P_NTEMMETA = 'S' AND (TTL_QTDPREV <> 0 OR TTL_QTDREAL <> 0 OR TTL_VLR_PREV <> 0 OR TTL_VLR_REAL<> 0)) OR :P_NTEMMETA = 'N')GROUP BY CODVEND,APELIDO]]></expression>
        <metadata>
          <field name="T" label="T" type="S" visible="true" useFooter="false"/>
        </metadata>
        <value-expression><![CDATA[$T]]></value-expression>
      </simple-value>
    </container>
  </level>
</gadget>