



SELECT TGFFIN.ABATIMENTO AS ABATIMENTO,TGFFIN.ABATIMENTOCAN AS ABATIMENTOCAN,TGFFIN.AD_CODREC AS AD_CODREC,TGFFIN.AGENCIA_CMC7 AS AGENCIA_CMC7,TGFFIN.ALIQICMS AS ALIQICMS,TGFFIN.AUTORIZADO AS AUTORIZADO,TGFFIN.BAIXAAPI AS BAIXAAPI,TGFFIN.BASEICMS AS BASEICMS,TGFFIN.BASEINSS AS BASEINSS,TGFFIN.BASEIRF AS BASEIRF,TGFFIN.BLOQVAR AS BLOQVAR,TGFFIN.CARTA AS CARTA,TGFFIN.CARTAODESC AS CARTAODESC,TGFFIN.CGC_CPF_CMC7 AS CGC_CPF_CMC7,TGFFIN.CHAVECTE AS CHAVECTE,TGFFIN.CHAVECTEREF AS CHAVECTEREF,TGFFIN.CHAVENFEGNRE AS CHAVENFEGNRE,TGFFIN.CHEQUERASTREADO_CMC7 AS CHEQUERASTREADO_CMC7,TGFFIN.CLASSIFCESSAOOBRA AS CLASSIFCESSAOOBRA,TGFFIN.CODBARRA AS CODBARRA,TGFFIN.CODBCO AS CODBCO,TGFFIN.CODBCO_CMC7 AS CODBCO_CMC7,TGFFIN.CODCBE AS CODCBE,TGFFIN.CODCC AS CODCC,TGFFIN.CODCENCUS AS CODCENCUS,TGFFIN.CODCFO AS CODCFO,TGFFIN.CODCIDFIMCTE AS CODCIDFIMCTE,TGFFIN.CODCIDINICTE AS CODCIDINICTE,TGFFIN.CODCONTATO AS CODCONTATO,TGFFIN.CODCTABCOINT AS CODCTABCOINT,TGFFIN.CODEMP AS CODEMP,TGFFIN.CODEMPBAIXA AS CODEMPBAIXA,TGFFIN.CODFUNC AS CODFUNC,TGFFIN.CODIGOBARRA AS CODIGOBARRA,TGFFIN.CODIMOVELRURAL AS CODIMOVELRURAL,TGFFIN.CODIPTU AS CODIPTU,TGFFIN.CODLST AS CODLST,TGFFIN.CODMOEDA AS CODMOEDA,TGFFIN.CODNAT AS CODNAT,TGFFIN.CODOBRA AS CODOBRA,TGFFIN.CODOBSPADRAO AS CODOBSPADRAO,TGFFIN.CODPARC AS CODPARC,TGFFIN.CODPROJ AS CODPROJ,TGFFIN.CODRECEITA AS CODRECEITA,TGFFIN.CODREGUA AS CODREGUA,TGFFIN.CODTIPOPER AS CODTIPOPER,TGFFIN.CODTIPOPERBAIXA AS CODTIPOPERBAIXA,TGFFIN.CODTIPTIT AS CODTIPTIT,TGFFIN.CODTRIB AS CODTRIB,TGFFIN.CODUSU AS CODUSU,TGFFIN.CODUSUBAIXA AS CODUSUBAIXA,TGFFIN.CODUSUCOBR AS CODUSUCOBR,TGFFIN.CODVEICULO AS CODVEICULO,TGFFIN.CODVEND AS CODVEND,TGFFIN.CONTA_CMC7 AS CONTA_CMC7,TGFFIN.CUSTASPROCESSUAIS AS CUSTASPROCESSUAIS,TGFFIN.DEPOSITOJUDICIAL AS DEPOSITOJUDICIAL,TGFFIN.DESCRTPAGNFCE AS DESCRTPAGNFCE,TGFFIN.DESDOBDUPL AS DESDOBDUPL,TGFFIN.DESDOBRAMENTO AS DESDOBRAMENTO,TGFFIN.DESPADVOGADO AS DESPADVOGADO,TGFFIN.DESPCART AS DESPCART,TGFFIN.DHBAIXA AS DHBAIXA,TGFFIN.DHMOV AS DHMOV,TGFFIN.DHTIPOPER AS DHTIPOPER,TGFFIN.DHTIPOPERBAIXA AS DHTIPOPERBAIXA,TGFFIN.DH_IMPRESSAO AS DH_IMPRESSAO,TGFFIN.DIGSAFRA AS DIGSAFRA,TGFFIN.DTALTER AS DTALTER,TGFFIN.DTBAIXAPREV AS DTBAIXAPREV,TGFFIN.DTCONTAB AS DTCONTAB,TGFFIN.DTCONTABBAIXA AS DTCONTABBAIXA,TGFFIN.DTENTSAI AS DTENTSAI,TGFFIN.DTENTSAIINFO AS DTENTSAIINFO,TGFFIN.DTINITREFAPURACAO AS DTINITREFAPURACAO,TGFFIN.DTINTEGRACAOIPI AS DTINTEGRACAOIPI,TGFFIN.DTNEG AS DTNEG,TGFFIN.DTPRAZO AS DTPRAZO,TGFFIN.DTREFERENCIA AS DTREFERENCIA,TGFFIN.DTVENC AS DTVENC,TGFFIN.DTVENCINIC AS DTVENCINIC,TGFFIN.EMVPIX AS EMVPIX,TGFFIN.EXIGEISSQN AS EXIGEISSQN,TGFFIN.HISTORICO AS HISTORICO,TGFFIN.IDLOTEFDIC AS IDLOTEFDIC,TGFFIN.IDUNICO AS IDUNICO,TGFFIN.INDRECEFDCONT AS INDRECEFDCONT,TGFFIN.INFCOMPLEFDCONT AS INFCOMPLEFDCONT,TGFFIN.INSSRETIDO AS INSSRETIDO,TGFFIN.IRFRETIDO AS IRFRETIDO,TGFFIN.ISSRETIDO AS ISSRETIDO,TGFFIN.JUROSAVP AS JUROSAVP,TGFFIN.LINHADIGITAVEL AS LINHADIGITAVEL,TGFFIN.M2 AS M2,TGFFIN.METODOCALCIRRF AS METODOCALCIRRF,TGFFIN.MODELONFDES AS MODELONFDES,TGFFIN.MONIOCOREM AS MONIOCOREM,TGFFIN.MOTNAORETERISSQN AS MOTNAORETERISSQN,TGFFIN.NATUREZAOPERDES AS NATUREZAOPERDES,TGFFIN.NFCOMPLFIX AS NFCOMPLFIX,TGFFIN.NFENTSEQFIX AS NFENTSEQFIX,TGFFIN.NOMEEMITENTE_CMC7 AS NOMEEMITENTE_CMC7,TGFFIN.NOSSONUM AS NOSSONUM,TGFFIN.NROIMPORT AS NROIMPORT,TGFFIN.NROLOTEGNRE AS NROLOTEGNRE,TGFFIN.NUANTBANC AS NUANTBANC,TGFFIN.NUAPONTA AS NUAPONTA,TGFFIN.NUBCO AS NUBCO,TGFFIN.NUCAIXA AS NUCAIXA,TGFFIN.NUCCR AS NUCCR,TGFFIN.NUCHQ AS NUCHQ,TGFFIN.NUCKC AS NUCKC,TGFFIN.NUCOMPENS AS NUCOMPENS,TGFFIN.NUDEV AS NUDEV,TGFFIN.NUFIN AS NUFIN,TGFFIN.NUFTC AS NUFTC,TGFFIN.NUMBOR AS NUMBOR,TGFFIN.NUMCONTRATO AS NUMCONTRATO,TGFFIN.NUMDOCARRECAD AS NUMDOCARRECAD,TGFFIN.NUMDUPL AS NUMDUPL,TGFFIN.NUMNFSE AS NUMNFSE,TGFFIN.NUMNOTA AS NUMNOTA,TGFFIN.NUMOCORRENCIAS AS NUMOCORRENCIAS,TGFFIN.NUMOS AS NUMOS,TGFFIN.NUMPROCADMJUDIC AS NUMPROCADMJUDIC,TGFFIN.NUMREMESSA AS NUMREMESSA,TGFFIN.NUNOTA AS NUNOTA,TGFFIN.NUPED AS NUPED,TGFFIN.NURENEG AS NURENEG,TGFFIN.NUVERBA AS NUVERBA,TGFFIN.OBRACONSTCIVIL AS OBRACONSTCIVIL,TGFFIN.ORDEMCARGA AS ORDEMCARGA,TGFFIN.ORIGEM AS ORIGEM,TGFFIN.PARCRENEG AS PARCRENEG,TGFFIN.PDD AS PDD,TGFFIN.PIXTEF AS PIXTEF,TGFFIN.PROVISAO AS PROVISAO,TGFFIN.RATEADO AS RATEADO,TGFFIN.RECADIANTAMENTORURAL AS RECADIANTAMENTORURAL,TGFFIN.RECDESP AS RECDESP,TGFFIN.RECEBCARTAO AS RECEBCARTAO,TGFFIN.RECEBIDO AS RECEBIDO,TGFFIN.REFATCON AS REFATCON,TGFFIN.REGESPTRIBUT AS REGESPTRIBUT,TGFFIN.REJEICAOGNRE AS REJEICAOGNRE,TGFFIN.SANGDESPDV AS SANGDESPDV,TGFFIN.SEQCAIXA AS SEQCAIXA,TGFFIN.SEQUENCIA AS SEQUENCIA,TGFFIN.SERIENFDES AS SERIENFDES,TGFFIN.SERIENOTA AS SERIENOTA,TGFFIN.SITESPECIALRESP AS SITESPECIALRESP,TGFFIN.STATUSGNRE AS STATUSGNRE,TGFFIN.TIMBLOQUEADA AS TIMBLOQUEADA,TGFFIN.TIMCONTALANC AS TIMCONTALANC,TGFFIN.TIMCONTAREP AS TIMCONTAREP,TGFFIN.TIMCONTRATOADM AS TIMCONTRATOADM,TGFFIN.TIMCONTRATOLOC AS TIMCONTRATOLOC,TGFFIN.TIMCONTRATOLTV AS TIMCONTRATOLTV,TGFFIN.TIMDATADEJUR AS TIMDATADEJUR,TGFFIN.TIMDHBAIXA AS TIMDHBAIXA,TGFFIN.TIMDHGERREPASSE AS TIMDHGERREPASSE,TGFFIN.TIMDHGERREPPARCIAL AS TIMDHGERREPPARCIAL,TGFFIN.TIMDTIMPBOL AS TIMDTIMPBOL,TGFFIN.TIMDTIMPBOLLOCAL AS TIMDTIMPBOLLOCAL,TGFFIN.TIMDTREPASSE AS TIMDTREPASSE,TGFFIN.TIMDTREPPARCIAL AS TIMDTREPPARCIAL,TGFFIN.TIMFECHAMENTO AS TIMFECHAMENTO,TGFFIN.TIMFECHAMENTOALU AS TIMFECHAMENTOALU,TGFFIN.TIMFINGARANTORIG AS TIMFINGARANTORIG,TGFFIN.TIMIMOVEL AS TIMIMOVEL,TGFFIN.TIMNEGOCIACAO AS TIMNEGOCIACAO,TGFFIN.TIMNOMEADVOGADO AS TIMNOMEADVOGADO,TGFFIN.TIMNUFINORIG AS TIMNUFINORIG,TGFFIN.TIMNUMREG AS TIMNUMREG,TGFFIN.TIMORIGEM AS TIMORIGEM,TGFFIN.TIMORIGRENEG AS TIMORIGRENEG,TGFFIN.TIMPARCELA AS TIMPARCELA,TGFFIN.TIMRENEGCANCLOTE AS TIMRENEGCANCLOTE,TGFFIN.TIMRENEGIMV AS TIMRENEGIMV,TGFFIN.TIMRENEGLOTE AS TIMRENEGLOTE,TGFFIN.TIMREPINTELIGENTE AS TIMREPINTELIGENTE,TGFFIN.TIMREPPARCIAL AS TIMREPPARCIAL,TGFFIN.TIMRESCISAOLOC AS TIMRESCISAOLOC,TGFFIN.TIMRESCISAOLTV AS TIMRESCISAOLTV,TGFFIN.TIMSAC AS TIMSAC,TGFFIN.TIMTIPOINTERMED AS TIMTIPOINTERMED,TGFFIN.TIMTXADMGERALU AS TIMTXADMGERALU,TGFFIN.TIMVENDAIMV AS TIMVENDAIMV,TGFFIN.TIMVENDALOTE AS TIMVENDALOTE,TGFFIN.TIMVLRAMORTCONTRATO AS TIMVLRAMORTCONTRATO,TGFFIN.TIMVLRCORRMONET AS TIMVLRCORRMONET,TGFFIN.TIMVLRJUROCONTRATO AS TIMVLRJUROCONTRATO,TGFFIN.TIPAPURACAO AS TIPAPURACAO,TGFFIN.TIPJURO AS TIPJURO,TGFFIN.TIPMARCCHEQ AS TIPMARCCHEQ,TGFFIN.TIPMULTA AS TIPMULTA,TGFFIN.TPAGNFCE AS TPAGNFCE,TGFFIN.TROCOPDV AS TROCOPDV,TGFFIN.VALORPRESENTE AS VALORPRESENTE,TGFFIN.VENDAMAIS AS VENDAMAIS,TGFFIN.VLRALIBERAR AS VLRALIBERAR,TGFFIN.VLRBAIXA AS VLRBAIXA,TGFFIN.VLRCESSAO AS VLRCESSAO,TGFFIN.VLRCHEQUE AS VLRCHEQUE,TGFFIN.VLRDESC AS VLRDESC,TGFFIN.VLRDESCCALC AS VLRDESCCALC,TGFFIN.VLRDESCEMBUT AS VLRDESCEMBUT,TGFFIN.VLRDESDOB AS VLRDESDOB,TGFFIN.VLRDESDOBCALC AS VLRDESDOBCALC,TGFFIN.VLRFATCARTAO AS VLRFATCARTAO,TGFFIN.VLRGNREDOIS AS VLRGNREDOIS,TGFFIN.VLRICMSXMLCTE AS VLRICMSXMLCTE,TGFFIN.VLRINSS AS VLRINSS,TGFFIN.VLRIRF AS VLRIRF,TGFFIN.VLRISS AS VLRISS,TGFFIN.VLRJURO AS VLRJURO,TGFFIN.VLRJUROEMBUT AS VLRJUROEMBUT,TGFFIN.VLRJUROLIB AS VLRJUROLIB,TGFFIN.VLRJURONEGOC AS VLRJURONEGOC,TGFFIN.VLRMOEDA AS VLRMOEDA,TGFFIN.VLRMOEDABAIXA AS VLRMOEDABAIXA,TGFFIN.VLRMULTA AS VLRMULTA,TGFFIN.VLRMULTAEMBUT AS VLRMULTAEMBUT,TGFFIN.VLRMULTALIB AS VLRMULTALIB,TGFFIN.VLRMULTANEGOC AS VLRMULTANEGOC,TGFFIN.VLRPROV AS VLRPROV,TGFFIN.VLRVARCAMBIAL AS VLRVARCAMBIAL,TGFFIN.VLRVENDOR AS VLRVENDOR, (
Select TOP 1 CAB.OBSERVACAO from TGFCAB  CAB
INNER JOIN TGFFIN FIN ON FIN.NUNOTA = CAB.NUNOTA 
Where FIN.NUFIN = TGFFIN.NUFIN) AS AD_OBSNOTA, (
		CASE 
          WHEN NUANTBANC IS NOT NULL AND EXISTS(SELECT 1 FROM TGFANB WHERE NUFINTITORI = TGFFIN.NUFIN) THEN 'S'
	      ELSE 'N'
	  END) AS ANTECIPADO, (
CASE 
    WHEN TGFFIN.DTVENC IS NULL THEN 0 
    ELSE
        (CASE 
            WHEN TGFFIN.DHBAIXA IS NOT NULL AND (TGFFIN.VLRBAIXA <> 0 OR TGFFIN.VLRDESC >= TGFFIN.VLRDESDOB) THEN DATEDIFF(DAY , (TGFFIN.DTVENC) , (TGFFIN.DHBAIXA))
            ELSE DATEDIFF(DAY , (CONVERT(date, TGFFIN.DTVENC)) , (CONVERT(date, GETDATE())))
         END)
END) AS ATRASO, (
CASE 
    WHEN TGFFIN.DTVENCINIC IS NULL THEN 0 
    ELSE
        (CASE 
            WHEN TGFFIN.DHBAIXA IS NOT NULL AND TGFFIN.VLRBAIXA <> 0 THEN DATEDIFF(DAY , (TGFFIN.DTVENCINIC) , (TGFFIN.DHBAIXA))
            ELSE DATEDIFF(DAY , (CONVERT(date, TGFFIN.DTVENCINIC)) , (CONVERT(date, GETDATE())))
         END)
END) AS ATRASOINICIAL, ( SELECT PAR.CGC_CPF FROM TGFPAR PAR WHERE PAR.CODPARC = TGFFIN.CODPARC) AS CGC_CPF_PARC, ( SELECT TGFPAR.CHAVEPIX FROM TGFPAR WHERE TGFPAR.CODPARC = TGFFIN.CODPARC) AS CHAVEPIX, ( SELECT CAB.CODOPERACAOVENDAMAIS AS CODOPERACAOVM FROM TGFCABVM CAB, TGFFINVM FIN WHERE TGFFIN.NUFIN = FIN.NUFIN AND FIN.NUNOTA = CAB.NUNOTA) AS CODOPERACAOVENDAMAIS, (
		CASE 
          WHEN 'S' = (SELECT CONCILIADO FROM TGFMBC WHERE TGFMBC.NUBCO = TGFFIN.NUBCO) THEN 'S'
	      ELSE 'N'
	  END) AS CONCILIADO, ( CASE WHEN (SELECT COUNT(*) FROM TCBINT T WHERE T.ORIGEM IN ('F','B') AND T.NUNICO = TGFFIN.NUFIN) > 0 THEN 'S' ELSE 'N' END) AS CONTABILIZADO, ( SELECT CAB.DHAPROVACAO AS DHAPROVACAO FROM TGFCABVM CAB, TGFFINVM FIN WHERE TGFFIN.NUFIN = FIN.NUFIN AND FIN.NUNOTA = CAB.NUNOTA) AS DHAPROVACAOVENDAMAIS, (
		SELECT DHCONCILIACAO FROM TGFMBC WHERE NUBCO = TGFFIN.NUBCO) AS DHCONCIL, (
		CASE 
          WHEN NUANTBANC IS NOT NULL THEN (SELECT DTANTBANC FROM TGFANB WHERE NUANTBANC = TGFFIN.NUANTBANC AND NUFINTITORI = TGFFIN.NUFIN)
	      ELSE NULL
	  END) AS DTANTECIPACAO, ( SELECT P.IDTRANSACAO FROM TGFPIX P WHERE P.NUFIN = TGFFIN.NUFIN AND P.SEQPIX = (SELECT MAX(P2.SEQPIX) FROM TGFPIX P2 WHERE P2.NUFIN = TGFFIN.NUFIN)) AS IDTRANSACAOPIX, ( CASE WHEN ISNULL(TGFFIN.NFCOMPLFIX,0) <> 0 THEN (SELECT CAB.NUMNOTA FROM TGFCAB CAB WHERE CAB.NUNOTA = TGFFIN.NFCOMPLFIX) ELSE NULL END) AS NUMCOMPLFIX, ( CASE WHEN TGFFIN.VLRDESDOB IS NOT NULL AND TGFFIN.VLRDESDOB > 0 THEN(ROUND(TGFFIN.VLRDESC/TGFFIN.VLRDESDOB *100,2)) ELSE 0 END) AS PERCDESC, ( CASE WHEN TGFFIN.DTVENC IS NOT NULL AND TGFFIN.DTNEG IS NOT NULL THEN DATEDIFF(DAY , (TGFFIN.DTNEG) , (TGFFIN.DTVENC)) ELSE NULL END) AS PRAZO, ( CASE WHEN TGFFIN.DTVENCINIC IS NOT NULL AND TGFFIN.DTNEG IS NOT NULL THEN DATEDIFF(DAY , (TGFFIN.DTNEG) , (TGFFIN.DTVENCINIC)) ELSE NULL END) AS PRAZOINICIAL, ( CASE WHEN TGFFIN.NUNOTA IS NOT NULL AND TGFFIN.NUNOTA > 0 THEN(SELECT CAB.RATEADO FROM TGFCAB CAB WHERE CAB.NUNOTA = TGFFIN.NUNOTA) ELSE 'N' END) AS RATEADOCAB, ( CASE WHEN ISNULL(TGFFIN.NFCOMPLFIX,0) <> 0 THEN (SELECT CAB.SERIENOTA FROM TGFCAB CAB WHERE CAB.NUNOTA = TGFFIN.NFCOMPLFIX) ELSE NULL END) AS SERIENOTACOMPL, ( SELECT TGFTIT.SUBTIPOVENDA FROM TGFTIT WHERE TGFTIT.CODTIPTIT = TGFFIN.CODTIPTIT) AS SUBTIPOVENDA, ( ISNULL(TGFFIN.CARTAODESC,0)) AS TAXAVENDAMAIS, ( 
  	CASE WHEN TGFFIN.TIMORIGEM IN ('AL','AV','FC') THEN 
		CASE WHEN TGFFIN.DHBAIXA IS NULL THEN 
			CASE WHEN DATEADD(DAY, DATEDIFF(DAY, 0, TGFFIN.DTVENC), 0) < DATEADD(DAY, DATEDIFF(DAY, 0, GETDATE()), 0) THEN 
				CASE WHEN TGFFIN.TIMDATADEJUR IS NOT NULL THEN 'JurÃ­dico' 
				ELSE 'Atrasado' END 
			ELSE 'Aberto' END	 
		ELSE 'Baixado' END 
	ELSE NULL END) AS TIMESTAGIO, ( 
	CASE WHEN TGFFIN.TIMORIGEM IN ('AL','AV','FC') THEN 
		(SELECT ISNULL(SUM(ISNULL(DTLVALOR, 0)), 0)  
		FROM TIMDTL 
		WHERE DTLPARCELA = TGFFIN.NUFIN 
		AND DTLHISTORICO = ISNULL(( 
			SELECT INTEIRO 
		    FROM TSIPAR 
		    WHERE UPPER(CHAVE) = 'TIMHISTDETLALUG' 
			AND CODUSU = 0 
		),2)) 
	ELSE NULL END) AS TIMVLRALUGUEL, ( CASE WHEN ISNULL(TGFFIN.VLRICMSXMLCTE, 0) = 0 THEN ROUND((ISNULL(TGFFIN.BASEICMS, 0) * ISNULL(TGFFIN.ALIQICMS, 0))/100, 2) ELSE TGFFIN.VLRICMSXMLCTE END) AS VLRICMS, ( TGFFIN.VLRJURO + TGFFIN.VLRMULTA) AS VLRJUROSMAISMULTA, ( (ISNULL(TGFFIN.VLRDESDOB,0) + (CASE WHEN TGFFIN.TIPMULTA = '1' THEN ISNULL(TGFFIN.VLRMULTA,0) ELSE 0 END) + (CASE WHEN TGFFIN.TIPJURO = '1' THEN ISNULL(TGFFIN.VLRJURO,0) ELSE 0 END) + ISNULL(TGFFIN.DESPCART,0) + ISNULL(TGFFIN.VLRVENDOR,0) - ISNULL(TGFFIN.VLRDESC,0) - (CASE WHEN TGFFIN.IRFRETIDO = 'S' THEN ISNULL(TGFFIN.VLRIRF,0) ELSE 0 END) - (CASE WHEN TGFFIN.ISSRETIDO = 'S' THEN ISNULL(TGFFIN.VLRISS,0) ELSE 0 END) - (CASE WHEN TGFFIN.INSSRETIDO = 'S' THEN ISNULL(TGFFIN.VLRINSS,0) ELSE 0 END) - ISNULL(TGFFIN.CARTAODESC,0) + ISNULL((SELECT ROUND(SUM(I.VALOR * I.TIPIMP),2) FROM TGFIMF I WHERE I.NUFIN = TGFFIN.NUFIN),0) + ISNULL(TGFFIN.VLRMULTANEGOC,0) + ISNULL(TGFFIN.VLRJURONEGOC,0) - ISNULL(TGFFIN.VLRMULTALIB,0) - ISNULL(TGFFIN.VLRJUROLIB,0) + ISNULL(TGFFIN.VLRVARCAMBIAL,0)) * ISNULL(TGFFIN.RECDESP,0)) AS VLRLIQUIDO, ( ISNULL(TGFFIN.VLRDESDOB, 0) + ISNULL(TGFFIN.VLRJURO,0) + ISNULL(TGFFIN.VLRMULTA,0) - ISNULL(TGFFIN.VLRDESC,0)) AS VLRTOTALCALC, ( CASE WHEN	TGFFIN.VLRCHEQUE IS NOT NULL AND TGFFIN.VLRCHEQUE <> 0 AND TGFFIN.VLRBAIXA IS NOT NULL THEN	TGFFIN.VLRCHEQUE - CASE WHEN TGFFIN.NUBCO IS NULL THEN TGFFIN.VLRBAIXA ELSE (SELECT SUM(F.VLRBAIXA) FROM TGFFIN F WHERE F.NUBCO = TGFFIN.NUBCO) END	ELSE 0 END) AS VLRTROCO , Banco.NOMEBCO AS l0_NOMEBCO,CentroResultado.DESCRCENCUS AS l1_DESCRCENCUS,ClassificacaoFiscalOperacao.DESCRCFO AS l2_DESCRCFO,CompFinancReinf.CODNATREND AS l3_CODNATREND,CompFinancReinf.SEMIREXT AS l3_SEMIREXT,CompFinancReinf.DTESCRCONT AS l3_DTESCRCONT,CompFinancReinf.TRIBIRRFEXT AS l3_TRIBIRRFEXT,CompFinancReinf.TEMDEDIRPF AS l3_TEMDEDIRPF,CompFinancReinf.CODDEDIRPF AS l3_CODDEDIRPF,CompFinancReinf.VLRDEDBASEIRPF AS l3_VLRDEDBASEIRPF,CompFinancReinf.IRRFISENTO AS l3_IRRFISENTO,CompFinancReinf.TPISENCAO AS l3_TPISENCAO,CompFinancReinf.VLRISENCAOIDADE AS l3_VLRISENCAOIDADE,CompFinancReinf.DTLAUDO AS l3_DTLAUDO,CompFinancReinf.DESCISENCAO AS l3_DESCISENCAO,CadastroNaturezaRendimentos4_1.DESCNATREND AS l4_DESCNATREND,CadastroNaturezaRendimentos4_1.CODNATREND AS l4_CODNATREND,CadastroNaturezaRendimentos4_1.DESCNATREND AS l4_DESCNATREND,CadastroNaturezaRendimentos4_1.FCI AS l4_FCI,CadastroNaturezaRendimentos4_1.DECIMOTERCEIRO AS l4_DECIMOTERCEIRO,CadastroNaturezaRendimentos4_1.RRA AS l4_RRA,CadastroNaturezaRendimentos4_1.DEDUCAO AS l4_DEDUCAO,CadastroNaturezaRendimentos4_1.RENDISENTO AS l4_RENDISENTO,CadastroNaturezaRendimentos4_1.TRIBUTO AS l4_TRIBUTO,CadastroNaturezaRendimentos4_1.BLOCOAPLIC AS l4_BLOCOAPLIC,CadastroNaturezaRendimentos4_1.APLICACAO AS l4_APLICACAO,CadastroNaturezaRendimentos4_1.DTINICIOVAL AS l4_DTINICIOVAL,CadastroNaturezaRendimentos4_1.DTFIMVAL AS l4_DTFIMVAL,CadastroNaturezaRendimentos4_1.ATIVO AS l4_ATIVO,CadastroNaturezaRendimentos4_1.GERSEMTRIB AS l4_GERSEMTRIB,ContaBancaria.DESCRICAO AS l5_DESCRICAO,Contato.NOMECONTATO AS l6_NOMECONTATO,Empresa.NOMEFANTASIA AS l7_NOMEFANTASIA,EmpresaBaixa.NOMEFANTASIA AS l8_NOMEFANTASIA,Funcionario.NOMEFUNC AS l9_NOMEFUNC,ImovelRural.NOMEFANTASIA AS l10_NOMEFANTASIA,ListaServicoSintegra.DESCRLST AS l11_DESCRLST,Moeda.NOMEMOEDA AS l12_NOMEMOEDA,Natureza.DESCRNAT AS l13_DESCRNAT,ObservacaoNotasFiscais.OBSERVACAO AS l14_OBSERVACAO,Parceiro.NOMEPARC AS l15_NOMEPARC,UnidadeFederativa16_2.UF AS l16_UF,PixTEF.SEQPIXTEF AS l17_SEQPIXTEF,Projeto.IDENTIFICACAO AS l18_IDENTIFICACAO,ReceitaDarf.DESCRRECEITA AS l19_DESCRRECEITA,TEF.REDE AS l20_REDE,TEF.TIPODOC AS l20_TIPODOC,TEF.NUMCV AS l20_NUMCV,TEF.NUMDOC AS l20_NUMDOC,TEF.NUMPV AS l20_NUMPV,TEF.DESDOBRAMENTO AS l20_DESDOBRAMENTO,TEF.DTTRANSACAO AS l20_DTTRANSACAO,TEF.VLRTRANSACAO AS l20_VLRTRANSACAO,TEF.VLRTAXA AS l20_VLRTAXA,TEF.BANDEIRA AS l20_BANDEIRA,TEF.CONFIRMADO AS l20_CONFIRMADO,TEF.CODUSU AS l20_CODUSU,TEF.PROCESSO AS l20_PROCESSO,TEF.COMPROVANTE AS l20_COMPROVANTE,TEF.IDENTIFICACAOTEF AS l20_IDENTIFICACAOTEF,TEF.OPERACAOTEF AS l20_OPERACAOTEF,TEF.AUTORIZACAO AS l20_AUTORIZACAO,TEF.NUMNSU AS l20_NUMNSU,TEF.NOMEREDE AS l20_NOMEREDE,TimContaBancaria.DESCRICAO AS l21_DESCRICAO,TimImovel.IMVDESCRICAO AS l22_IMVDESCRICAO,TimTipoIntermed.TINDESCRICAO AS l23_TINDESCRICAO,TipoOperacao.DESCROPER AS l24_DESCROPER,TipoOperacao.TIPMOV AS l24_TIPMOV,TipoOperacaoBaixa.DESCROPER AS l25_DESCROPER,TipoTitulo.DESCRTIPTIT AS l26_DESCRTIPTIT,TipoTitulo.INFCMC7 AS l26_INFCMC7,Usuario.NOMEUSU AS l27_NOMEUSU,Usuario2.NOMEUSU AS l28_NOMEUSU,UsuarioBaixa.NOMEUSU AS l29_NOMEUSU,Vendedor.APELIDO AS l30_APELIDO FROM TGFFIN  WITH (NOLOCK)    left join TSIBCO Banco (nolock)  ON(TGFFIN.CODBCO = Banco.CODBCO) left join TSICUS CentroResultado (nolock)  ON(TGFFIN.CODCENCUS = CentroResultado.CODCENCUS) left join TGFCFO ClassificacaoFiscalOperacao (nolock)  ON(TGFFIN.CODCFO = ClassificacaoFiscalOperacao.CODCFO) left join TGFRNF CompFinancReinf (nolock)  ON(TGFFIN.NUFIN = CompFinancReinf.NUFIN) left join TGFNRR CadastroNaturezaRendimentos4_1 (nolock)  ON(CompFinancReinf.CODNATREND = CadastroNaturezaRendimentos4_1.CODNATREND) left join TSICTA ContaBancaria (nolock)  ON(TGFFIN.CODCTABCOINT = ContaBancaria.CODCTABCOINT) left join TGFCTT Contato (nolock)  ON(TGFFIN.CODPARC = Contato.CODPARC AND TGFFIN.CODCONTATO = Contato.CODCONTATO) left join TSIEMP Empresa (nolock)  ON(TGFFIN.CODEMP = Empresa.CODEMP) left join TSIEMP EmpresaBaixa (nolock)  ON(TGFFIN.CODEMPBAIXA = EmpresaBaixa.CODEMP) left join TFPFUN Funcionario (nolock)  ON(TGFFIN.CODEMP = Funcionario.CODEMP AND TGFFIN.CODFUNC = Funcionario.CODFUNC) left join TSIEMP ImovelRural (nolock)  ON(TGFFIN.CODIMOVELRURAL = ImovelRural.CODEMP) left join TGFLST ListaServicoSintegra (nolock)  ON(TGFFIN.CODLST = ListaServicoSintegra.CODLST) left join TSIMOE Moeda (nolock)  ON(TGFFIN.CODMOEDA = Moeda.CODMOEDA) left join TGFNAT Natureza (nolock)  ON(TGFFIN.CODNAT = Natureza.CODNAT) left join TGFOBS ObservacaoNotasFiscais (nolock)  ON(TGFFIN.CODOBSPADRAO = ObservacaoNotasFiscais.CODOBSPADRAO) left join TGFPAR Parceiro (nolock)  ON(TGFFIN.CODPARC = Parceiro.CODPARC) left join TSICID Cidade16_1 (nolock)  ON(Parceiro.CODCID = Cidade16_1.CODCID) left join TSIUFS UnidadeFederativa16_2 (nolock)  ON(Cidade16_1.UF = UnidadeFederativa16_2.CODUF) left join TGFPIXTEF PixTEF (nolock)  ON(TGFFIN.PIXTEF = PixTEF.SEQPIXTEF) left join TCSPRJ Projeto (nolock)  ON(TGFFIN.CODPROJ = Projeto.CODPROJ) left join TGFRDARF ReceitaDarf (nolock)  ON(TGFFIN.CODRECEITA = ReceitaDarf.CODRECEITA) left join TGFTEF TEF (nolock)  ON(TGFFIN.NUFIN = TEF.NUFIN) left join TSICTA TimContaBancaria (nolock)  ON(TGFFIN.TIMCONTALANC = TimContaBancaria.CODCTABCOINT) left join TIMIMV TimImovel (nolock)  ON(TGFFIN.TIMIMOVEL = TimImovel.IMVCODIGO) left join TIMTIN TimTipoIntermed (nolock)  ON(TGFFIN.TIMTIPOINTERMED = TimTipoIntermed.TINCODIGO) left join TGFTOP TipoOperacao (nolock)  ON(TGFFIN.CODTIPOPER = TipoOperacao.CODTIPOPER AND TGFFIN.DHTIPOPER = TipoOperacao.DHALTER) left join TGFTOP TipoOperacaoBaixa (nolock)  ON(TGFFIN.CODTIPOPERBAIXA = TipoOperacaoBaixa.CODTIPOPER AND TGFFIN.DHTIPOPERBAIXA = TipoOperacaoBaixa.DHALTER) left join TGFTIT TipoTitulo (nolock)  ON(TGFFIN.CODTIPTIT = TipoTitulo.CODTIPTIT) left join TSIUSU Usuario (nolock)  ON(TGFFIN.CODUSU = Usuario.CODUSU) left join TSIUSU Usuario2 (nolock)  ON(TGFFIN.TIMREPINTELIGENTE = Usuario2.CODUSU) left join TSIUSU UsuarioBaixa (nolock)  ON(TGFFIN.CODUSUBAIXA = UsuarioBaixa.CODUSU) left join TGFVEN Vendedor (nolock)  ON(TGFFIN.CODVEND = Vendedor.CODVEND)   WHERE ((((TGFFIN.RECDESP = 1 ) AND TGFFIN.PROVISAO = 'N' AND (TGFFIN.DHBAIXA IS NULL) AND  NOT (TGFFIN.PROVISAO = 'S' AND TGFFIN.DHBAIXA IS NOT NULL AND TGFFIN.ORIGEM = 'E')))) 

