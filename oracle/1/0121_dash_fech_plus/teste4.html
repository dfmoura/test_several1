<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tabela ERP Sankhya ‚Äî Exportar Excel</title>
  <style>
    :root{
      --primary:#0b6fb2;
      --primary-700:#095b95;
      --muted:#6b7280;
      --bg:#f6f7f9;
      --card:#ffffff;
      --border:#e6e9ee;
      --danger:#d9534f;
      --success:#28a745;
      --radius:8px;
      --font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    *{box-sizing:border-box}
    body{font-family:var(--font-family);margin:16px;background:var(--bg);color:#222}
    .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);box-shadow:0 1px 3px rgba(15,23,42,0.04);overflow:hidden}
    .card-header{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid var(--border)}
    .title{display:flex;gap:12px;align-items:center}
    .brand-dot{width:36px;height:36px;border-radius:6px;background:linear-gradient(180deg,var(--primary),var(--primary-700));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:600}
    .title h2{font-size:16px;margin:0}
    .subtitle{color:var(--muted);font-size:13px}
    .toolbar{display:flex;gap:8px;align-items:center}
    .btn{background:transparent;border:1px solid var(--border);padding:8px 10px;border-radius:6px;font-size:13px;cursor:pointer;transition:background .2s}
    .btn.primary{background:var(--primary);border-color:var(--primary);color:#fff}
    .btn:hover{background:#f0f3f8}
    .btn.primary:hover{background:var(--primary-700)}
    .search{display:flex;align-items:center;border:1px solid var(--border);padding:6px 8px;border-radius:6px;background:#fff}
    .search input{border:0;outline:0;font-size:13px;background:transparent}
    .table-wrap{overflow:auto}
    table{width:100%;border-collapse:collapse;font-size:13px}
    thead th{position:sticky;top:0;background:#fff;padding:10px 12px;text-align:left;border-bottom:1px solid var(--border);z-index:2;cursor:pointer}
    tbody tr{transition:background .12s}
    tbody tr:hover{background:#f3f7fb}
    td{padding:10px 12px;border-bottom:1px solid #f1f3f6;vertical-align:middle}
    .badge{display:inline-block;padding:4px 8px;border-radius:999px;font-size:12px;border:1px solid rgba(0,0,0,0.06)}
    .badge.success{color:var(--success);border-color:rgba(40,167,69,0.12)}
    .badge.warn{color:#d98200;border-color:rgba(217,138,0,0.12)}
    .actions{display:flex;gap:6px}
    .icon-btn{width:34px;height:34px;border-radius:6px;border:1px solid var(--border);display:inline-flex;align-items:center;justify-content:center;cursor:pointer;background:transparent}
    .footer{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-top:1px solid var(--border);gap:12px}
    .pager{display:flex;gap:6px;align-items:center}
    .select{padding:6px;border-radius:6px;border:1px solid var(--border);font-size:13px}
    .muted{color:var(--muted);font-size:13px}
  </style>
</head>
<body>
  <div class="card" style="max-width:1200px;margin:0 auto">
    <div class="card-header">
      <div class="title">
        <div class="brand-dot">SK</div>
        <div>
          <h2>Tabela de Itens</h2>
          <div class="subtitle">Padr√£o visual ERP Sankhya ‚Äî com Exportar Excel</div>
        </div>
      </div>
      <div class="toolbar">
        <div class="search">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="margin-right:6px"><path d="M21 21l-4.35-4.35" stroke="#8b9099" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><circle cx="11" cy="11" r="6" stroke="#8b9099" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
          <input id="globalSearch" placeholder="Pesquisar (c√≥digo, descri√ß√£o, n. s√©rie)" />
        </div>
        <button class="btn" id="btn-filter">Filtros</button>
        <button class="btn primary" id="btn-new">Novo</button>
        <button class="btn" id="btn-export">Exportar Excel</button>
      </div>
    </div>

    <div class="table-wrap">
      <table id="mainTable">
        <thead>
          <tr>
            <th><input type="checkbox" id="selectAll"/></th>
            <th data-key="codigo">C√≥digo</th>
            <th data-key="descricao">Descri√ß√£o</th>
            <th data-key="local">Local</th>
            <th data-key="quantidade">Quantidade</th>
            <th data-key="nserie">N. S√©rie</th>
            <th data-key="status">Status</th>
            <th>A√ß√µes</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </div>

    <div class="footer">
      <div class="muted" id="infoRange">0‚Äì0 de 0</div>
      <div class="pager">
        <button class="btn" id="prev">‚Äπ</button>
        <div id="pageNums" class="muted">1</div>
        <button class="btn" id="next">‚Ä∫</button>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    const sample = [];
    for(let i=1;i<=100;i++){
      sample.push({
        id:i,
        codigo:'IT'+String(i).padStart(4,'0'),
        descricao:'Produto '+i,
        local:['Armaz√©m','Dep√≥sito','Loja'][i%3],
        quantidade:Math.floor(Math.random()*1000),
        nserie:(Math.random()>0.7)?'SN-'+i:'' ,
        status:(i%2)?'Dispon√≠vel':'Reservado'
      })
    }

    let state={data:sample,q:'',page:1,pageSize:10}

    function render(){
      const q=state.q.toLowerCase()
      const filtered=state.data.filter(r=>r.codigo.toLowerCase().includes(q)||r.descricao.toLowerCase().includes(q))
      const total=filtered.length
      const start=(state.page-1)*state.pageSize
      const pageData=filtered.slice(start,start+state.pageSize)
      const tbody=document.getElementById('tbody')
      tbody.innerHTML=''
      pageData.forEach(r=>{
        const tr=document.createElement('tr')
        tr.innerHTML=`<td><input type='checkbox'/></td>
          <td>${r.codigo}</td><td>${r.descricao}</td><td>${r.local}</td><td style='text-align:right'>${r.quantidade}</td><td>${r.nserie||'‚Äî'}</td>
          <td>${r.status==='Dispon√≠vel'?'<span class="badge success">Dispon√≠vel</span>':'<span class="badge warn">Reservado</span>'}</td>
          <td><div class='actions'><button class='icon-btn' data-id='${r.id}'>üëÅÔ∏è</button></div></td>`
        tbody.appendChild(tr)
      })
      document.getElementById('infoRange').textContent=`${start+1}‚Äì${Math.min(start+state.pageSize,total)} de ${total}`
      document.getElementById('pageNums').textContent=`${state.page}`
    }

    document.getElementById('globalSearch').addEventListener('input',e=>{state.q=e.target.value;state.page=1;render()})
    document.getElementById('prev').addEventListener('click',()=>{if(state.page>1){state.page--;render()}})
    document.getElementById('next').addEventListener('click',()=>{state.page++;render()})

    document.getElementById('btn-new').addEventListener('click',()=>{
      const id=state.data.length+1
      state.data.unshift({id:id,codigo:'IT'+String(id).padStart(4,'0'),descricao:'Novo produto '+id,local:'Armaz√©m',quantidade:0,nserie:'',status:'Dispon√≠vel'})
      render()
    })

    // Exportar Excel (padr√£o Sankhya usa Excel xlsx)
    document.getElementById('btn-export').addEventListener('click',()=>{
      const header=['C√≥digo','Descri√ß√£o','Local','Quantidade','N. S√©rie','Status']
      const rows=state.data.map(r=>[r.codigo,r.descricao,r.local,r.quantidade,r.nserie,r.status])
      const ws=XLSX.utils.aoa_to_sheet([header,...rows])
      const wb=XLSX.utils.book_new()
      XLSX.utils.book_append_sheet(wb,ws,'Itens')
      XLSX.writeFile(wb,'itens_erp_sankhya.xlsx')
    })

    render()
  </script>
</body>
</html>
