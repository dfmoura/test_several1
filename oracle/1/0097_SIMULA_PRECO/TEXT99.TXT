SELECT 
  CODEMP,
  PROD,
  CODPROD,
  DESCRPROD,
  MARCA,
  CODGRUPOPROD,
  DESCRGRUPOPROD,
  ROUND(SUM(QTD) / SUM(SUM(QTD)) OVER (PARTITION BY MARCA), 4) AS POND_MARCA
FROM VGF_VENDAS_SATIS
WHERE DTNEG >= ADD_MONTHS('01/06/2025', -12)
  AND DTNEG < '01/06/2025'
  AND CODEMP = 1
  AND CODPARC = 312
GROUP BY 
  CODEMP,
  PROD,
  CODPROD,
  DESCRPROD,
  MARCA,
  CODGRUPOPROD,
  DESCRGRUPOPROD