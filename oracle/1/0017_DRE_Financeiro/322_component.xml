<gadget>
  <prompt-parameters>
    <parameter id="P_PERIODO" description="Periodo Baixa" metadata="datePeriod" required="false" keep-last="true" keep-date="false" order="0"/>
  </prompt-parameters>
  <level id="lvl_ab1c0i5" description="Principal">
    <container orientacao="V" tamanhoRelativo="100">
      <container orientacao="H" tamanhoRelativo="100">
        <container orientacao="V" tamanhoRelativo="103">
          <simple-value id="svl_achd42l">
            <value-expression><![CDATA[<div style='text-align: center;'><img src="https://static.wixstatic.com/media/220800_25bd148b8f0f476b89717fbfd409f5c8~mv2.png/v1/fill/w_167,h_167,al_c,q_85,usm_0.66_1.00_0.01,enc_auto/Favicon.png" width="100" height="65" /></div>]]></value-expression>
          </simple-value>
        </container>
        <container orientacao="V" tamanhoRelativo="315">
          <html5component id="html5_achd400" entryPoint="cabecalho.jsp"/>
        </container>
        <container orientacao="V" tamanhoRelativo="106">
          <simple-value id="svl_achd44h">
            <expression type="sql" data-source="MGEDS"><![CDATA[SELECT SYSDATE FROM DUAL]]></expression>
            <metadata>
              <field name="SYSDATE" label="SYSDATE" type="D" visible="true" useFooter="false" mask="EEEEE, D MMMMM YYYY HH:NN:SS"/>
            </metadata>
            <value-expression><![CDATA[<pre><span style='color: #FF0000; font-size: 14px;'><b><marquee>$SYSDATE</marquee></b></span><span style='color: #FF0E0D;'></span></pre>]]></value-expression>
          </simple-value>
        </container>
      </container>
      <container orientacao="V" tamanhoRelativo="600">
        <grid id="grd_ab1c0i6" useNewGrid="S">
          <expression type="sql" data-source="MGEDS"><![CDATA[WITH B AS (SELECT * FROM (SELECT LPAD(CODIGO, 10, '0') AS CODIGO, GRAU,ANALITICO,DESCRICAO FROM AD_DREGERFIN))SELECTDRE3.GRAU AS CODIGO,B.DESCRICAO,DRE3.VALOR,CASE WHEN B.GRAU = 1 THEN '#8EA9DB' WHEN B.GRAU = 2 THEN '#c6d4ed'WHEN B.GRAU = 3 THEN '#dde5f4'WHEN B.GRAU = 4 THEN '#e8f5cc'WHEN B.GRAU = 5 THEN '#f0eaf5'END AS BKCOLORFROM(/*GRAU1*/SELECTSUBSTR(LPAD(CODIGO, 10, '0'), 1, 2)||'00000000' AS GRAU,SUM(VALOR) AS VALORFROM (WITH DRE AS(SELECT DRE1.CODIGO,DRE1.DESCRICAO,DRE1.AD_TPPROD,DRE1.TIPMOVFROM AD_DREGERFIN DRE1)SELECTDRE.CODIGO,DRE.DESCRICAO,SUM(CASE WHEN CAB.TIPMOV = 'D' THEN (ITE.VLRTOT + ITE.VLRIPI + ITE.VLRSUBST - ITE.VLRDESC) * -1 ELSE (ITE.VLRTOT + ITE.VLRIPI + ITE.VLRSUBST - ITE.VLRDESC) END) AS VALORFROM TGFCAB CABINNER JOIN TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTAINNER JOIN TGFTOP TOP ON CAB.CODTIPOPER = TOP.CODTIPOPER AND TOP.DHALTER = (SELECT MAX(DHALTER) FROM TGFTOP WHERE CODTIPOPER = CAB.CODTIPOPER)INNER JOIN TGFPRO PRO ON ITE.CODPROD = PRO.CODPRODINNER JOIN DRE ON (PRO.AD_TPPROD = DRE.AD_TPPROD OR DRE.AD_TPPROD = 7) AND (CAB.TIPMOV = DRE.TIPMOV OR DRE.TIPMOV = 'A')WHERE TOP.GOLSINAL = -1AND (CAB.DTNEG BETWEEN :P_PERIODO.INI AND  :P_PERIODO.FIN)/*AND (CAB.CODEMP IN :P_EMPRESA)*/AND TOP.TIPMOV IN ('V', 'D')AND TOP.ATIVO = 'S'AND PRO.AD_TPPROD IS NOT NULLGROUP BYDRE.CODIGO,DRE.DESCRICAOUNION ALLSELECTDRE1.CODIGO,DRE1.DESCRICAO,SUM(RES.VLRBAIXA) AS VALORFROM VGF_RESULTADO_GM RESINNER JOIN AD_DREGERFINDETALHE DRE2 ON RES.CODNAT = DRE2.CODNATINNER JOIN AD_DREGERFIN DRE1 ON DRE2.CODIGO = DRE1.CODIGOWHERE(RES.DHBAIXA BETWEEN :P_PERIODO.INI AND  :P_PERIODO.FIN)GROUP BYDRE1.CODIGO,DRE1.DESCRICAO)GROUP BYSUBSTR(LPAD(CODIGO, 10, '0'), 1, 2)||'00000000'UNION ALL/*GRAU2*/SELECTSUBSTR(LPAD(CODIGO, 10, '0'), 1, 4)||'000000' AS GRAU,SUM(VALOR) AS VALORFROM (WITH DRE AS(SELECT DRE1.CODIGO,DRE1.DESCRICAO,DRE1.AD_TPPROD,DRE1.TIPMOVFROM AD_DREGERFIN DRE1)SELECTDRE.CODIGO,DRE.DESCRICAO,SUM(CASE WHEN CAB.TIPMOV = 'D' THEN (ITE.VLRTOT + ITE.VLRIPI + ITE.VLRSUBST - ITE.VLRDESC) * -1 ELSE (ITE.VLRTOT + ITE.VLRIPI + ITE.VLRSUBST - ITE.VLRDESC) END) AS VALORFROM TGFCAB CABINNER JOIN TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTAINNER JOIN TGFTOP TOP ON CAB.CODTIPOPER = TOP.CODTIPOPER AND TOP.DHALTER = (SELECT MAX(DHALTER) FROM TGFTOP WHERE CODTIPOPER = CAB.CODTIPOPER)INNER JOIN TGFPRO PRO ON ITE.CODPROD = PRO.CODPRODINNER JOIN DRE ON (PRO.AD_TPPROD = DRE.AD_TPPROD OR DRE.AD_TPPROD = 7) AND (CAB.TIPMOV = DRE.TIPMOV OR DRE.TIPMOV = 'A')WHERE TOP.GOLSINAL = -1AND (CAB.DTNEG BETWEEN :P_PERIODO.INI AND  :P_PERIODO.FIN)/*AND (CAB.CODEMP IN :P_EMPRESA)*/AND TOP.TIPMOV IN ('V', 'D')AND TOP.ATIVO = 'S'AND PRO.AD_TPPROD IS NOT NULLGROUP BYDRE.CODIGO,DRE.DESCRICAOUNION ALLSELECTDRE1.CODIGO,DRE1.DESCRICAO,SUM(RES.VLRBAIXA) AS VALORFROM VGF_RESULTADO_GM RESINNER JOIN AD_DREGERFINDETALHE DRE2 ON RES.CODNAT = DRE2.CODNATINNER JOIN AD_DREGERFIN DRE1 ON DRE2.CODIGO = DRE1.CODIGOWHERE(RES.DHBAIXA BETWEEN :P_PERIODO.INI AND  :P_PERIODO.FIN)GROUP BYDRE1.CODIGO,DRE1.DESCRICAO)GROUP BYSUBSTR(LPAD(CODIGO, 10, '0'), 1, 4)||'000000'UNION ALL/*GRAU3*/SELECTSUBSTR(LPAD(CODIGO, 10, '0'), 1, 6)||'0000' AS GRAU,SUM(VALOR) AS VALORFROM (WITH DRE AS(SELECT DRE1.CODIGO,DRE1.DESCRICAO,DRE1.AD_TPPROD,DRE1.TIPMOVFROM AD_DREGERFIN DRE1)SELECTDRE.CODIGO,DRE.DESCRICAO,SUM(CASE WHEN CAB.TIPMOV = 'D' THEN (ITE.VLRTOT + ITE.VLRIPI + ITE.VLRSUBST - ITE.VLRDESC) * -1 ELSE (ITE.VLRTOT + ITE.VLRIPI + ITE.VLRSUBST - ITE.VLRDESC) END) AS VALORFROM TGFCAB CABINNER JOIN TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTAINNER JOIN TGFTOP TOP ON CAB.CODTIPOPER = TOP.CODTIPOPER AND TOP.DHALTER = (SELECT MAX(DHALTER) FROM TGFTOP WHERE CODTIPOPER = CAB.CODTIPOPER)INNER JOIN TGFPRO PRO ON ITE.CODPROD = PRO.CODPRODINNER JOIN DRE ON (PRO.AD_TPPROD = DRE.AD_TPPROD OR DRE.AD_TPPROD = 7) AND (CAB.TIPMOV = DRE.TIPMOV OR DRE.TIPMOV = 'A')WHERE TOP.GOLSINAL = -1AND (CAB.DTNEG BETWEEN :P_PERIODO.INI AND  :P_PERIODO.FIN)/*AND (CAB.CODEMP IN :P_EMPRESA)*/AND TOP.TIPMOV IN ('V', 'D')AND TOP.ATIVO = 'S'AND PRO.AD_TPPROD IS NOT NULLGROUP BYDRE.CODIGO,DRE.DESCRICAOUNION ALLSELECTDRE1.CODIGO,DRE1.DESCRICAO,SUM(RES.VLRBAIXA) AS VALORFROM VGF_RESULTADO_GM RESINNER JOIN AD_DREGERFINDETALHE DRE2 ON RES.CODNAT = DRE2.CODNATINNER JOIN AD_DREGERFIN DRE1 ON DRE2.CODIGO = DRE1.CODIGOWHERE(RES.DHBAIXA BETWEEN :P_PERIODO.INI AND  :P_PERIODO.FIN)GROUP BYDRE1.CODIGO,DRE1.DESCRICAO)GROUP BYSUBSTR(LPAD(CODIGO, 10, '0'), 1, 6)||'0000'UNION ALL/*GRAU4*/SELECTSUBSTR(LPAD(CODIGO, 10, '0'), 1, 8)||'00' AS GRAU,SUM(VALOR) AS VALORFROM (WITH DRE AS(SELECT DRE1.CODIGO,DRE1.DESCRICAO,DRE1.AD_TPPROD,DRE1.TIPMOVFROM AD_DREGERFIN DRE1)SELECTDRE.CODIGO,DRE.DESCRICAO,SUM(CASE WHEN CAB.TIPMOV = 'D' THEN (ITE.VLRTOT + ITE.VLRIPI + ITE.VLRSUBST - ITE.VLRDESC) * -1 ELSE (ITE.VLRTOT + ITE.VLRIPI + ITE.VLRSUBST - ITE.VLRDESC) END) AS VALORFROM TGFCAB CABINNER JOIN TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTAINNER JOIN TGFTOP TOP ON CAB.CODTIPOPER = TOP.CODTIPOPER AND TOP.DHALTER = (SELECT MAX(DHALTER) FROM TGFTOP WHERE CODTIPOPER = CAB.CODTIPOPER)INNER JOIN TGFPRO PRO ON ITE.CODPROD = PRO.CODPRODINNER JOIN DRE ON (PRO.AD_TPPROD = DRE.AD_TPPROD OR DRE.AD_TPPROD = 7) AND (CAB.TIPMOV = DRE.TIPMOV OR DRE.TIPMOV = 'A')WHERE TOP.GOLSINAL = -1AND (CAB.DTNEG BETWEEN :P_PERIODO.INI AND  :P_PERIODO.FIN)/*AND (CAB.CODEMP IN :P_EMPRESA)*/AND TOP.TIPMOV IN ('V', 'D')AND TOP.ATIVO = 'S'AND PRO.AD_TPPROD IS NOT NULLGROUP BYDRE.CODIGO,DRE.DESCRICAOUNION ALLSELECTDRE1.CODIGO,DRE1.DESCRICAO,SUM(RES.VLRBAIXA) AS VALORFROM VGF_RESULTADO_GM RESINNER JOIN AD_DREGERFINDETALHE DRE2 ON RES.CODNAT = DRE2.CODNATINNER JOIN AD_DREGERFIN DRE1 ON DRE2.CODIGO = DRE1.CODIGOWHERE(RES.DHBAIXA BETWEEN :P_PERIODO.INI AND  :P_PERIODO.FIN)GROUP BYDRE1.CODIGO,DRE1.DESCRICAO)GROUP BYSUBSTR(LPAD(CODIGO, 10, '0'), 1, 8)||'00'UNION ALL/*GRAU5*/SELECTSUBSTR(LPAD(CODIGO, 10, '0'), 1, 10) AS GRAU,SUM(VALOR) AS VALORFROM (WITH DRE AS(SELECT DRE1.CODIGO,DRE1.DESCRICAO,DRE1.AD_TPPROD,DRE1.TIPMOVFROM AD_DREGERFIN DRE1)SELECTDRE.CODIGO,DRE.DESCRICAO,SUM(CASE WHEN CAB.TIPMOV = 'D' THEN (ITE.VLRTOT + ITE.VLRIPI + ITE.VLRSUBST - ITE.VLRDESC) * -1 ELSE (ITE.VLRTOT + ITE.VLRIPI + ITE.VLRSUBST - ITE.VLRDESC) END) AS VALORFROM TGFCAB CABINNER JOIN TGFITE ITE ON CAB.NUNOTA = ITE.NUNOTAINNER JOIN TGFTOP TOP ON CAB.CODTIPOPER = TOP.CODTIPOPER AND TOP.DHALTER = (SELECT MAX(DHALTER) FROM TGFTOP WHERE CODTIPOPER = CAB.CODTIPOPER)INNER JOIN TGFPRO PRO ON ITE.CODPROD = PRO.CODPRODINNER JOIN DRE ON (PRO.AD_TPPROD = DRE.AD_TPPROD OR DRE.AD_TPPROD = 7) AND (CAB.TIPMOV = DRE.TIPMOV OR DRE.TIPMOV = 'A')WHERE TOP.GOLSINAL = -1AND (CAB.DTNEG BETWEEN :P_PERIODO.INI AND  :P_PERIODO.FIN)/*AND (CAB.CODEMP IN :P_EMPRESA)*/AND TOP.TIPMOV IN ('V', 'D')AND TOP.ATIVO = 'S'AND PRO.AD_TPPROD IS NOT NULLGROUP BYDRE.CODIGO,DRE.DESCRICAOUNION ALLSELECTDRE1.CODIGO,DRE1.DESCRICAO,SUM(RES.VLRBAIXA) AS VALORFROM VGF_RESULTADO_GM RESINNER JOIN AD_DREGERFINDETALHE DRE2 ON RES.CODNAT = DRE2.CODNATINNER JOIN AD_DREGERFIN DRE1 ON DRE2.CODIGO = DRE1.CODIGOWHERE(RES.DHBAIXA BETWEEN :P_PERIODO.INI AND :P_PERIODO.FIN)GROUP BYDRE1.CODIGO,DRE1.DESCRICAO)GROUP BYSUBSTR(LPAD(CODIGO, 10, '0'), 1, 10)) DRE3INNER JOIN B ON DRE3.GRAU = B.CODIGOGROUP BYDRE3.GRAU,B.DESCRICAO,B.GRAU,DRE3.VALORORDER BY 1]]></expression>
          <metadata>
            <field name="CODIGO" label="Código" type="S" visible="true" useFooter="false"/>
            <field name="DESCRICAO" label="Descrição" type="S" visible="true" useFooter="false"/>
            <field name="VALOR" label="Valor" type="F" visible="true" useFooter="false" mask="#.##0,00"/>
            <field name="BKCOLOR" label="BKCOLOR" type="S" visible="true" useFooter="false"/>
          </metadata>
        </grid>
      </container>
    </container>
  </level>
</gadget>