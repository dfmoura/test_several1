<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extrair Dados XML</title>

    
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        h1 {
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        tr:hover {
            background-color: #ddd;
        }
    </style>
</head>
<body>
    <h1>Dados da NFe</h1>
    <table id="nfeTable">
        <thead>
            <tr>
                <th>Item</th>
                <th>NCM</th>
                <th>Código do Produto</th>
                <th>Produto</th>
                <th>Un. Trib.</th>
                <th>Quantidade</th>
                <th>Valor Unitário</th>
                <th>Valor Total</th>
                <th>CST</th>
            </tr>
        </thead>
        <tbody>
            <!-- Os dados serão inseridos aqui via JavaScript -->
        </tbody>
    </table>

    <script>
document.addEventListener("DOMContentLoaded", function() {
    const xmlString = `
    
                
            <NFe xmlns="http://www.portalfiscal.inf.br/nfe"><infNFe Id="NFe31220402677655000124550010000120151764976773" versao="4.00"><ide><cUF>31</cUF><cNF>76497677</cNF><natOp>Vda prod do estab</natOp><mod>55</mod><serie>1</serie><nNF>12015</nNF><dhEmi>2022-04-07T15:31:44-03:00</dhEmi><dhSaiEnt>2022-04-07T15:31:44-03:00</dhSaiEnt><tpNF>1</tpNF><idDest>1</idDest><cMunFG>3104007</cMunFG><tpImp>2</tpImp><tpEmis>1</tpEmis><cDV>3</cDV><tpAmb>1</tpAmb><finNFe>1</finNFe><indFinal>1</indFinal><indPres>0</indPres><procEmi>0</procEmi><verProc>4.10b170</verProc></ide><emit><CNPJ>02677655000124</CNPJ><xNome>SATIS INDUSTRIA E COMERCIO LTDA</xNome><xFant>SATIS ARAXA</xFant><enderEmit><xLgr>Rua IMBIARA</xLgr><nro>500</nro><xBairro>DISTRITO INDUSTRIAL JOSE HONORATO DA SILVA</xBairro><cMun>3104007</cMun><xMun>Araxa</xMun><UF>MG</UF><CEP>38180315</CEP><cPais>1058</cPais><xPais>Brasil</xPais><fone>3436644715</fone></enderEmit><IE>0409944630007</IE><CRT>3</CRT></emit><dest><CPF>12623201609</CPF><xNome>MARCOS CALEBE DE PAULA e outro(s)</xNome><enderDest><xLgr>Acamp CORREGO FUNDO</xLgr><nro>S/N</nro><xBairro>FAZENDA LAGOINHA</xBairro><cMun>3104007</cMun><xMun>Araxa</xMun><UF>MG</UF><CEP>38184999</CEP><cPais>1058</cPais><xPais>Brasil</xPais><fone>34992373047</fone></enderDest><indIEDest>2</indIEDest><email>mcmarcoscalebe@hotmail.com-pollux.financeiro2021@gmail.com</email></dest><det nItem="1"><prod><cProd>2</cProd><cEAN>7899478701785</cEAN><xProd>FULLAND BB 5L</xProd><NCM>31059090</NCM><cBenef>00RS052162</cBenef><CFOP>5101</CFOP><uCom>UN</uCom><qCom>1</qCom><vUnCom>305.004</vUnCom><vProd>305.00</vProd><cEANTrib>7899478701785</cEANTrib><uTrib>UN</uTrib><qTrib>1</qTrib><vUnTrib>305.004</vUnTrib><indTot>1</indTot><xPed>27</xPed><nItemPed>1</nItemPed></prod><imposto><ICMS><ICMS20><orig>0</orig><CST>20</CST><modBC>3</modBC><pRedBC>94.4400</pRedBC><vBC>16.96</vBC><pICMS>18.00</pICMS><vICMS>3.05</vICMS></ICMS20></ICMS><IPI><cEnq>999</cEnq><IPITrib><CST>99</CST><vBC>0.00</vBC><pIPI>0.00</pIPI><vIPI>0.00</vIPI></IPITrib></IPI><PIS><PISNT><CST>06</CST></PISNT></PIS><COFINS><COFINSNT><CST>06</CST></COFINSNT></COFINS></imposto><infAdProd>Lote: OP23709 D.Fab: 04/04/22 D.Val: 18/03/25 | MG 001650-0.000003 - FERTILIZANTE MINERAL SIMPLES (FOSFITO DE COBRE) - MODO APLICACAO: VIA FOLIAR/FERTIRRIGACAO - GARANTIA(S): Cu 3,5% (Nutriente soluvel em agua). Densidade: 1,34g/ml. Maior relacao soluto/solvente: 5,0 ml/l. Nat.Fisica: Solucao</infAdProd></det><det nItem="2"><prod><cProd>3</cProd><cEAN>7899478701778</cEAN><xProd>FULLAND BD 20L</xProd><NCM>31059090</NCM><cBenef>00RS052162</cBenef><CFOP>5101</CFOP><uCom>UN</uCom><qCom>1</qCom><vUnCom>1179.996</vUnCom><vProd>1180.00</vProd><cEANTrib>7899478701778</cEANTrib><uTrib>UN</uTrib><qTrib>1</qTrib><vUnTrib>1179.996</vUnTrib><indTot>1</indTot><xPed>27</xPed><nItemPed>2</nItemPed></prod><imposto><ICMS><ICMS20><orig>0</orig><CST>20</CST><modBC>3</modBC><pRedBC>94.4400</pRedBC><vBC>65.61</vBC><pICMS>18.00</pICMS><vICMS>11.81</vICMS></ICMS20></ICMS><IPI><cEnq>999</cEnq><IPITrib><CST>99</CST><vBC>0.00</vBC><pIPI>0.00</pIPI><vIPI>0.00</vIPI></IPITrib></IPI><PIS><PISNT><CST>06</CST></PISNT></PIS><COFINS><COFINSNT><CST>06</CST></COFINSNT></COFINS></imposto><infAdProd>Lote: OP23853 D.Fab: 04/04/22 D.Val: 31/03/25 | MG 001650-0.000003 - FERTILIZANTE MINERAL SIMPLES (FOSFITO DE COBRE) - MODO APLICACAO: VIA FOLIAR/FERTIRRIGACAO - GARANTIA(S): Cu 3,5% (Nutriente soluvel em agua). Densidade: 1,34g/ml. Maior relacao soluto/solvente: 5,0 ml/l. Nat.Fisica: Solucao</infAdProd></det><det nItem="3"><prod><cProd>234</cProd><cEAN>7899478701662</cEAN><xProd>LIQ-D 1L</xProd><NCM>31059090</NCM><cBenef>00RS052162</cBenef><CFOP>5101</CFOP><uCom>UN</uCom><qCom>1</qCom><vUnCom>45.002</vUnCom><vProd>45.00</vProd><cEANTrib>7899478701662</cEANTrib><uTrib>UN</uTrib><qTrib>1</qTrib><vUnTrib>45.002</vUnTrib><indTot>1</indTot><xPed>27</xPed><nItemPed>3</nItemPed></prod><imposto><ICMS><ICMS20><orig>0</orig><CST>20</CST><modBC>3</modBC><pRedBC>94.4400</pRedBC><vBC>2.50</vBC><pICMS>18.00</pICMS><vICMS>0.45</vICMS></ICMS20></ICMS><IPI><cEnq>999</cEnq><IPITrib><CST>99</CST><vBC>0.00</vBC><pIPI>0.00</pIPI><vIPI>0.00</vIPI></IPITrib></IPI><PIS><PISNT><CST>06</CST></PISNT></PIS><COFINS><COFINSNT><CST>06</CST></COFINSNT></COFINS></imposto><infAdProd>Lote: OP23837 D.Fab: 04/04/22 D.Val: 30/03/25 | ADJUVANTE PARA USO NA AGRICULTURA</infAdProd></det><total><ICMSTot><vBC>85.07</vBC><vICMS>15.31</vICMS><vICMSDeson>0.00</vICMSDeson><vFCP>0.00</vFCP><vBCST>0.00</vBCST><vST>0.00</vST><vFCPST>0.00</vFCPST><vFCPSTRet>0.00</vFCPSTRet><vProd>1530.00</vProd><vFrete>0.00</vFrete><vSeg>0.00</vSeg><vDesc>0.00</vDesc><vII>0.00</vII><vIPI>0.00</vIPI><vIPIDevol>0.00</vIPIDevol><vPIS>0.00</vPIS><vCOFINS>0.00</vCOFINS><vOutro>0.00</vOutro><vNF>1530.00</vNF></ICMSTot></total><transp><modFrete>1</modFrete><vol><qVol>3</qVol><pesoL>34.550</pesoL><pesoB>36.080</pesoB></vol></transp><cobr><fat><nFat>12015</nFat><vOrig>1530.00</vOrig><vDesc>0.00</vDesc><vLiq>1530.00</vLiq></fat><dup><nDup>001</nDup><dVenc>2022-08-17</dVenc><vDup>1530.00</vDup></dup></cobr><pag><detPag><indPag>1</indPag><tPag>15</tPag><vPag>1530.00</vPag></detPag></pag><infAdic><infAdFisco>REDUCAO NA BASE DE CALCULO DE 94,44% CONFORME ITEM 64 DA PARTE 1 DO ANEXO IV DO RICMS/MG. | ESTABELECIMENTO PRODUTOR REGISTRADO NO MAPA SOB N EP - MG 001650-0.</infAdFisco><infCpl>Pedidos de Origem: 853 -</infCpl></infAdic><infRespTec><CNPJ>26314062000161</CNPJ><xContato>Fabio Tulio Felippe</xContato><email>marketing@sankhya.com.br</email><fone>3432390700</fone></infRespTec></infNFe><Signature xmlns="http://www.w3.org/2000/09/xmldsig#"><SignedInfo><CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315" /><SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1" /><Reference URI="#NFe31220402677655000124550010000120151764976773"><Transforms><Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature" /><Transform Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315" /></Transforms><DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" /><DigestValue>mDmrFTLaPmmk58Y17ZqpxQO8VCM=</DigestValue></Reference></SignedInfo><SignatureValue>Se7YEP68AbJ7sKe+NY1DwWVscek+x8GdZlFkQyEQG/Ubh14ISYu86Zn6Vb/dv9m1/+aS5jSxahjCDRkoFkGbnHAldcNRqNjDxaNgM8UWetRAGt0ma4o38RPukw/+oGu8ul8pO0aeIkRhkebx+MoqXqlszfhUQOzGz0tO8oV2lYBcnHGQ3kZ5KFz1yFSUgKmlu5xm27G3SZo3qhIXggYij/YKKHS/6uVJcwYLRquEoPj9luVflM+ZLNoXULsIUiw9VxWynHe3ow1o5EAfQ2Ghkzm7jEXq/tvZ7PPN0jTcY9q3GAJt048M7JAtIvEu/+Did/7/cnecn4raIwHp1oF3Yg==</SignatureValue><KeyInfo><X509Data><X509Certificate>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</X509Certificate></X509Data></KeyInfo></Signature></NFe>
            
    
    `; // Insira o XML aqui

    const parser = new DOMParser();
    const xmlDoc = parser.parseFromString(xmlString, "text/xml");

    const detElements = xmlDoc.getElementsByTagName("det");
    const tableBody = document.querySelector("#nfeTable tbody");

    for (let i = 0; i < detElements.length; i++) {
        const det = detElements[i];
        const prod = det.getElementsByTagName("prod")[0];
        const imposto = det.getElementsByTagName("imposto")[0];

    // Pegando CST do ICMS (caso haja diferentes tipos, busque pelo existente)
    let cstICMS = "";
    const icmsElements = imposto.getElementsByTagName("ICMS")[0];

    if (icmsElements) {
        const icmsChildren = icmsElements.children;
        for (let j = 0; j < icmsChildren.length; j++) {
            const cstElement = icmsChildren[j].getElementsByTagName("CST")[0];
            if (cstElement) {
                cstICMS = cstElement.textContent;
                break;
            }
        }
    }


        const item = det.getAttribute("nItem");
        const ncm = prod.getElementsByTagName("NCM")[0].textContent;
        const codigoProduto = prod.getElementsByTagName("cProd")[0].textContent;
        const produto = prod.getElementsByTagName("xProd")[0].textContent;
        const uTrib = prod.getElementsByTagName("uTrib")[0].textContent;
        const quantidade = prod.getElementsByTagName("qCom")[0].textContent;
        const valorUnitario = prod.getElementsByTagName("vUnCom")[0].textContent;
        const valorTotal = prod.getElementsByTagName("vProd")[0].textContent;

        

        const row = document.createElement("tr");

        row.innerHTML = `
            <td>${item}</td>
            <td>${ncm}</td>
            <td>${codigoProduto}</td>
            <td>${produto}</td>
            <td>${uTrib}</td>
            <td>${quantidade}</td>
            <td>${valorUnitario}</td>
            <td>${valorTotal}</td>
            <td>${cstICMS}</td> 
        `;

        tableBody.appendChild(row);
    }
});  
    </script>
</body>
</html>