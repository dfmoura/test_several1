<gadget>  <prompt-parameters>    <parameter id="CODEMP" description="Empresa" metadata="multiList:Text" listType="sql" required="false" keep-last="false" keep-date="false" order="0" label="CODEMP : multiList:Text">      <expression type="SQL">SELECT CODEMP AS VALUE,  TO_CHAR(CODEMP)  || ' - ' || NOMEFANTASIA AS LABELFROM TSIEMPORDER BY CODEMP</expression>    </parameter>    <parameter id="DTREFERENCIA" description="Data Posição Financeira" metadata="date" required="true" keep-last="false" keep-date="false" label="DTREFERENCIA : Data" order="1"/>    <parameter id="CODPARC" description="Parceiro" metadata="entity:Parceiro@CODPARC" required="false" keep-last="false" keep-date="false" order="2" label="CODPARC : Entidade/Tabela"/>    <parameter id="NOMEPARC" description="Visualizar Nome/Razão Social" metadata="singleList:Text" listType="text" required="true" keep-last="false" keep-date="false" order="3" label="NOMEPARC : singleList:Text">      <item value="NOME" label="Nome Parceiro"/>      <item value="RAZAO" label="Razão Social"/>    </parameter>  </prompt-parameters>  <level id="lvl_axrwf04" description="Principal">    <args>      <arg id="VAR_CODPARC" type="integer" label="VAR_CODPARC : Número Inteiro"/>    </args>    <container orientacao="V" tamanhoRelativo="100">      <container orientacao="V" tamanhoRelativo="35800">        <container orientacao="V" tamanhoRelativo="50">          <grid id="grd_axrwf05" useNewGrid="S">            <title><![CDATA[                                                                                                                                                                                                                                                                                                                                  <pre><b>Posição da carteira de recebíveis em :DTREFERENCIA</b></pre>                                                                                                                                                                                                                                                                                    ]]></title>            <expression type="sql" data-source="MGEDS"><![CDATA[                                              SELECT     D.CODPARC,         D.NOMEPARC,        Formatar_Cpf_Cnpj(D.CNPJCPF) AS CNPJCPF,        SUM(D.VLRDESDOB) AS VLRDESDOB        FROM        (/* Pega os Titulos de Origem V não Renegociados */SELECT AUX.CODPARC,         AUX.NOMEPARC,        AUX.CNPJCPF AS CNPJCPF,                SUM(AUX.VLRDESDOB) AS VLRDESDOBFROM(SELECT    FIN.CODPARC,        CASE WHEN :NOMEPARC = 'NOME' THEN PAR.NOMEPARC ELSE PAR.RAZAOSOCIAL END AS NOMEPARC,         PAR.CGC_CPF AS CNPJCPF,        SUM(FIN.VLRDESDOB) AS VLRDESDOBFROM    TGFFIN FINLEFT JOIN TGFMBC MBC ON MBC.NUBCO = FIN.NUBCO, TGFTOP OPE, TGFPAR PARWHERE   FIN.CODTIPOPER = OPE.CODTIPOPERAND     FIN.DHTIPOPER = OPE.DHALTERAND     FIN.CODPARC=PAR.CODPARCAND     FIN.PROVISAO = 'N'AND     (CASE WHEN FIN.NUBCO IS NULL THEN FIN.DHBAIXA ELSE MBC.DHCONCILIACAO END > :DTREFERENCIA OR FIN.DHBAIXA IS NULL OR MBC.DHCONCILIACAO IS NULL)AND     FIN.DTNEG <= :DTREFERENCIAAND     FIN.CODEMP IN :CODEMPAND     (FIN.CODPARC = :CODPARC OR :CODPARC IS NULL)AND     FIN.RECDESP = 1AND     OPE.TIPMOV='V'--AND     FIN.CODTIPOPER NOT IN (1106)AND     OPE.ATUALFIN = 1AND        FIN.NURENEG IS NULL AND     FIN.NUCOMPENS IS NULL ---CLAYTON EM 10/04/2024AND     FIN.NUDEV IS NULL ---CLAYTON EM 10/04/2024GROUP BY     FIN.CODPARC,            PAR.NOMEPARC,            PAR.RAZAOSOCIAL,            PAR.CGC_CPF) AUXGROUP BY     AUX.CODPARC,             AUX.NOMEPARC,            AUX.CNPJCPF            UNION ALL/* Pega os Titulos de Origem V Renegociados */SELECT     AUX1.CODPARC,         AUX1.NOMEPARC,        AUX1.CNPJCPF AS CNPJCPF,                SUM(AUX1.VLRDESDOB) AS VLRDESDOBFROM(SELECT    FIN.CODPARC,        CASE WHEN :NOMEPARC = 'NOME' THEN PAR.NOMEPARC ELSE PAR.RAZAOSOCIAL END AS NOMEPARC,         PAR.CGC_CPF AS CNPJCPF,        SUM(FIN.VLRDESDOB) AS VLRDESDOBFROM    TGFFIN FINLEFT JOIN TGFMBC MBC ON MBC.NUBCO = FIN.NUBCO, TGFTOP OPE, TGFPAR PAR, TGFREN RENWHERE   FIN.CODTIPOPER = OPE.CODTIPOPERAND     FIN.DHTIPOPER = OPE.DHALTERAND          FIN.CODPARC=PAR.CODPARCAND     FIN.PROVISAO = 'N'AND     (CASE WHEN FIN.NUBCO IS NULL THEN FIN.DHBAIXA ELSE MBC.DHCONCILIACAO END > :DTREFERENCIA OR FIN.DHBAIXA IS NULL)AND     FIN.DTNEG <= :DTREFERENCIAAND     FIN.CODEMP IN :CODEMPAND        (FIN.CODPARC = :CODPARC OR :CODPARC IS NULL)AND     FIN.RECDESP = 0AND     OPE.TIPMOV='V'AND     OPE.ATUALFIN = 1AND        FIN.NUFIN = REN.NUFINAND        FIN.NURENEG = REN.NURENEGAND        REN.DHALTER > :DTREFERENCIAGROUP BY     FIN.CODPARC,            PAR.NOMEPARC,            PAR.RAZAOSOCIAL,            PAR.CGC_CPF) AUX1GROUP BY     AUX1.CODPARC,             AUX1.NOMEPARC,            AUX1.CNPJCPFUNION ALL/* Pega os Titulos de Origem Top 1303 */SELECT AUX2.CODPARC,         AUX2.NOMEPARC,        AUX2.CNPJCPF AS CNPJCPF,                SUM(AUX2.VLRDESDOB) AS VLRDESDOBFROM(SELECT    FIN.CODPARC,        CASE WHEN :NOMEPARC = 'NOME' THEN PAR.NOMEPARC ELSE PAR.RAZAOSOCIAL END AS NOMEPARC,         PAR.CGC_CPF AS CNPJCPF,        SUM(FIN.VLRDESDOB) AS VLRDESDOBFROM    TGFFIN FINLEFT JOIN TGFMBC MBC ON MBC.NUBCO = FIN.NUBCO, TGFTOP OPE, TGFPAR PARWHERE   FIN.CODTIPOPER = OPE.CODTIPOPERAND     FIN.DHTIPOPER = OPE.DHALTERAND          FIN.CODPARC=PAR.CODPARCAND     FIN.PROVISAO = 'N'AND     (CASE WHEN FIN.NUBCO IS NULL THEN FIN.DHBAIXA ELSE MBC.DHCONCILIACAO END > :DTREFERENCIA OR FIN.DHBAIXA IS NULL)AND     FIN.DTNEG <= :DTREFERENCIAAND     FIN.CODEMP IN :CODEMPAND        (FIN.CODPARC = :CODPARC OR :CODPARC IS NULL)AND     FIN.RECDESP = 1AND     FIN.CODTIPOPER = 1300AND		FIN.CODNAT IN (1010000, 5010300, 5010500, 5010401)GROUP BY     FIN.CODPARC,            PAR.NOMEPARC,            PAR.RAZAOSOCIAL,            PAR.CGC_CPF) AUX2GROUP BY     AUX2.CODPARC,             AUX2.NOMEPARC,            AUX2.CNPJCPF			UNION ALL/* Pega os Titulos de Origem Top 1303 */SELECT AUX3.CODPARC,         AUX3.NOMEPARC,        AUX3.CNPJCPF AS CNPJCPF,                SUM(AUX3.VLRDESDOB) AS VLRDESDOBFROM(SELECT    FIN.CODPARC,        CASE WHEN :NOMEPARC = 'NOME' THEN PAR.NOMEPARC ELSE PAR.RAZAOSOCIAL END AS NOMEPARC,         PAR.CGC_CPF AS CNPJCPF,        SUM(FIN.VLRDESDOB) AS VLRDESDOBFROM    TGFFIN FINLEFT JOIN TGFMBC MBC ON MBC.NUBCO = FIN.NUBCO, TGFTOP OPE, TGFPAR PARWHERE   FIN.CODTIPOPER = OPE.CODTIPOPERAND     FIN.DHTIPOPER = OPE.DHALTERAND          FIN.CODPARC=PAR.CODPARCAND     FIN.PROVISAO = 'N'AND     (CASE WHEN FIN.NUBCO IS NULL THEN FIN.DHBAIXA ELSE MBC.DHCONCILIACAO END > :DTREFERENCIA OR FIN.DHBAIXA IS NULL)AND     FIN.DTNEG <= :DTREFERENCIAAND     FIN.CODEMP IN :CODEMPAND        (FIN.CODPARC = :CODPARC OR :CODPARC IS NULL)AND     FIN.RECDESP = 1AND     FIN.CODTIPOPER IN (1303)AND     FIN.CODNAT IN (1010000, 5010300, 5010500, 5010401)GROUP BY     FIN.CODPARC,            PAR.NOMEPARC,            PAR.RAZAOSOCIAL,            PAR.CGC_CPF) AUX3			GROUP BY     AUX3.CODPARC,             AUX3.NOMEPARC,            AUX3.CNPJCPF			UNION ALL/* Pega os Titulos de Origem Top 1310 */SELECT 	AUX4.CODPARC,         AUX4.NOMEPARC,        AUX4.CNPJCPF AS CNPJCPF,                SUM(AUX4.VLRDESDOB) AS VLRDESDOBFROM(SELECT    	FIN.CODPARC,			CASE WHEN :NOMEPARC = 'NOME' THEN PAR.NOMEPARC ELSE PAR.RAZAOSOCIAL END AS NOMEPARC, 			PAR.CGC_CPF AS CNPJCPF,			SUM(FIN.VLRDESDOB) AS VLRDESDOBFROM    TGFFIN FINLEFT JOIN TGFMBC MBC ON MBC.NUBCO = FIN.NUBCO, TGFTOP OPE, TGFPAR PARWHERE   FIN.CODTIPOPER = OPE.CODTIPOPERAND     FIN.DHTIPOPER = OPE.DHALTERAND     FIN.CODPARC=PAR.CODPARCAND     FIN.PROVISAO = 'N'AND     (CASE WHEN FIN.NUBCO IS NULL THEN FIN.DHBAIXA ELSE MBC.DHCONCILIACAO END > :DTREFERENCIA OR FIN.DHBAIXA IS NULL)AND     FIN.DTNEG <= :DTREFERENCIAAND     FIN.CODEMP IN :CODEMPAND    	(FIN.CODPARC = :CODPARC OR :CODPARC IS NULL)AND     FIN.RECDESP = 1AND     FIN.CODTIPOPER = 1310AND		EXISTS (SELECT 1 FROM VGF_APOIO_DESCRSTATUSDUPL WHERE NUFIN = FIN.NUFIN AND TIPO = 'Próprio')GROUP BY     FIN.CODPARC,            PAR.NOMEPARC,            PAR.RAZAOSOCIAL,            PAR.CGC_CPFUNION ALLSELECT    	FIN.CODPARC,			CASE WHEN :NOMEPARC = 'NOME' THEN PAR.NOMEPARC ELSE PAR.RAZAOSOCIAL END AS NOMEPARC, 			PAR.CGC_CPF AS CNPJCPF,			SUM(FIN.VLRDESDOB) AS VLRDESDOBFROM    TGFFIN FINLEFT JOIN TGFMBC MBC ON MBC.NUBCO = FIN.NUBCO, TGFTOP OPE, TGFPAR PARWHERE   FIN.CODTIPOPER = OPE.CODTIPOPERAND     FIN.DHTIPOPER = OPE.DHALTERAND     FIN.CODPARC=PAR.CODPARCAND     FIN.PROVISAO = 'N'AND     (CASE WHEN FIN.NUBCO IS NULL THEN FIN.DHBAIXA ELSE MBC.DHCONCILIACAO END > :DTREFERENCIA OR FIN.DHBAIXA IS NULL)AND     FIN.DTNEG <= :DTREFERENCIAAND     FIN.CODEMP IN :CODEMPAND    	(FIN.CODPARC = :CODPARC OR :CODPARC IS NULL)AND     FIN.RECDESP = 1AND     FIN.CODTIPOPER = 1310AND		NOT EXISTS (SELECT 1 FROM VGF_APOIO_DESCRSTATUSDUPL WHERE NUFIN = FIN.NUFIN AND TIPO = 'Próprio')AND		FIN.CODNAT IN (1010000)GROUP BY     FIN.CODPARC,            PAR.NOMEPARC,            PAR.RAZAOSOCIAL,            PAR.CGC_CPF) AUX4GROUP BY     AUX4.CODPARC,             AUX4.NOMEPARC,            AUX4.CNPJCPF) D            GROUP BY     D.CODPARC,             D.NOMEPARC,            D.CNPJCPF           ORDER BY 1                                                                                                                                                                        ]]></expression>            <metadata>              <field name="CODPARC" label="Cliente" type="I" visible="true" useFooter="false"/>              <field name="NOMEPARC" label="Nome Cliente" type="S" visible="true" useFooter="false"/>              <field name="CNPJCPF" label="CNPJ/CPF" type="S" visible="true" useFooter="false"/>              <field name="VLRDESDOB" label="Vlr. em Aberto" type="F" visible="true" useFooter="SUM" mask="#.##0,00;-n"/>            </metadata>          </grid>        </container>        <container orientacao="V" tamanhoRelativo="50">          <grid id="grd_tyr8f0" useNewGrid="S">            <title><![CDATA[                                                                                                                                                                                                                                                                                                                                  <pre><b>Posição da carteira de Pagamentos em :DTREFERENCIA</b></pre>                                                                                                                                                                                                                                                                                    ]]></title>            <expression type="sql" data-source="MGEDS"><![CDATA[              SELECT 	D.CODPARC, 		D.NOMEPARC,		Formatar_Cpf_Cnpj(D.CNPJCPF) AS CNPJCPF,		SUM(D.VLRDESDOB) AS VLRDESDOB		FROM		(/*FORNECEDORES DE COMPRAS S/ RENEGOCIAÇÃO */SELECT  FIN.CODPARC, 		CASE WHEN :NOMEPARC = 'NOME' THEN PAR.NOMEPARC ELSE PAR.RAZAOSOCIAL END AS NOMEPARC, 		PAR.CGC_CPF AS CNPJCPF,		SUM(FIN.VLRDESDOB) AS VLRDESDOBFROM    TGFFIN FIN, TGFTOP OPE, TGFPAR PARWHERE   FIN.CODTIPOPER = OPE.CODTIPOPERAND     FIN.DHTIPOPER = OPE.DHALTERAND		FIN.CODPARC=PAR.CODPARCAND     FIN.PROVISAO = 'N'AND	  	(FIN.DHBAIXA > :DTREFERENCIA OR FIN.DHBAIXA IS NULL)AND     FIN.DTENTSAI <= :DTREFERENCIAAND     FIN.CODEMP IN :CODEMPAND		(FIN.CODPARC = :CODPARC OR :CODPARC IS NULL)AND     FIN.RECDESP = -1AND     OPE.TIPMOV = 'C'AND     CODNAT NOT IN ('2010200', '2010400', '2010500', '2010600', '2010700', '2010800', '2010900', '4020202', '4020304', '5010100', '5020100', '5020900', '1020000')AND     NOT EXISTS (SELECT 1 FROM VGF_APOIO_DESCRSTATUSDUPL WHERE NUFIN = FIN.NUFIN AND TIPO = 'Terceiro')AND     FIN.NURENEG IS NULLGROUP BY 	FIN.CODPARC,			PAR.NOMEPARC,			PAR.RAZAOSOCIAL,			PAR.CGC_CPFUNION ALL/*FORNECEDORES DE COMPRAS C/ RENEGOCIAÇÃO */SELECT  FIN.CODPARC, 		CASE WHEN :NOMEPARC = 'NOME' THEN PAR.NOMEPARC ELSE PAR.RAZAOSOCIAL END AS NOMEPARC, 		PAR.CGC_CPF AS CNPJCPF,		SUM(FIN.VLRDESDOB) AS VLRDESDOBFROM    TGFFIN FIN, TGFTOP OPE, TGFPAR PARWHERE   FIN.CODTIPOPER = OPE.CODTIPOPERAND     FIN.DHTIPOPER = OPE.DHALTERAND		FIN.CODPARC=PAR.CODPARCAND     FIN.PROVISAO = 'N'AND	  	(FIN.DHBAIXA > :DTREFERENCIA OR FIN.DHBAIXA IS NULL)AND     FIN.DTENTSAI <= :DTREFERENCIAAND     FIN.CODEMP IN :CODEMPAND		(FIN.CODPARC = :CODPARC OR :CODPARC IS NULL)AND     FIN.RECDESP = -1AND     OPE.TIPMOV = 'C'AND     CODNAT NOT IN ('2010200', '2010400', '2010500', '2010600', '2010700', '2010800', '2010900', '4020202', '4020304', '5010100', '5020100', '5020900', '1020000')AND     NOT EXISTS (SELECT 1 FROM VGF_APOIO_DESCRSTATUSDUPL WHERE NUFIN = FIN.NUFIN AND TIPO = 'Terceiro')AND     FIN.NURENEG IS NOT NULLGROUP BY 	FIN.CODPARC,			PAR.NOMEPARC,			PAR.RAZAOSOCIAL,			PAR.CGC_CPFUNION ALL/*FORNECEDORES DE COMPRAS RENEGOCIADOS */SELECT  FIN.CODPARC, 		CASE WHEN :NOMEPARC = 'NOME' THEN PAR.NOMEPARC ELSE PAR.RAZAOSOCIAL END AS NOMEPARC,		PAR.CGC_CPF AS CNPJCPF,		SUM(FIN.VLRDESDOB) AS VLRDESDOBFROM    TGFFIN FIN, TGFTOP OPE, TGFPAR PARWHERE   FIN.CODTIPOPER = OPE.CODTIPOPERAND     FIN.DHTIPOPER = OPE.DHALTERAND		FIN.CODPARC=PAR.CODPARCAND     FIN.PROVISAO = 'N'AND		(FIN.DHBAIXA > :DTREFERENCIA OR FIN.DHBAIXA IS NULL)AND     CASE WHEN FIN.DTENTSAI IS NULL THEN FIN.DTNEG ELSE DTENTSAI END <= :DTREFERENCIAAND     FIN.CODEMP IN :CODEMPAND		(FIN.CODPARC = :CODPARC OR :CODPARC IS NULL)AND     FIN.RECDESP = -1AND		FIN.CODTIPOPER IN (1300,1303, 1310)AND     FIN.CODNAT NOT IN ('2010200', '2010400', '2010500', '2010600', '2010700', '2010800', '2010900', '4020202', '4020304', '5010100', '5020100', '5020900', '1020000', '2020506','3030600', '3020701', '3010100', '3030700', '3050202', '6010100', '6020100', '6020200')AND     NOT EXISTS (SELECT 1 FROM VGF_APOIO_DESCRSTATUSDUPL WHERE NUFIN = FIN.NUFIN AND TIPO = 'Terceiro')GROUP BY 	FIN.CODPARC,			PAR.NOMEPARC,			PAR.RAZAOSOCIAL,			PAR.CGC_CPF) D			GROUP BY 	D.CODPARC, 			D.NOMEPARC,			D.CNPJCPFORDER BY 1                                                                                                                                                                                                                                                                            ]]></expression>            <metadata>              <field name="CODPARC" label="Fornecedor" type="I" visible="true" useFooter="false"/>              <field name="NOMEPARC" label="Nome Fornecedor" type="S" visible="true" useFooter="false"/>              <field name="CNPJCPF" label="CNJP/CPF" type="S" visible="true" useFooter="false"/>              <field name="VLRDESDOB" label="Vr Pagamento" type="F" visible="true" useFooter="SUM" mask="#.##0,00;-n"/>            </metadata>          </grid>        </container>      </container>    </container>  </level></gadget>